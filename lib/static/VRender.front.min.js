!function(){if(!window.VRender){var a=window.VRender=function(){};a.$=$,a.ENV={},a.event_defined="vrender_defined",a.event_statepush="vrender_statepush",a.event_statereplace="vrender_statereplace",a.event_statepop="vrender_statepop",a.event_routerbefore="vrender_router_before",a.event_routerchange="vrender_router_change";var b=!1,c={},d={},e=[],f=0,g=a.Utils=function(){};window.define=function(d,e,f){if(g.isFunction(d)?(f=d,e=null,d=null):g.isArray(d)?(f=e,e=d,d=null):g.isFunction(e)&&(f=e,e=null),g.isFunction(f)){if(g.isBlank(d)&&(d=g.randomTxt(32)),i(d))return void(g.isFunction(c[d])&&c[d]($,a,g));b?h(d,f,e):(a.cacheDefine||(a.cacheDefine={}),a.cacheDefine[d]={definition:f,deps:e})}};var h=function(b,d,e){e=g.toArray(e);var f=function(){g.isFunction(d)&&(d=d($,a,g)||d),c[b]=d,a.trigger(a.event_defined,b,d)};if(e.length>0){var h=function(){return!g.find(e,function(a){return!i(a)})};h()?f():a.on(a.event_defined,function(){h()&&(a.off(a.event_defined,arguments.callee),f())})}else f()},i=function(a){return c.hasOwnProperty(a)};window.requirejs=function(b,d){if(c.hasOwnProperty(b))return g.isFunction(d)&&d(c[b]),c[b];a.on(a.event_defined,function(c,e){b===c&&(a.off(a.event_defined,arguments.callee),g.isFunction(d)&&d(e))})},a.navigate=function(b,c){if(g.isNotBlank(b)){var d={router:b,replace:!1,trigger:!0,animate:!1};c&&(d=$.extend(d,c)),a.trigger(a.event_routerbefore,d),!0!==d.isDefaultPrevented&&(g.isTrue(d.replace)?window.location.replace(b):window.location=b)}},a.require=function(a,b){g.isFunction(b)&&(g.isBlank(a)?b(!1,null):m(a,null,function(a,c,d,e){b(d,e)}))},a.fetch=function(a,b,c,d){j("GET",a,b,c,d)},a.post=function(a,b,c,d){j("POST",a,b,c,d)};var j=function(b,c,d,e,f){if(g.isFunction(d)&&(f=e,e=d,d=null),g.isFunction(e)||(e=function(){}),g.isBlank(c))return e("服务请求失败：url不能为空"),!1;if(g.isNotBlank(d)){var h={};for(var i in d)g.isNotNull(d[i])&&(h[i]=d[i]);d=h}return/^(\/|http)/.test(c)||(c="/api?n="+c,d=g.isBlank(d)?null:{data:JSON.stringify(d)},b="POST"),"GET"===b&&g.isNotBlank(d)&&(c+=(c.indexOf("?")<0?"?":"&")+$.param(d),d=null),$.ajax({type:b,cache:!1,url:c,dataType:"json",data:d,success:function(b){if(b&&b.hasOwnProperty("code"))if(0===b.code)e(!1,b.data);else{console.error(b);var c=b.hasOwnProperty("msg")?b.msg:b;!f&&g.isFunction(a.onAjaxError)&&a.onAjaxError(c||""),e(c||!0,b)}else e(!1,b)},error:function(b){var c=b.responseText||!0;if(401===b.status)c="请登录";else if(404===b.status)c="请求错误，请稍候重试..";else if(500===b.status){try{c=JSON.parse(c)}catch(b){}c="服务器错误，请重试. "+(c&&c.hasOwnProperty("msg")?c.msg:c)}!f&&g.isFunction(a.onAjaxError)&&a.onAjaxError(c,b),e(c)}})};a.load=function(a,b,c){if(g.isNull(b)&&g.isNull(c)&&(b=a,a=null),g.isFunction(b)&&(c=b,b=a,a=null),a&&"string"==typeof a&&(a=$(a)),b=g.toArray(b),0===b.length)g.isFunction(c)&&c(null);else{var d=b.length,e=[],f=function(a,b,f,h){!f&&h&&g.pushAll(e,h),(d-=1)<=0&&g.isFunction(c)&&c(e)};g.each(b,function(b){if("string"==typeof b&&(b={uri:b}),g.isBlank(b.uri))f();else{var c=b.uri.toLowerCase();/\.js$/.test(c)?k(b.uri,b.attributes,f):/\.css$/.test(c)?l(a,b.uri,b.attributes,f):m(b.uri,b.attributes,f)}})}};var k=function(b,d){$.getScript(b).done(function(a){if(g.isFunction(d)){var e=[];if(a){var f=a.match(/define\(["'][\w-]+["']\)/g);g.each(f,function(a){a=a.substring(8,a.length-1),c.hasOwnProperty(a)&&e.push(c[a])})}d(b,"js",!1,e)}}).fail(function(c){console.error("js load error",c.responseText||c),g.isFunction(a.onAjaxError)&&a.onAjaxError("js load error",c),g.isFunction(d)&&d(b,"js",c)})},l=function(a,b,c,e){var f=d[b];if(!f){var h=$("<link href='"+b+"' rel='stylesheet' type='text/css'>").appendTo("head");f=d[b]={$el:h}}c&&f.$el.attr(c),a&&(g.isArray(f.views)||(f.views=[]),f.views.push(a)),g.isFunction(e)&&e(b,"css")},m=function(b,c,d){g.isNotBlank(b)&&g.isFunction(d)?$.ajax({type:"POST",cache:!1,url:b,data:c,success:function(a){d(b,"html",!1,a)},error:function(c){console.error("html load error",c.responseText||c),g.isFunction(a.onAjaxError)&&a.onAjaxError("html load error",c),d(b,"html",c,null)}}):g.isFunction(d)&&d(b,"html",!1,null)};a.cache=function(a,b){return g.isBlank(a)?null:null===b?($.jStorage.deleteKey(a),null):(void 0!==b&&$.jStorage.set(a,b),$.jStorage.get(a))},a.trigger=function(b,c){a.emitter&&a.emitter.trigger(b,c)},a.on=function(b,c,d){!a.emitter&&a.EventEmitter&&(a.emitter=new a.EventEmitter),a.emitter&&a.emitter.on(b,c,d)},a.one=function(b,c,d){!a.emitter&&a.EventEmitter&&(a.emitter=new a.EventEmitter),a.emitter&&a.emitter.one(b,c,d)},a.off=function(b,c){a.emitter&&a.emitter.off(b,c)},a.onenter=function(a,b,c){if(g.isFunction(b)&&(c=b,b=null),a=$(a),g.isFunction(c)){var d=function(a){13===a.which&&c()};g.isBlank(b)?a.on("keydown",d):a.on("keydown",b,d)}else a.off("keydown",b)},a.onInputChange=function(a,b){var c=$(a);if(c.is("input, textarea")||(c=c.find("input, textarea")),g.isFunction(b)){c.on("focusin",function(a){var b=$(a.currentTarget),c=b.data("vrender-inputchange");c&&c.timer&&clearInterval(c.timer),c={lastValue:b.val()},c.timer=setInterval(function(){d(b,c)},100),b.data("vrender-inputchange",c)}),c.on("focusout",function(a){var b=$(a.currentTarget),c=b.data("vrender-inputchange");c&&c.timer&&clearInterval(c.timer),b.removeData("vrender-inputchange"),d(b,c)});var d=function(a,c){var d=a.val();d!=c.lastValue&&(c.lastValue=d,g.isFunction(b)&&b(a,d))}}else c.off("focusin"),c.off("focusout")},a.scheduleTask=function(a,b){if(!g.isBlank(a)){if(g.isFunction(b)){var c=g.find(e,function(b){return b.name===a});c?c.task=b:e.push({name:a,task:b})}else g.removeItems(e,function(b){return b.name===a});0===e.length?(f&&clearInterval(f),f=0):f||(f=setInterval(function(){g.each(e,function(a){a.task()})},400))}};var n=function(){for(var a in d){var b=d[a];if(g.isArray(b.views)){for(var c=b.views.length-1;c>=0;c--)g.isDomExist(b.views[c])||b.views.splice(c,1);0===b.views.length&&(b.$el.remove(),delete d[a])}}};a.plugins={};var o=a.Component=function(){};o.bindName="vrender-component",o.registerList=[],o.dataAdapter=function(a){return a},o.errorHandler=function(a){console.error(a)},o.register=function(a,b){g.isNotBlank(a)&&g.isFunction(b)&&o.registerList.push({s:a,fun:b})},o.build=function(a){if(g.isBlank(a))return[];if(!(a=$(a))||0===a.length)return[];var b=[];return g.each(o.registerList,function(c){a.find(c.s).each(function(){var a=$(this),d=a.data(o.bindName);d||(d=new c.fun(a)),b.push(d)})}),b},o.get=function(a){return $(a).data(o.bindName)},o.find=function(a,b,c){return a=$(a),a&&0!==a.length?g.isBlank(b)?o.build(a):g.map(a.find(b),function(a){return g.isFunction(c)?new c(a):o.get(a)}):[]},o.create=function(b,c,d){b=$.extend({},b);var e=b.tagName||b.tag||"div";e=/img|input|br/.test(e)?$("<"+e+"/>"):$("<"+e+"></"+e+">"),g.isNotBlank(b.id)&&e.attr("id",b.id),g.isNotBlank(b.name)&&e.attr("name",b.name),g.isNotBlank(b.clsName)&&e.addClass(b.clsName),g.isNotBlank(b.style)&&e.addClass(b.style),b.target&&e.appendTo(b.target);var f=d&&new d(b);f&&g.isFunction(f.render)&&f.render($,e);var h=g.getFormatSize(b.width,a.ENV.useRem),i=g.getFormatSize(b.height,a.ENV.useRem);if(c&&g.isFunction(c)){var j=new c(e,b,f);!h||g.isFunction(j.isWidthEnabled)&&!j.isWidthEnabled()||e.css("width",h),!i||g.isFunction(j.isHeightEnabled)&&!j.isHeightEnabled()||e.css("height",i),e=j}else h&&e.css("width",h),i&&e.css("height",i);return e},o.load=function(b,c,d){if(g.isBlank(b))return o.errorHandler("组件试图加载数据错误：api不能为空"),!1;c=$.extend({},c),this.lastLoadApi=b,this.lastLoadParams=c;var e=this;a.fetch(b,c,function(a,b){a||(b=o.dataAdapter(b),b&&g.isArray(b)&&(b={total:b.length,data:b}),e._totalSize=Math.max(0,parseInt(b&&b.total))||0,b=b&&b.hasOwnProperty("data")?b.data:b),e._pageNo=parseInt(c.p_no)||1,e._pageSize=parseInt(c.p_size)||20;var f=g.isFunction(e.getPaginator)&&e.getPaginator();f&&g.isFunction(f.set)&&f.set(e._totalSize,e._pageNo,e._pageSize),g.isFunction(d)&&d(a,b)})},a.$ref=function(a){var b=$("[ref='"+a+"']");return b&&b.length>0?(b.length>1&&(b=b.eq(0)),o.get(b)||b):null},window.$ref=a.$ref,$.ajaxSetup({cache:!0}),$(function(){b=!0,o.isMobile=g.getUAState(navigator.userAgent).isMobile;for(var c in a.cacheDefine){var d=a.cacheDefine[c];h(c,d.definition,d.deps)}delete a.cacheDefine,a.scheduleTask("EasyWeb.cssfilemonitor",n)})}}(),function(a){var b=a?VRender.Utils:exports;b.each=function(a,b){if(c(b)&&a&&a.length>0)for(var d=c(a.eq),e=0,f=a.length;e<f;e++){var g=d?a.eq(e):a[e];if(!1===b(g,e))break}},b.filter=function(a,b){var d=[];if(c(b)&&a&&a.length>0)for(var e=c(a.eq),f=0,g=a.length;f<g;f++){var h=e?a.eq(f):a[f];b(h,f)&&d.push(h)}return d},b.filterBy=function(a,c,d){return c?b.filter(a,function(a,b){return a&&a[c]==d}):[]},b.find=function(a,b){if(c(b)&&a&&a.length>0)for(var d=c(a.eq),e=0,f=a.length;e<f;e++){var g=d?a.eq(e):a[e];if(b(g,e))return g}return null},b.findBy=function(a,c,d){return c?b.find(a,function(a,b){return a&&a[c]==d}):null},b.index=function(a,b){if(c(b)&&a&&a.length>0)for(var d=c(a.eq),e=0,f=a.length;e<f;e++){var g=d?a.eq(e):a[e];if(b(g,e))return e}return-1},b.indexBy=function(a,c,d){return c?b.index(a,function(a,b){return a&&a[c]==d}):-1},b.isArray=function(a){return a&&a instanceof Array},b.map=function(d,e){var f=[];if(c(e))if(b.isArray(d))for(var g=0,h=d.length;g<h;g++)f.push(e(d[g],g));else if(a&&d instanceof $)for(var g=0,h=d.length;g<h;g++)f.push(e(d.eq(g),g));return f},b.remove=function(a,b){var d=[];if(c(b)&&a&&a.length>0)for(var e=c(a.eq),f=a.length-1;f>=0;f--){var g=e?a.eq(f):a[f];b(g,f)&&(d.unshift(g),c(g.remove)?g.remove():c(a.splice)&&a.splice(f,1))}return d},b.removeBy=function(a,c,d){return c?b.remove(a,function(a,b){return a&&a[c]==d}):[]},b.toArray=function(a){return void 0===a||null===a||!1===a?[]:a instanceof Array?a:[a]};var c=function(a){return"function"==typeof a}}("undefined"!=typeof VRender),function(a){var b=a?VRender.Utils:exports;b._dateBase=new Date(2018,0,1,0,0,0),b.compare=function(a,b){var c=a.getTime(),d=b.getTime();return c===d?0:c<d?-1:1},b.getDays=function(a,c){return a instanceof Date?(c instanceof Date||(c=b._dateBase),c=c instanceof Date?new Date(c.getFullYear(),c.getMonth(),c.getDate()):new Date(2018,0,1),a=new Date(a.getFullYear(),a.getMonth(),a.getDate()),parseInt((a.getTime()-c.getTime())/864e5)):0},b.getMinutes=function(a,c){return a instanceof Date?(c instanceof Date||(c=b._dateBase),c=c instanceof Date?new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes()):new Date(2018,0,1),a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()),parseInt((a.getTime()-c.getTime())/6e4)):0},b.isSameDay=function(a,b){return a instanceof Date&&b instanceof Date&&(a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate())},b.isToday=function(a){return a instanceof Date&&b.isSameDay(a,new Date)},b.isTomorrow=function(a){if(a instanceof Date){var c=new Date;return c.setDate(c.getDate()+1),b.isSameDay(a,c)}return!1},b.isYesterday=function(a){if(a instanceof Date){var c=new Date;return c.setDate(c.getDate()-1),b.isSameDay(a,c)}return!1},b.toDate=function(a){if(a instanceof Date)return a;if("string"==typeof a){a=a.replace(/-/g,"/");var b=Date.parse(a);if(isNaN(b)){var c=a.indexOf(".");if(c>0){var d=parseInt(a.substr(c+1)||0);b=Date.parse(a.substr(0,c))+d}}return isNaN(b)?null:new Date(b)}return"number"==typeof a?new Date(a):null},b.toDateString=function(a,b){b=b||"yyyy-MM-dd",a=a||new Date;var c=a.getMonth()+1,d=a.getDate(),e=a.getHours(),f=a.getMinutes(),g=a.getSeconds(),h=a.getMilliseconds(),i=b.replace("yyyy",a.getFullYear());if(/M/.test(i)&&(i=i.replace(/MM/g,c<10?"0"+c:c).replace(/M/g,c)),/d/.test(i)&&(i=i.replace(/dd/g,d<10?"0"+d:d).replace(/d/g,d)),/H/.test(i)&&(i=i.replace(/HH/g,e<10?"0"+e:e).replace(/H/g,e)),/m/.test(i)&&(i=i.replace(/mm/g,f<10?"0"+f:f).replace(/m/g,f)),/s/.test(i)&&(i=i.replace(/ss/g,g<10?"0"+g:g).replace(/s/g,g)),/SSS/.test(i)&&(i=i.replace(/SSS/g,h<10?"00"+h:h<100?"0"+h:h)),/hh/.test(i)){var j=(e+12)%12;e<1?j="午夜"+j:e>=1&&e<5?j="凌晨"+j:e>=5&&e<6?j="清晨"+j:e>=6&&e<8?j="早上"+j:e>=8&&e<11?j="上午"+j:e>=11&&e<13?j="中午"+j:e>=13&&e<17?j="下午"+j:e>=17&&e<18?j="傍晚"+j:e>=18&&e<=23&&(j="晚上"+j),i=i.replace(/hh/g,j)}return i},b.toLocalDateString=function(a){if(!(a instanceof Date))return"";var c=new Date;return c.getFullYear()>a.getFullYear()?b.toDateString(a,"yyyy年MM月dd日"):b.isSameDay(a,c)?b.toDateString(a,"今天 HH:mm"):(c.setDate(c.getDate()-1),b.isSameDay(a,c)?b.toDateString(a,"昨天 HH:mm"):b.toDateString(a,"MM月dd日"))}}("undefined"!=typeof VRender),function(isFront){var StringUtils=isFront?VRender.Utils:exports;StringUtils.endWith=function(a,b){return!isEmptyStr(a)&&!isEmptyStr(b)&&(!(a.length<b.length)&&a.substring(a.length-b.length)==b)},StringUtils.format=function(text,data){for(var chars=String(text).split(""),length=chars.length,param=null,result="",i=0;i<length;i++){var ch=chars[i];if("{"===ch)if(null===param)param="";else{if(""!==param)break;result+="{",param=null}else if("}"===ch)if(null===param)result+="}";else{try{var value=eval(param);result+=value||0===value?value:""}catch(a){}param=null}else null===param?result+=ch:param+=ch}return result},StringUtils.isBlank=function(a){return a?"string"==typeof a&&0===String(a).replace(/\s+/g,"").length:"0"!==a&&0!==a&&!1!==a},StringUtils.isNotBlank=function(a){return!StringUtils.isBlank(a)},StringUtils.startWith=function(a,b){return!isEmptyStr(a)&&!isEmptyStr(b)&&(!(a.length<b.length)&&a.substr(0,b.length)===b)},StringUtils.strLen=function(a,b){return isEmptyStr(a)?0:(b&&(a=a.replace(/[\u4E00-\u9FFF]/g,"..")),a.length)},StringUtils.trimToEmpty=function(a){return StringUtils.isBlank(a)?"":(""+a).trim()},StringUtils.trimToNull=function(a){return StringUtils.isBlank(a)?null:(""+a).trim()};var isEmptyStr=function(a){return void 0===a||null===a||0===a.length}}("undefined"!=typeof VRender),function(a){var b=a?VRender.Utils:exports,c="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),d=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/,e=new RegExp("^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$");b.equal=function(a,c){if(a==c)return!0;if(b.isNull(a))return b.isNull(c);if(b.isNull(c))return!1;if("object"!=typeof a||"object"!=typeof c)return a===c;if(a instanceof Array){if(c instanceof Array){if(a.length!==c.length)return!1;for(var d=0,e=a.length;d<e;d++)if(!b.equal(a[d],c[d]))return!1;return!0}return!1}return a.hasOwnProperty("id")?a.id==c.id:a.hasOwnProperty("code")?a.code==c.code:!!a.hasOwnProperty("value")&&a.value==c.value},b.exec=function(a,c,d,e,f){if(b.isFunction(a)?(e=a,f=c,a=c=d=null):a instanceof Array&&(f=e,e=d,d=c,c=a,a=null),c&&(b.isFunction(c)?(f=d,e=c,c=d=null):c instanceof Array||(f=e,e=d,d=c,c=null)),d&&b.isFunction(d)&&(f=e,e=d,d=null),a||(a=this),b.isFunction(e)||(e=function(){}),c&&0!==c.length){var g=0,h=c.length;if(f){var i=[];for(g=0;g<c.length;g++)c[g].call(a,d,function(b,c){h-=1,b&&i.push(b),h<=0&&e.call(a,i.join("")||!1,c||d)})}else{var j=function(b,f){b?e.call(a,b,d):(g+=1,g<h?c[g].call(a,f||d,j):e.call(a,!1,f||d))};c[0].call(a,d,j)}}else e.call(a,!1,d)},b.extend="undefined"!=typeof $?$.extend:null,b.getIndexValue=function(a){return a||0===a?isNaN(a)?-1:(a=parseInt(a),a>=0?a:-1):-1},b.getFormatSize=function(a,b){return a||0===a?isNaN(a)?a:(a=parseFloat(a)||0,b?a/100+"rem":a+"px"):null},b.getSelection=function(){return window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection},b.getSelectionRange=function(){var a=b.getSelection();return a&&a.createRange?a.createRange():a.getRangeAt(0)},b.getUAState=function(a){var b={ie:!1,chrome:!1,firefox:!1,opera:!1,safari:!1},c=a.toLowerCase();return/micromessenger/.test(c)?b.wx=!0:/msie ([\d.]+)/.test(c)?b.ie=!0:/firefox\/([\d.]+)/.test(c)?b.firefox=!0:/chrome\/([\d.]+)/.test(c)?b.chrome=!0:/opera.([\d.]+)/.test(c)?b.opera=!0:/safari/.test(c)&&/version\/([\d.]+)/.test(c)&&(b.safari=!0),b.isIphone=/iphone/.test(c),b.isAndroid=/android/.test(c),b.isMobile=/mobile/.test(c)||b.isIphone||b.isAndroid,b},b.getViewScreenOffset=function(a){a=$(a);for(var b=a.offset(),c=b.left,d=b.top,e=a.parent();e&&e.length>0&&(c-=e.scrollLeft(),d-=e.scrollTop(),!e.is("html"));)e=e.parent();var b={left:c,top:d};return b.right=$(window).width()-c-a.outerWidth(),b.bottom=$(window).height()-d-a.outerHeight(),b},b.isAlphaKey=function(a,b){return a.which>=65&&a.which<=90||!!(b&&a.which>=97&&a.which<=122)},b.isControlKey=function(a){return!!(a.ctrlKey||a.metaKey||a.shiftKey)||[8,37,38,39,40,116,9,17,16,13,20].indexOf(a.which)>=0},b.isDomExist=function(a){return a&&$("body").find(a).length>0},b.isEmail=function(a){return a&&d.test(""+a)},b.isEmpty=function(a){if(void 0===a)return!0;if(null===a)return!0;if(""===a)return!0;for(var b in a)return!1;return!0},b.isFunction=function(a){return a&&"function"==typeof a},b.isMobile=function(a){return a&&/^1\d{10}$/.test(""+a)},b.isNull=function(a){return void 0===a||null===a},b.isNumberKey=function(a){return!a.shiftKey&&(a.which>=48&&a.which<=57||a.which>=96&&a.which<=105)},b.isNotEmpty=function(a){return!b.isEmpty(a)},b.isNotNull=function(a){return!b.isNull(a)},b.isNumberic=function(a){return!b.isNull(a)&&("number"==typeof a||!isNaN(a))},b.isPhone=function(a){return a&&/^(0(10|2\d|[3-9]\d{2})-)?\d{7,8}(-\d{1,8})?$/.test(""+a)},b.isPrimitive=function(a){return"string"==typeof a||"number"==typeof a},b.isTrue=function(a){return!!a&&(!0===a||1===a||!("false"===(a=String(a).toLowerCase())||"no"===a||"0"===a))},b.isUrl=function(a){return a&&e.test(""+a)},b.notNull=b.isNotNull,b.offsetWindow=function(a){a=$(a);for(var b=a.offset();;){if(!((a=a.parent())&&a.length>0))break;if(b.left-=a.scrollLeft(),b.top-=a.scrollTop(),a.is("html"))break}return b},b.parentUntil=function(a,b,c){for(var a=$(a);null!=a&&a.length>0;){if(a.is(b))return a;if(c&&a.is(c))return $("");a=a.parent()}return $("")},b.parseUrl=function(a){var b=document.createElement("a");b.href=a||"";var c={};if(c.origin=a,c.href=b.href,c.protocol=b.protocol.replace(":",""),c.host=b.host,c.hostname=b.hostname,c.port=b.port,c.pathname=b.pathname,c.search=b.search,c.hash=b.hash,c.params={},b.search)for(var d=b.search.substr(1).split("&"),e=0,f=d.length;e<f;e++){var g=d[e].split("=");c.params[g[0]]=g[1]}return c},b.randomTxt=function(a){for(var b=[],d=c,e=0;e<a;e++)b.push(d[Math.ceil(61*Math.random())]);return b.join("")},b.toLocalMobile=function(a,c){if(!b.isMobile(a))return a;var d=[];return c&&d.push("+86"),d.push(a.substr(0,3)),d.push(a.substr(3,4)),d.push(a.substr(7,4)),d.join(" ")}}("undefined"!=typeof VRender),function(){if("undefined"!=typeof VRender&&!VRender.EventEmitter){var a=VRender.Utils,b=VRender.EventEmitter=function(){},c=b.prototype=new Object;c.trigger=function(b,c){var d="string"==typeof b?{type:b}:b;if(d&&a.isNotBlank(d.type)&&a.isArray(this.events))for(var e=Array.prototype.splice.call(arguments,1),f=this.events.length-1;f>=0;f--){var g=this.events[f];g.name===d.type&&(d.data=g.data,d.preventDefault=function(){d.isPreventDefault=!0},g.listener.apply(this,[d].concat(e)),delete d.data,delete d.preventDefault,g.once&&this.events.splice(f,1))}return this},c.on=function(b,c,d){return"string"==typeof b&&a.isNotBlank(b)&&(a.isFunction(c)&&!a.isFunction(d)&&(d=c,c=null),a.isFunction(d)&&(a.isArray(this.events)||(this.events=[]),this.events.push({name:b,data:c,listener:d}))),this},c.one=function(b,c,d){return"string"==typeof b&&a.isNotBlank(b)&&(a.isFunction(c)&&!a.isFunction(d)&&(d=c,c=null),a.isFunction(d)&&(a.isArray(this.events)||(this.events=[]),this.events.push({name:b,data:c,listener:d,once:!0}))),this},c.off=function(b,c){return a.removeItems(this.events,function(d){if(d.name===b)return!a.isNotNull(c)||d.listener==c}),this},c.hasListen=function(b){return!!a.find(this.events,function(a){return a.name===b})}}}(),function(){if("undefined"!=typeof VRender&&!VRender.FrontComponent){var a=VRender.Utils,b=VRender.FrontComponent=function(a,b){this.className=a,this.ComponentClass=b},c=b.prototype=new VRender.EventEmitter;c.find=function(a,b){a=$(a),a.is(this.className)||(a=a.find(this.className));var c=[],d=this;return a.each(function(){c.push(d.make(this,b))}),c},c.create=function(b){var c=$("<div></div>");b=b||{},b.target&&(b.targetAsInstance?c=b.target:c.appendTo(b.target)),c.addClass(this.className),a.isNotBlank(b.name)&&c.attr("name",b.name).addClass(b.name),a.isFunction(this.render)&&this.render(c,b);var d=new this.ComponentClass(c,b);return c.data("mfhInstance",d),d},c.make=function(a,b){a=$(a);var c=a.data("mfhInstance");return c||(c=new this.ComponentClass(a,b),a.data("mfhInstance",c)),c},VRender.frontComponent=function(a,c,d){var e=new b(a,c);return e.render=d,e}}}(),function(a){if(a||(VRender.Component.Render||(VRender.Component.Render={}),!VRender.Component.Render.base)){var b=a?require(__vrender__).Utils:VRender.Utils,c=function(a,c){if(a&&a._vr_adapter_flag)return a;var d=this.options.dataAdapter||this.options.adapter;return b.isFunction(this.getDataAdapter)&&(d=this.getDataAdapter()),b.isFunction(d)&&(a=d(a,c))&&(a._vr_adapter_flag=!0),a},d=function(a){var c=this.options.dataMapper||this.options.mapper;if(b.isFunction(this.getDataMapper)&&(c=this.getDataMapper()),b.isFunction(c))return c(a);if(b.isNull(a))return null;if(b.isPrimitive(a))return a;var d={};return a.hasOwnProperty("id")&&(d.id=a.id),a.hasOwnProperty("code")&&(d.code=a.code),a.hasOwnProperty("name")&&(d.name=a.name),a.hasOwnProperty("value")&&(d.value=a.value),a.hasOwnProperty("label")&&(d.label=a.label),a.hasOwnProperty("text")&&(d.text=a.text),a.hasOwnProperty("status")&&(d.status=a.status),d},e=function(a){if(b.isBlank(a))return null;if("string"==typeof a)return a;var c=this.options.idField;return b.isFunction(this.getIdField)&&(c=this.getIdField()),b.isNotBlank(c)?a[c]:a.hasOwnProperty("id")?a.id:a.hasOwnProperty("code")?a.code:a.hasOwnProperty("value")?a.value:null},f=function(a,c){var d=this.options.labelFunction;if(b.isFunction(this.getLabelFunction)&&(d=this.getLabelFunction()),b.isFunction(d))return d(a,c);if(b.isBlank(a))return"";if("string"==typeof a)return a;var e=this.options.labelField;return b.isFunction(this.getLabelField)&&(e=this.getLabelField()),b.isNotBlank(e)?b.isNull(a[e])?"":a[e]:a.hasOwnProperty("label")?b.isNull(a.label)?"":a.label:a.hasOwnProperty("name")?b.isNull(a.name)?"":a.name:a.hasOwnProperty("value")?b.isNull(a.value)?"":a.value:a.hasOwnProperty("text")?b.isNull(a.text)?"":a.text:""+a},g=function(a,b){b?(this.context=a,this.options=b||{}):(this.context=null,this.options=a||{})},h=g.prototype=new Object;g.render=function(a,b){this.renderData(a,b),g.renderFunction(b,"adapter",this.getDataAdapter()),g.renderFunction(b,"mapper",this.getDataMapper())},g.renderData=function(a,c,d){if(d=this.getMapData(d))if(b.isPrimitive(d))c.attr("data-v",d);else for(var e in d)c.attr("data-"+e,d[e])},g.renderFunction=function(c,d,e){a&&b.isFunction(e)&&c.write("<div class='ui-fn' name='"+d+"' fn-state='"+(e._state||"")+"' fn-data='"+(e._data||"")+"'>"+escape(e)+"</div>")},h.render=function(a,b){g.render.call(this,a,b)},h.renderData=function(a,b){g.renderData.call(this,a,b,this.getData(!0))},h.isRenderAsApp=function(){return a?!(!this.context||!b.isFunction(this.context.isRenderAsApp))&&this.context.isRenderAsApp():VRender.ENV.isApp},h.isRenderAsIphone=function(){return a?!(!this.context||!b.isFunction(this.context.isRenderAsIphone))&&this.context.isRenderAsIphone():VRender.ENV.isIphone},h.isRenderAsRem=function(){return a?!(!this.context||!b.isFunction(this.context.isRenderAsRem))&&this.context.isRenderAsRem():VRender.ENV.useRem},h.getData=function(){return this.options.data=this._doAdapter(this.options.data),this.options.data},h.getDataAdapter=function(){return this.options.dataAdapter||this.options.adapter},h.getDataMapper=function(){return this.options.dataMapper||this.options.mapper},h.getMapData=function(a){return d.call(this,a)},h._getDataId=function(a){return e.call(this,a)},h._getDataLabel=function(a){return f.call(this,a)},h._doAdapter=function(a){return c.call(this,a)};var i=function(a,b){g.call(this,a,b)},j=i.prototype=new g;i.render=function(a,c){g.render.call(this,a,c);var d=this.getIdField();b.isNotBlank(d)&&c.attr("opt-idfield",d);var e=this.getLabelField();b.isNotBlank(e)&&c.attr("opt-label",e),this.isMultiple()&&c.attr("multiple","multiple"),i.renderFunction(c,"lblfunc",this.getLabelFunction()),i.renderFunction(c,"irender",this.getItemRenderer()),this.renderSelectValues(a,c),this._renderItems(a,c)},i.renderData=function(a,c,d){d=b.toArray(d)||[],c.attr("data-items",escape(JSON.stringify(d)))},i.renderItems=function(a,c,d){if((d=d||this.getData())&&d.length>0){var e=this.getSelectedIndex(!0),f=this.getSelectedId(!0)||[],g=this;b.each(d,function(b,d){var h=g._getNewItem(a,c,b,d);if(h){var i=g._isSelected(b,d,e,f);g._renderOneItem(a,h,b,d,i)}})}},i.renderOneItem=function(c,d,e,f,g,h){a?this.renderItemData(c,d,f):d.data("itemData",f),h&&d.addClass("selected"),e=e||d;var i=this.getItemRenderer();if(b.isFunction(i)){var j=null;j=i._state?i.call(this,c,d,f,g,h):i(c,d,f,g,h),b.isNotNull(j)&&e.empty().append(j)}else{var k=this._getDataLabel(f,g,h);e.html(b.isNull(k)?"":k)}},i.renderFunction=function(a,b,c){g.renderFunction(a,b,c)},i.renderPager=function(a,c){c&&(b.isFunction(c.getViewId)?a.attr("opt-pager","[vid='"+c.getViewId()+"']"):"string"==typeof c&&a.attr("opt-pager",b.trimToNull(c)))},i.renderEmptyView=function(a,c,d){var e=a("<div></div>").appendTo(c);e.addClass((d||"ui")+"-empty");var f=null;if(this.options.hasOwnProperty("emptyView"))(f=this.options.emptyView)&&(b.isFunction(f.render)?f.render(e):e.append(f));else{f=a("<div></div>").appendTo(e),f.addClass((d||"ui")+"-emptydef");var g=this.options.emptyText||this.options.empty;g=b.isNull(g)?"没有数据":b.trimToEmpty(g),g&&a("<p></p>").appendTo(f).html(g)}return e},i.renderLoadView=function(a,c,d){var e=a("<div></div>").appendTo(c);e.addClass((d||"ui")+"-load");var f=this.options.loadingView;if(f)b.isFunction(f.render)?f.render(e):e.append(f);else{var f=a("<div></div>").appendTo(e);f.addClass((d||"ui")+"-loaddef");var g=this.options.loadingText;g=b.isNull(g)?"正在加载..":b.trimToEmpty(g),g&&a("<p></p>").appendTo(f).html(g)}return e},i.getSelectedIndex=function(a){var c=this.options.selectedIndex;if(b.isBlank(c))return a||this.isMultiple()?null:-1;b.isArray(c)||(c=(""+c).split(","));var d=[];return b.each(c,function(a){if(!isNaN(a)){var b=parseInt(a);!isNaN(b)&&b>=0&&d.push(b)}}),a||this.isMultiple()?d.length>0?d:null:d.length>0?d[0]:-1},i.getSelectedId=function(a){var c=this.options.selectedId;if(b.isBlank(c))return a||this.isMultiple()?[]:null;b.isArray(c)||(c=(""+c).split(","));var d=[];return b.each(c,function(a){(a||0===a)&&d.push(isNaN(a)?a:parseInt(a))}),a||this.isMultiple()?d:d.length>0?d[0]:null},i.getSelectedData=function(a){var b=[];if(a&&a.length>0)for(var c=this.getSelectedIndex(!0),d=this.getSelectedId(!0)||[],e=0,f=a.length;e<f;e++){var g=a[e];this._isSelected(g,e,c,d)&&b.push(g)}return b},i.isSelected=function(a,c,d,e){if(b.isNotBlank(d))return!(isNaN(c)||!c&&0!==c)&&(!((c=parseInt(c)||0)<0)&&(b.isArray(d)||(d=(""+d).split(",")),b.index(d,function(a){return a==c})>=0));if(b.isNotBlank(e)){var f=this._getDataId(a);return b.isArray(e)||(e=(""+e).split(",")),b.index(e,function(a){return a==f})>=0}return!1},i.checkIfEmpty=function(a,b){},j.render=function(a,b){i.render.call(this,a,b)},j.renderData=function(c,d){var e=this.getData(!0),f=this.getDataMapper();b.isFunction(f)&&(e=b.map(e,f)),i.checkIfEmpty.call(this,d,e),a&&i.renderData.call(this,c,d,e)},j.renderItemData=function(a,b,c){g.renderData.call(this,a,b,c)},j.renderSelectValues=function(a,c){var d=this.getSelectedIndex(!0);d=d&&d.join(","),b.isNotBlank(d)&&c.attr("data-inds",d);var e=this.getSelectedId(!0);e=e&&e.join(","),b.isNotBlank(e)&&c.attr("data-ids",e),this.options.apiName&&(c.attr("data-tryindex",d),c.attr("data-tryid",e))},j._renderItems=function(a,b){var c=this._getItemContainer(a,b);c&&i.renderItems.call(this,a,c)},j._renderOneItem=function(a,b,c,d,e){i.renderOneItem.call(this,a,b,null,c,d,e)},j._getItemContainer=function(a,b){return b},j._getNewItem=function(a,b,c,d){return a("<li></li>").appendTo(b)},j.getData=function(){var a=b.toArray(this.options.data);if(a._vr_adapter_flag)return a;var c=this;return a=b.map(a,function(a,b){return c._doAdapter(a,b)}),a._vr_adapter_flag=!0,this.options.data=a,a},j.getIdField=function(){return this.options.idField},j.getLabelField=function(){return this.options.labelField},j.getLabelFunction=function(){return this.options.labelFunction},j.getItemRenderer=function(){return this.options.itemRenderer},j.isMultiple=function(){return this.options.hasOwnProperty("multiple")?b.isTrue(this.options.multiple):b.isTrue(this.options.multi)},j.isAllSelected=function(a){var a=a||this.getData();if(a&&a.length>0){for(var b=this.getSelectedIndex(!0),c=this.getSelectedId(!0)||[],d=0,e=a.length;d<e;d++)if(!this._isSelected(a[d],d,b,c))return!1;return!0}return!1},j.getSelectedIndex=function(a){return i.getSelectedIndex.call(this,a)},j.getSelectedId=function(a){return i.getSelectedId.call(this,a)},j.getSelectedData=function(a){var b=i.getSelectedData.call(this,this.getData());return a||this.isMultiple()?b:b.length>0?b[0]:null},j._getDataLabel=function(a,b){return f.call(this,a,b)},j._isSelected=function(a,b,c,d){return c||d||(c=this.getSelectedIndex(!0),d=this.getSelectedId(!0)),i.isSelected.call(this,a,b,c,d)},j._doAdapter=function(a,b){return c.call(this,a,b)},a?(g.doAdapter=c,i.doAdapter=c,module.exports={},module.exports.BaseRenderer=g,module.exports.ListRenderer=i):(VRender.Component.Render._base=g,VRender.Component.Render._list=i,VRender.Component.Render.fn={},VRender.Component.Render.fn.getMapData=d,VRender.Component.Render.fn.getDataId=e,VRender.Component.Render.fn.getDataLabel=f,VRender.Component.Render.fn.doAdapter=c,VRender.Component.Render.fn.renderItems=i.renderItems,VRender.Component.Render.fn.renderOneItem=i.renderOneItem)}}("undefined"==typeof VRender),function(){if("undefined"==typeof VRender)return module.exports={HolderBase:function(){},HolderItems:function(){}};if(!VRender.Component.base){var a=VRender.Utils,b=VRender.Component,c=function(a){},d=c.prototype=new VRender.EventEmitter;c.init=function(a,c){var d=this.$el=$(a);if(d.data(b.bindName))return d.data(b.bindName);d.data(b.bindName,this),this.options=c||{},g.call(this,d,this.options);var e=this;return setTimeout(function(){h.call(e)},0),this},c.doAdapter=function(a){return b.Render.fn.doAdapter.call(this,a)},c.getFunction=function(b,c){if(this.options.hasOwnProperty(b))return this.options[b];if(this.hasOwnProperty(b))return this[b];var d=null,e=this.$el.children(".ui-fn[name='"+c+"']");if(e&&e.length>0){if(d=e.text(),a.isNotBlank(d)&&(d=new Function("var Utils=VRender.Utils;return ("+unescape(d)+");")(),d._state=e.attr("fn-state")||null,d._data=e.attr("fn-data")||null,d._data))try{d._data=JSON.parse(d._data)}catch(a){}e.remove()}return this[b]=d,d},d.init=function(a,b){return c.init.call(this,a,b)},d.isRenderAsApp=function(){return VRender.ENV.isApp},d.isRenderAsIphone=function(){return VRender.ENV.isIphone},d.isRenderAsRem=function(){return VRender.ENV.useRem},d.getData=function(){return this.options.data=this._doAdapter(this.options.data),this.options.data},d.setData=function(a){this.options.data=a,this._dataChanged("set",this.getData())},d.getDataAdapter=function(){return this.options.hasOwnProperty("adapter")?this.options.adapter:c.getFunction.call(this,"dataAdapter","adapter")},d.setDataAdapter=function(a){this.options.adapter=a,delete this.options.dataAdapter},d.getDataMapper=function(){return this.options.hasOwnProperty("mapper")?this.options.mapper:c.getFunction.call(this,"dataMapper","mapper")},d.setDataMapper=function(a){this.options.mapper=a,delete this.options.dataMapper},
d.isEnabled=function(){return!this.$el.is(".disabled")},d.setEnabled=function(b){void 0!==b&&null!==b||(b=!0),a.isTrue(b)?this.$el.removeClass("disabled").removeAttr("disabled"):this.$el.addClass("disabled").attr("disabled","disabled")},d.load=function(c,d,e){if(c=c||this.lastLoadApi,a.isBlank(c))return!1;var f=this,g=this.loadTimerId=Date.now();this.$el.addClass("is-loading"),b.load.call(this,c,d,function(b,c){g==f.loadTimerId&&(f.$el.removeClass("is-loading"),b||(f.options.data=c,a.isFunction(f.setData)&&f.setData(c)),a.isFunction(e)&&e(b,c),f.trigger("loaded",b,c))})},d.reload=function(b){a.isFunction(this.load)&&this.load(this.lastLoadApi,this.lastLoadParams,b)},d.tap=function(b,c,d,e){a.isFunction(b)&&(c,d=b,b=c=null),a.isFunction(c)&&(d=c,c=null),this.$el.on("tap",b,c,d)},d._dataChanged=function(a,b){},d._getDataId=function(a){return b.Render.fn.getDataId.call(this,a)},d._getDataLabel=function(a,c){return b.Render.fn.getDataLabel.call(this,a,c)},d._doAdapter=function(a){return c.doAdapter.call(this,a)},d._isMounted=function(){return $("body").find(this.$el).length>0},d._snapshoot=function(){var b={},c={},d=this,e={};return this._rootSnapshoot||(this._rootSnapshoot=e),e.shoot=function(c,e){if(c=c||b,a.isFunction(d._snapshoot_shoot)){var f=Array.prototype.slice.call(arguments);f[0]=c,d._snapshoot_shoot.apply(d,f)}else c.data=d.getData()},e.compare=function(e){var f=Array.prototype.slice.call(arguments);return a.isFunction(d._snapshoot_compare)?d._snapshoot_compare.apply(d,[b].concat(f)):(this.shoot.apply(this,[c].concat(f)),b.data==c.data)},e.done=function(a){var e=!1;if(d._rootSnapshoot==this){var f=Array.prototype.slice.call(arguments);this.compare.apply(this,f)||(this.shoot.apply(this,[c].concat(f)),d.trigger("change",c.data,b.data),e=!0)}return this.release(),e},e.release=function(){d._rootSnapshoot==this&&(d._rootSnapshoot=null)},e.getState=function(){return b},e.shoot(b),c.data=b.data,e};var e=function(){},f=e.prototype=new c;e.doAdapter=function(a,c){return b.Render.fn.doAdapter.call(this,a,c)},e.getFunction=function(a,b){return c.getFunction.call(this,a,b)},e.getIntValues=function(b,c,d){a.isArray(b)||(b=a.isBlank(b)?[]:(""+b).split(",")),c=a.isNull(c)?Number.NEGATIVE_INFINITY:c,d=a.isNull(d)?Number.POSITIVE_INFINITY:d;var e=[];return a.each(b,function(a){isNaN(a)||(a=parseInt(a),!isNaN(a)&&e.indexOf(a)<0&&a>=c&&a<=d&&e.push(a))}),e},e.setSelectedIndex=function(b){var c=a.isFunction(this.length)?this.length()-1:null,d=e.getIntValues(b,0,c);return d.length>0&&!this.isMultiple()&&(d=[d[0]]),this.$el.attr("data-inds",d.join(",")),this.$el.removeAttr("data-ids"),d},e.riseSelectedIndex=function(b){var c=a.getIndexValue(b),d=this.getSelectedIndex(!0);d&&d.length>0&&(d=a.map(d,function(a){return a<c?a:a+1}),e.setSelectedIndex.call(this,d))},e.reduceSelectedIndex=function(b){var c=a.getIndexValue(b),d=this.getSelectedIndex(!0);d&&d.length>0&&(d=a.map(d,function(a){return a>c?a-1:a==c?-1:a}),e.setSelectedIndex.call(this,d))},e.equalIndex=function(a,b){if(a=e.getIntValues(a,0),b=e.getIntValues(b,0),a.length!=b.length)return!1;a.sort(function(a,b){return a>b}),b.sort(function(a,b){return a>b});for(var c=0,d=a.length;c<d;c++)if(a[c]!=b[c])return!1;return!0},e.renderItems=function(a,c){b.Render.fn.renderItems.call(this,$,a,c)},e.renderOneItem=function(a,c,d,e,f){b.Render.fn.renderOneItem.call(this,$,a,c,d,e,f)},e.isSelected=function(b,c,d,e){if(a.isNull(d)&&a.isNull(e)&&(d=this.$el.attr("data-inds"),e=this.$el.attr("data-ids")),a.isNotNull(d)){if(isNaN(c))return!1;if(c=parseInt(c),isNaN(c)||c<0)return!1;a.isArray(d)||(d=(""+d).split(","));var f=a.index(d,function(a){return a==c});return f>=0}if(a.isNotBlank(e)){var g=this._getDataId(b);a.isArray(e)||(e=(""+e).split(","));var f=a.index(e,function(a){return a==g});return f>=0}return!1},e.addItem=function(b,c){c=a.getIndexValue(c);var d=this.getData();b=e.doAdapter.call(this,b,c);var f=null,g=this._getItemContainer();if(g&&g.length>0&&(f=this._getNewItem($,g,b,c))){if(c>=0&&c<d.length){var h=this._getItems();h&&h.length>0&&h.eq(c).before(f)}this._renderOneItem($,f,b,c,!1)}return c>=0&&c<d.length?(e.riseSelectedIndex.call(this,c),d.splice(c,0,b)):d.push(b),f},e.updateItem=function(b,c){if(b=e.doAdapter.call(this,b,c),(c=c||0===c?a.getIndexValue(c):this.getDataIndex(b))>=0){var d=this.getData();if(c<d.length){var f=this._getItemContainer();if(f&&f.length>0){var g=this._getItems(),h=this._getNewItem($,f,b,c);if(h){g.eq(c).before(h).remove();var i=this.isSelectedIndex(c);this._renderOneItem($,h,b,c,i)}else g.eq(c).remove()}d.splice(c,1,b)}else c=-1}return c},e.removeItem=function(b,c){if(b&&b.length>0)c=b.index();else{if((c=a.getIndexValue(c))<0)return null;var d=this._getItems();d&&d.length>c&&(b=d.eq(c))}b&&b.length>0&&b.remove();var f=this.getData();return f&&f.length>c?(e.reduceSelectedIndex.call(this,c),f.splice(c,1)):null},e.initPager=function(){if(this.options.hasOwnProperty("pager"))this.setPager(this.options.pager);else{var a=this.$el.attr("opt-pager");a=a&&$(a),a&&a.length>0&&this.setPaginator(b.get(a)||a),this.$el.removeAttr("opt-pager")}},e.getPager=function(){return this.pager},e.setPager=function(b){if(this.pager&&a.isFunction(this.pager.off)&&this.pager.off("change"),this.pager=b,this.pager&&a.isFunction(this.pager.on)){var c=this;this.pager.on("change",function(d,e){var f=$.extend({},c.lastLoadParams);f.p_no=e&&e.page,f.p_size=e&&e.size,!f.p_no&&a.isFunction(b.getPage)&&(f.p_no=b.getPage()),!f.p_size&&a.isFunction(b.getSize)&&(f.p_size=b.getSize()),f.p_no==c._pageNo&&f.p_size==c._pageSize||c.load(c.lastLoadApi,f)})}},e.checkIfEmpty=function(){var a=this._getItems();a&&a.length>0?this.$el.removeClass("is-empty"):this.$el.addClass("is-empty")},f.init=function(a,b){var d=c.init.call(this,a,b);return d===this&&(this._checkIfEmpty(),this._initPager()),d},f.setData=function(a){var b=this._snapshoot();this.options.data=this._doAdapter(a),e.setSelectedIndex.call(this,[]);var c=this._getItemContainer();c&&c.length>0&&this._renderItems($,c.empty(),this.options.data),this._checkIfEmpty(this.options.data),this._dataChanged("set",this.options.data),b.done([],[])},f.getDataAt=function(a){if(isNaN(a)||""===a)return null;if((a=parseInt(a))<0)return null;var b=this.getData()||[];return a<b.length?b[i]:null},f.getDataIndex=function(b){var c=this.getData();if(c&&c.length>0){var d=this,e=this._getDataId(b);return a.index(c,function(a){return a==b||d._getDataId(a)==e})}return-1},f.getDataById=function(a){return this.getDataAt(this.getIndexById(a))},f.getIndexById=function(b){var c=this.getData();if(c&&c.length>0){var d=this;return a.index(c,function(a){return d._getDataId(a)==b})}return-1},f.getDataByName=function(a){return this.getDataAt(this.getIndexByName(a))},f.getIndexByName=function(b){var c=this.getData();return c&&c.length>0?a.index(c,function(a){return a&&a.name==b}):-1},f.getIdField=function(){return this.options.idField||this.$el.attr("opt-idfield")},f.setIdField=function(b){this.options.idField=a.isBlank(b)?"":b,this.$el.attr("opt-idfield",this.options.idField)},f.getLabelField=function(){return this.options.labelField||this.$el.attr("opt-label")},f.setLabelField=function(a){this.options.labelField=a||"",this.$el.attr("opt-label",this.options.labelField)},f.getLabelFunction=function(){return c.getFunction.call(this,"labelFunction","lblfunc")},f.setLabelFunction=function(a){this.options.labelFunction=a},f.isEnabled=function(a){if("number"==typeof a){var b=this._getItemAt(a);return b&&!b.is(".disabled")}return"string"==typeof a?this.isEnabled(this.getIndexByName(a)):!this.$el.is(".disabled")},f.setEnabled=function(b,c){if("string"==typeof c)return this.setEnabled(b,this.getIndexByName(c));var d=this.$el;"number"==typeof c&&(d=this._getItemAt(c)),d&&(b=!!a.isNull(b)||a.isTrue(b),b?d.removeClass("disabled").removeAttr("disabled"):d.addClass("disabled").attr("disabled","disabled"))},f.length=function(){return a.toArray(this.getData()).length},f.isMultiple=function(){return"multiple"==this.$el.attr("multiple")},f.setMultiple=function(b){void 0!==b&&null!==b||(b=!0),a.isTrue(b)?this.$el.attr("multiple","multiple"):this.$el.removeAttr("multiple")},f.getItemRenderer=function(){return this.options.hasOwnProperty("renderer")?this.options.renderer:c.getFunction.call(this,"itemRenderer","irender")},f.setItemRenderer=function(a){this.options.renderer=a,delete this.options.itemRenderer},f.getSelectedIndex=function(b){var c=this.$el.attr("data-inds");if(a.isNull(c)){c=[];var d=this,f=this.getData(),g=this.$el.attr("data-ids");a.isNull(g)?a.each(f,function(a,b){d._isSelected(a,b,[],[])&&c.push(b)}):g.length>0&&(g=g.split(","),a.each(f,function(b,e){var f=d._getDataId(b);a.index(g,function(a){return a==f})>=0&&c.push(e)})),0==c.length&&(c=null)}else c=e.getIntValues(c,0);return b||this.isMultiple()?c:c&&c.length>0?c[0]:-1},f.setSelectedIndex=function(b){var c=this._snapshoot(),d=e.setSelectedIndex.call(this,b);if(!c.compare(d)){var f=this._getItems();f&&f.length>0&&(f.removeClass("selected"),a.each(d,function(a){f.eq(a).addClass("selected")}))}c.done(d)},f.isSelectedIndex=function(b){if((b=a.getIndexValue(b))<0)return!1;var c=this.getSelectedIndex(!0)||[];return this._isSelected(null,b,c,[])},f.getSelectedId=function(b){var c=this.$el.attr("data-ids"),d=this.$el.attr("data-inds");if(a.isNotNull(d)){if(c=[],d=e.getIntValues(d,0),d.length>0){var f=this,g=this.getData()||[];a.each(d,function(a){var b=a<g.length?g[a]:null;c.push(f._getDataId(b))})}}else if(a.isNull(c)){c=[];var f=this;a.each(this.getData(),function(a,b){f._isSelected(a,b,[],[])&&c.push(f._getDataId(a))}),0==c.length&&(c=null)}if(a.isNull(c))return null;a.isArray(c)||(c=c.split(","));var h=[];return a.each(c,function(a){(a||0===a)&&h.push(isNaN(a)?a:parseInt(a))}),b||this.isMultiple()?h:h.length>0?h[0]:null},f.setSelectedId=function(b){a.isArray(b)||(b=a.isBlank(b)?[]:a.trimToEmpty(b).split(","));var c=[],d=this;a.each(this.getData(),function(e,f){var g=d._getDataId(e);a.index(b,function(a){return a==g})>=0&&c.push(f)}),this.setSelectedIndex(c)},f.isSelectedId=function(b){if(a.isBlank(b))return!1;var c=this.getSelectedId(!0);return a.index(c,function(a){return a==b})>=0},f.getSelectedData=function(b){var c=this.$el.attr("data-inds"),d=this.$el.attr("data-ids")||[],e=[],f=this;return a.each(this.getData(),function(a,b){f._isSelected(a,b,c,d)&&e.push(a)}),b||this.isMultiple()?e:e.length>0?e[0]:null},f.isAllSelected=function(){var a=this.length();if(a>0){var b=this.getSelectedIndex(!0);if(b&&b.length==a)return!0}return!1},f.addItem=function(b,c){if(a.isNotNull(b)){var d=this._snapshoot();e.addItem.call(this,b,c),this._checkIfEmpty(),this._dataChanged("add",b,this.getDataIndex(b)),d.done()}},f.updateItem=function(b,c){a.isNotNull(b)&&(c=e.updateItem.call(this,b,c),this._dataChanged("update",b,c))},f.removeItem=function(a){return this.removeItemAt(this.getDataIndex(a))},f.removeItemAt=function(a){var b=this._snapshoot(),c=e.removeItem.call(this,null,a);return c&&(this._checkIfEmpty(),this._dataChanged("delete",c,a)),b.done(),c},f.addOrUpdateItem=function(a){var b=this.getDataIndex(a);b>=0?this.updateItem(a,b):this.addItem(a,b)},f.getItemData=function(a){var b=$(a);if(b&&b.length>0){var c=this._getItemContainer();if(c&&c.length>0){for(a=b.parent();;){if(!a||0==a.length){b=null;break}if(a.is(c))break;b=a,a=b.parent()}if(b&&b.length>0)return this._getItemData(b)}}return null},f._renderItems=function(a,b,c){c=c||this.getData(),e.renderItems.call(this,b,c)},f._renderOneItem=function(a,b,c,d,f){e.renderOneItem.call(this,b,null,c,d,f)},f._getItemContainer=function(){return this.$el},f._getItems=function(a){var b=this._getItemContainer();if(b&&b.length>0)return b.children(a)},f._getItemAt=function(b){return b=a.getIndexValue(b),b>=0?a.find(this._getItems(),function(a,c){var d=parseInt(a.attr("opt-ind"));return isNaN(d)&&(d=c),b==d}):null},f._getNewItem=function(a,b,c,d){return a("<li></li>").appendTo(b)},f._getItemData=function(b,c){var d=b.data("itemData");if(!d){var e=this.getData(!0);a.isArray(e)&&((isNaN(c)||!c&&0!==c)&&(c=parseInt(b.attr("opt-ind")),isNaN(c)&&(c=b.index())),d=e[c])}return a.isEmpty(d)?null:d},f._isSelected=function(a,b,c,d){return e.isSelected.call(this,a,b,c,d)},f._doAdapter=function(b){var c=a.toArray(b);if(c._vr_adapter_flag)return c;var d=this;return c=a.map(c,function(a,b){return e.doAdapter.call(d,a,b)}),c._vr_adapter_flag=!0,c},f._checkIfEmpty=function(){e.checkIfEmpty.call(this)},f._initPager=function(){e.initPager.call(this)},f._snapshoot_shoot=function(a,b,c){a.selectedIndex=b||this.getSelectedIndex(),a.selectedData=c||this.getSelectedData(),a.data=a.selectedData},f._snapshoot_compare=function(a,b){return b||(b=this.getSelectedIndex(!0)),e.equalIndex(a.selectedIndex,b)};var g=function(b,c){a.isNotBlank(c.id)&&b.attr("id",c.id),a.isNotBlank(c.name)&&b.attr("name",c.name);var d=c.clsname||c.className||c.clsName||c.cls;if(a.isNotBlank(d)&&b.addClass(d),a.isNotBlank(c.style)&&b.addClass(c.style),c.hasOwnProperty("disabled")?this.setDisabled(a.isTrue(c.disabled)):c.hasOwnProperty("enabled")&&this.setDisabled(!a.isTrue(c.enabled)),!1===c.visible||"gone"===c.visible?b.css("display","none"):"hidden"===c.visible&&b.css("visibility","hidden"),a.isNotBlank(c.ref)&&b.attr("ref",c.ref),!c.data){var e=b.attr("data-items");c.data=e?JSON.parse(unescape(e)):b.data()}this.$el.removeAttr("data-items")},h=function(){if(j.call(this)&&a.isFunction(this.load)){var b=this.options.api||this.$el.attr("api-name"),c=null;if(this.options.hasOwnProperty("params"))c=this.options.params;else try{c=JSON.parse(this.$el.attr("api-params")||null)}catch(a){}c=$.extend({},c);var d=a.isFunction(this.getPaginator)&&this.getPaginator();d&&(!c.p_no&&a.isFunction(d.getPage)&&(c.p_no=d.getPage()),!c.p_size&&a.isFunction(d.getSize)&&(c.p_size=d.getSize()));var e=a.isFunction(this.getSearcher)&&this.getSearcher();e&&a.isFunction(e.getParams)&&(c=$.extend(c,e.getParams()));var f=this;this.load(b,c,function(){k.call(f)})}},j=function(){return this.options.hasOwnProperty("autoLoad")?a.isTrue(this.options.autoLoad):a.isTrue(this.$el.attr("api-autoload"))},k=function(){var b=this,c=function(c){a.isFunction(b.setSelectedIndex)&&b.setSelectedIndex(c)},d=function(c){a.isFunction(b.setSelectedId)&&b.setSelectedId(c)};this.options.hasOwnProperty("selectedIndex")?c(this.options.selectedIndex):a.isNotBlank(this.$el.attr("data-tryindex"))?c(this.$el.attr("data-tryindex")):this.options.hasOwnProperty("selectedId")?d(this.options.selectedId):a.isNotBlank(this.$el.attr("data-tryid"))&&d(this.$el.attr("data-tryid")),delete this.options.selectedIndex,delete this.options.selectedId,this.$el.removeAttr("data-tryindex"),this.$el.removeAttr("data-tryid")};b.base=c,b.list=e}}(),function(a){if(a||!VRender.Component.Render.dropdownlist){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").ListRenderer:VRender.Component.Render._list,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;d.getData=function(){this.options.data=g.call(this,this.options.data);var a=[];return b.each(this.options.data,function(c){b.each(c,function(b){a.push(b)})}),a},d.renderData=function(d,e){if(a){this.options.data=g.call(this,this.options.data);var f=this,h=b.map(this.options.data,function(a){return b.map(a,function(a){return f.getMapData(a)})});c.renderData.call(this,d,e,h)}},d.dataFormat=function(a){var c=[],d=[];return b.each(b.toArray(a),function(a){b.isArray(a)?(d.length>0&&(c.push(d),d=[]),c.push(a)):d.push(a)}),d.length>0&&c.push(d),c},e.render=function(a,b){return b.addClass("ui-dropdownlist"),b.append("<div class='items'></div>"),this.isMultiple()&&b.attr("multiple","multiple"),this.options.data=d.dataFormat.call(this,this.options.data),c.render.call(this,a,b),this},e.getData=function(){return d.getData.call(this)},e.renderData=function(a,b){d.renderData.call(this,a,b)},e._renderItems=function(a,b){var c=b.children(".items").empty();this.options.data=g.call(this,this.options.data),f.call(this,a,c,this.options.data)},e._renderOneItem=function(a,b,d,e,f){c.renderOneItem.call(this,a,b,null,d,e,f)};var f=function(c,d,e){var f=this,g=0,h=this.getSelectedIndex(!0),i=this.getSelectedId(!0)||[],j=function(b,d){var e=c("<div class='item'></div>").appendTo(b),j=f._isSelected(d,g,h,i);f._renderOneItem(c,e,d,g,j),e.attr(f.getMapData(d)),a?f.renderItemData(c,e,d):e.data("itemData",d)};b.each(b.toArray(e),function(a){if(b.isArray(a)&&a.length>0){var e=c("<div class='grp'></div>").appendTo(d);b.each(a,function(a){j(e,a),g+=1})}})},g=function(a){var c=b.toArray(a);if(c._vr_adapter_flag)return c;var d=this,e=0;return b.isFunction(this._doAdapter)&&(c=b.map(c,function(a){return b.map(a,function(a){return d._doAdapter(a,e++)})}),c._vr_adapter_flag=!0),c};a?module.exports=d:(d.doAdapter=g,d.renderItems=f,VRender.Component.Render.dropdownlist=d)}}("undefined"==typeof VRender),function(){if(!VRender.Component.DropdownList){var a=VRender.Utils,b=VRender.Component,c=b.Render.dropdownlist,d=window.UIDropdownList=b.DropdownList=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.options.data||(this.options.data=[]),this.tap(".item",f.bind(this))},e=d.prototype=new b.list;d.find=function(a){return b.find(a,".ui-dropdownlist",d)},d.create=function(a){return b.create(a,d,c)},d.addData=function(b,c){c=a.getIndexValue(c);var d=a.toArray(this.options.data);if(c>=0)for(var e=0,f=0,g=d.length;f<g;f++)for(var h=0,i=d[f].length;h<i;h++){if(e==c)return d[f].splice(h,0,b),e;e++}return d.length>0?d[d.length-1].push(b):d.push([b]),-1},d.updateData=function(b,c){if((c=isNaN(c)||""===c?this.getDataIndex(b):parseInt(c))>=0)for(var d=0,e=a.toArray(this.options.data),f=0,g=e.length;f<g;f++)for(var h=0,i=e[f].length;h<i;h++){if(d==c)return e[f].splice(h,1,b),d;d++}return-1},d.removeData=function(b){if((b=a.getIndexValue(b))>=0)for(var c=0,d=a.toArray(this.options.data),e=0,f=d.length;e<f;e++)for(var g=0,h=d[e].length;g<h;g++){if(c==b){var i=d[e].splice(g,1);return 0==d[e].length&&d.splice(e,1),{index:c,data:i}}c++}return{index:-1}},e.getData=function(){return c.getData.call(this)},e.setData=function(a){var d=this._snapshoot();a=c.dataFormat.call(this,a),this.options.data=c.doAdapter.call(this,a),b.list.setSelectedIndex.call(this,[]),this._dataChanged("set",this.options.data),d.done([],[])},e.addItem=function(c,e){a.isNotNull(c)&&(c=b.list.doAdapter.call(this,c,e),e=d.addData.call(this,c,e),e>=0&&b.list.riseSelectedIndex.call(this,e),this._dataChanged("add",c,this.getDataIndex(c)))},e.updateItem=function(c,e){a.isNotNull(c)&&(c=b.list.doAdapter.call(this,c,e),(e=d.updateData.call(this,c,e))>=0&&this._dataChanged("update",c,e))},e.removeItemAt=function(a){var c=d.removeData.call(this,a);if(c&&c.index>=0){var e=this._snapshoot();return b.list.reduceSelectedIndex.call(this,c.index),this._dataChanged("delete",c.data,c.index),e.done(),c.data}return null},e.matchFirst=function(b,c,d){if(a.isNotBlank(b))for(var e=this._getItems(),f=0,h=e.length;f<h;f++){var i=e.eq(f);if(g.call(this,i.text(),b,c,d))return[f,this.getItemData(i)]}return null},e._getItemContainer=function(){return null},e._getItems=function(){return this.$el.find(".item")},e._dataChanged=function(){var a=this.$el.children("ul").empty();c.renderItems.call(this,$,a,this.options.data)};var f=function(c){var d=$(c.currentTarget),e=this._snapshoot();if(this.isMultiple())d.toggleClass("selected");else{if(d.is(".selected"))return void e.release();this._getItems().removeClass("selected"),d.addClass("selected")}var f=[];a.each(this._getItems(),function(a,b){a.is(".selected")&&f.push(b)}),b.list.setSelectedIndex.call(this,f),e.done(f)},g=function(a,b,c,d){if(b==a)return!0;if(c&&b.length<a.length){var e=a.indexOf(b);if(e>=0)return!d||0===e}return!1};b.register(".ui-dropdownlist",d)}}(),function(a){if(a||!VRender.Component.Render.group){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;d.VERTICAL="vertical",d.HORIZONTIAL="horizontial",e.render=function(a,b){c.render.call(this,a,b),b.addClass("ui-group");var e=this.options||{},f=e.orientation;return f!==d.HORIZONTIAL&&f!==d.VERTICAL||(b.addClass(f),b.attr("opt-orientation",f)),b.attr("opt-gap",e.gap),b.attr("opt-align",e.align),this.renderSubViews(a,b),this},e.renderSubViews=function(a,b){f.call(this,a,b,this.getChildren())},e.getChildren=function(){return this.options.children||this.options.subViews||this.options.views};var f=function(a,c,d){d=b.toArray(d),b.each(d,function(a){b.isNotNull(a)&&(b.isFunction(a.render)?a.render(c):c.append(a.$el||a))}),g.call(this,a,c)},g=function(a,b){var c=top=align=valign=display="",e=b.attr("opt-gap")||"";e&&!isNaN(e)&&(e=parseInt(e),e=this.isRenderAsRem()?e/100+"rem":e+"px");var f=b.attr("opt-orientation");f==d.HORIZONTIAL?c=e:top=e;var g=b.attr("opt-align")||"";g=g.toLowerCase(),/left/.test(g)?align="left":/center/.test(g)?align="center":/right/.test(g)&&(align="right"),/top/.test(g)?valign="top":/middle/.test(g)?valign="middle":/bottom/.test(g)&&(valign="bottom"),b.css("text-align",align);var h=b.children();h.css("vertical-align",valign),h.css("margin-left",c).css("margin-top",top),h.eq(0).css("margin-left","").css("margin-top","")};a?module.exports=d:(d.showSubViews=f,d.updateLayout=g,VRender.Component.Render.group=d)}}("undefined"==typeof VRender),function(){if(!VRender.Component.Group){var a=VRender.Utils,b=VRender.Component,c=b.Render.group,d=window.UIGroup=b.Group=function(a,c){if(this.init(a,c)!==this)return b.get(a)},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-group",d)},d.create=function(a){return b.create(a,d,c)},e.setOrientation=function(a){this.$el.removeClass(c.HORIZONTIAL).removeClass(c.VERTICAL),this.$el.removeAttr("opt-orientation"),a!==c.HORIZONTIAL&&a!==c.VERTICAL||this.$el.addClass(a).attr("opt-orientation",a),f.call(this)},e.setGap=function(a){this.$el.removeAttr("opt-gap"),this.$el.attr("opt-gap",parseInt(a)||null),f.call(this)},e.setAlign=function(a){this.$el.removeAttr("opt-align"),this.$el.attr("opt-align",a||null),f.call(this)},e.append=function(b){if(!arguments||0==arguments.length)return this;for(var c=0,d=arguments.length;c<d;c++){var e=arguments[c];if(a.isArray(e))for(var f=0,g=e.length;f<g;f++)this.add(e[f]);else this.add(e)}return this},e.add=function(b,c){if(a.isNotBlank(b)){c=isNaN(c)||""===c?-1:parseInt(c);var d=this.$el.children();c>=0&&c<d.length?d.eq(c).before(b.$el||b):this.$el.append(b.$el||b),f.call(this)}return b},e.removeAt=function(a){var b=this.$el.children().eq(a).remove();return f.call(this),b};var f=function(){this.layoutTimerId&&clearTimeout(this.layoutTimerId);var a=this;this.layoutTimerId=setTimeout(function(){a.layoutTimerId=0,c.updateLayout.call(a,$,a.$el)},0)};b.register(".ui-group",d)}}(),function(a){if(a||!VRender.Component.Render.button){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;d.innerStyles=["ui-btn-default","ui-btn-primary","ui-btn-success","ui-btn-danger","ui-btn-warn","ui-btn-info","ui-btn-link","ui-btn-text"],d.sizes=["bigger","big","normal","small","tiny"],e.render=function(e,i){c.render.call(this,e,i),i.addClass("ui-btn");var j=this.options||{},k=j.size;k&&d.sizes.indexOf(k)>=0&&i.addClass(k);var l=j.style||"";d.innerStyles.indexOf(l)<0&&i.addClass(h(j.type));var m=e("<button class='btn'></button>").appendTo(i),n=g.call(this);if(b.isNotBlank(n)){e("<i class='icon'></i>").appendTo(m).css(a?"background-image":"backgroundImage","url("+n+")")}return b.isNotBlank(j.label)&&e("<span></span>").appendTo(m).text(b.trimToEmpty(j.label)||" "),f.call(this,e,i),this};var f=function(a,c){var d=this.options.wait;!0===d?c.attr("opt-wait","-1"):d&&!isNaN(d)&&c.attr("opt-wait",Math.max(0,parseInt(d))),b.isTrue(this.options.waitting)&&c.addClass("waitting")},g=function(){var a=this.options.icon;if(!0===a){var b=this.options.type;"success"==b?a="012b.png":"warn"==b?a="013b.png":"danger"==b?a="014b.png":"info"==b&&(a="015b.png"),!0!==a&&(a="/VRender/icons/"+a)}return"string"==typeof a?a:null},h=function(a){if(b.isNotBlank(a)){if(["ok","submit","save","primary","major"].indexOf(a)>=0)return"ui-btn-primary";if(["danger","error"].indexOf(a)>=0)return"ui-btn-danger";if(["success","complete","finish"].indexOf(a)>=0)return"ui-btn-success";if(["warn","warning"].indexOf(a)>=0)return"ui-btn-warn";if(["info","highlight"].indexOf(a)>=0)return"ui-btn-info";if("text"===a)return"ui-btn-text";if("link"===a)return"ui-btn-link"}return"ui-btn-default"};a?module.exports=d:VRender.Component.Render.button=d}}("undefined"==typeof VRender),function(){if(!VRender.Component.Button){var a=VRender.Utils,b=VRender.Component,c=b.Render.button,d=window.UIButton=b.Button=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.$el.on("tap",f.bind(this))},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-btn",d)},d.create=function(a){return b.create(a,d,c)},e.val=function(b){var c=this.$el.children("button");return a.isNotNull(b)&&c.text(b),c.text()},e.waitting=function(b){b=a.isNull(b)||!0===b?parseInt(this.$el.attr("opt-wait"))||-1:b?isNaN(b)?a.isTrue(b)?parseInt(this.$el.attr("opt-wait"))||-1:0:Math.max(0,parseInt(b)):0,g.call(this,b)},e.isWaitting=function(){return this.$el.is(".waitting")},e.setWaitting=function(b){b=!0===b||a.isNull(b)?-1:b?isNaN(b)?a.isTrue(b)?-1:0:Math.max(0,parseInt(b)):0,this.$el.attr("opt-wait",b)};var f=function(a){if(!this.$el.is(".disabled, .waitting")){this.trigger("tap");var b=parseInt(this.$el.attr("opt-wait"));b&&g.call(this,b)}},g=function(a){if(this.waittingTimerId&&(clearTimeout(this.waittingTimerId),this.waittingTimerId=0),a){var b=this.$el.addClass("waitting");if(a>0){var c=this;this.waittingTimerId=setTimeout(function(){c.waittingTimerId=0,b.removeClass("waitting")},a)}}else this.$el.removeClass("waitting")};b.register(".ui-btn",d)}}(),function(a){if(a||!VRender.Component.Render.checkbox){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)};(d.prototype=new c).render=function(a,d){c.render.call(this,a,d),d.addClass("ui-chkbox");var e=this.options||{},f=a("<input type='checkbox'/>").appendTo(d);return b.isNotNull(e.value)&&f.val(e.value),b.isTrue(e.checked)&&(d.addClass("checked"),f.attr("checked","checked")),b.isNotNull(e.label)&&d.append("<span>"+e.label+"</span>"),f.attr("name",e.name),this},a?module.exports=d:VRender.Component.Render.checkbox=d}}("undefined"==typeof VRender),function(){if(!VRender.Component.Checkbox){var a=VRender.Utils,b=VRender.Component,c=b.Render.checkbox,d=window.UICheckbox=b.Checkbox=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.input=this.$el.children("input"),this.input.on("change",f.bind(this))},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-chkbox",d)},d.create=function(a){return a=$.extend({},a,{tagName:"label"}),b.create(a,d,c)},e.val=function(b){return a.isNotNull(b)&&this.input.val(b),this.input.val()},e.isChecked=function(){return this.input.is(":checked")},e.setChecked=function(b){var c=!!a.isNull(b)||a.isTrue(b);this.input[0].checked=c,this.input.trigger("change")};var f=function(a){$(a.currentTarget).is(":checked")?this.$el.addClass("checked"):this.$el.removeClass("checked")};b.register(".ui-chkbox",d)}}(),function(a){if(a||!VRender.Component.Render.radiobox){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)};(d.prototype=new c).render=function(a,d){c.render.call(this,a,d),d.addClass("ui-radbox");var e=this.options||{},f=a("<input type='radio'/>").appendTo(d);return b.isNotNull(e.value)&&f.val(e.value),b.isTrue(e.checked)&&(d.addClass("checked"),f.attr("checked","checked")),b.isNotNull(e.label)&&d.append("<span>"+e.label+"</span>"),b.isNotBlank(e.name)&&f.attr("name",e.name),this},a?module.exports=d:VRender.Component.Render.radiobox=d}}("undefined"==typeof VRender),function(){if(!VRender.Component.Radiobox){var a=VRender.Utils,b=VRender.Component,c=b.Render.radiobox,d=window.UIRadiobox=b.Radiobox=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.input=this.$el.children("input"),this.input.on("change",f.bind(this)),this.input.is(":checked")&&this.input.trigger("change")},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-radbox",d)},d.create=function(a){return a=$.extend(a,{tagName:"label"}),b.create(a,d,c)},e.val=function(b){return a.isNotBlank(b)&&this.input.val(b),this.input.val()},e.isChecked=function(){return this.input.is(":checked")},e.setChecked=function(b){var c=!!a.isNull(b)||a.isTrue(b);this.isChecked()!=c&&(this.input[0].checked=c,this.input.trigger("change"))};var f=function(b){if(this.isChecked()){this.input.parent().addClass("checked");var c=this.input.attr("name");a.isNotBlank(c)&&$("input[name='"+c+"']").not(this.input).parent().removeClass("checked")}else this.$el.removeClass("checked");this.trigger("change")};b.register(".ui-radbox",d)}}(),function(a){if(a||!VRender.Component.Render.textview){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;e.render=function(a,d){c.render.call(this,a,d),d.addClass("ui-textview");var e=this.options||{};this.isDisplayAsPassword()&&d.addClass("display-as-pwd");var h=a("<div class='ipt'></div>").appendTo(d),i=f.call(this,a,d,h),j=this.getWidth()||null;b.isNotBlank(j)&&h.css("width",j),b.isTrue(e.readonly)&&(d.addClass("readonly"),i.attr("readonly","readonly")),b.isTrue(e.required)&&d.attr("required","required");var k=parseInt(e.maxSize)||0;if(k>0){d.addClass("show-size").attr("opt-size",k);var l=b.trimToEmpty(i.val()).length;h.append("<span class='size'>"+l+"/"+k+"</span>")}b.isNotBlank(e.prompt)&&h.append("<span class='prompt'>"+e.prompt+"</span>"),b.isNotBlank(e.tips)&&h.append("<span class='tips'>"+e.tips+"</span>");var m=e.description||e.desc;return b.isNotBlank(m)&&d.append("<div class='desc'>"+m+"</div>"),g.call(this,a,d),this},e.getWidth=function(){return b.getFormatSize(this.options.width)},e.getDecimals=function(){if(this.isDisplayAsPassword())return 0;var a=this.options||{};return"int"===(a.dataType||a.type)?0:a.hasOwnProperty("decimals")?parseInt(a.decimals)||0:2},e.isDisplayAsPassword=function(){return b.isTrue(this.options.displayAsPwd)},e.isMultiline=function(){return this.options.hasOwnProperty("multiple")?b.isTrue(this.options.multiple):b.isTrue(this.options.multi)};var f=function(a,c,d){var e=this.options||{},f=this.isMultiline(),g=f?"<textarea></textarea>":"<input type='text'/>";g=a(g).appendTo(d),f?c.addClass("multi"):d.append("<span class='clear'></span>");var h=e.value,i=e.dataType||e.type;if(b.isNotBlank(i)&&("int"===i&&(i="number"),/^(email|password|tel|url|number)$/.test(i)&&g.attr("type",i),c.attr("opt-type",i),/^(number|num|int)$/.test(i))){var j=this.getDecimals();c.attr("opt-decimal",j);var k=parseFloat(e.min),l=parseFloat(e.max);isNaN(k)||c.attr("opt-min",k),isNaN(l)||c.attr("opt-max",l),b.isNotBlank(h)&&(h=parseFloat(h),isNaN(h)?h="":(!isNaN(k)&&h<k&&(h=k),!isNaN(l)&&h>l&&(h=l),h=h.toFixed(j)))}return b.isNotBlank(h)&&(g.val(h),c.addClass("has-val")),g},g=function(a,d){b.isNotBlank(this.options.empty)&&d.attr("opt-empty",this.options.empty);var e=this.options.errmsg;b.isFunction(e)?c.renderFunction(d,"errmsg",e):b.isNotBlank(e)&&d.attr("opt-errmsg",e)};a?module.exports=d:VRender.Component.Render.textview=d}}("undefined"==typeof VRender),function(){if(!VRender.Component.TextView){var a=VRender.Utils,b=VRender.Component,c=b.Render.textview,d=window.UITextView=b.TextView=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.input=this.$el.find("input, textarea"),this.maxSize=parseInt(this.$el.attr("opt-size"))||0,this.input.on("focusin",h.bind(this)),this.input.on("focusout",i.bind(this)),
this.input.on("keydown",f.bind(this)),this.input.on("keyup",g.bind(this)),this.tap(".clear",j.bind(this))},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-textview",d)},d.create=function(a){return b.create(a,d,c)},e.val=function(b){return a.isNotNull(b)&&(this.input.val(b),this.showError(!1),b.length>0?this.$el.addClass("has-val"):this.$el.removeClass("has-val"),this.maxSize>0&&this.$el.find(".ipt > .size").text(b.length+"/"+this.maxSize)),this.input.val()},e.setTips=function(b){var c=this.$el.find(".ipt > .tips");c&&c.length>0?c.html(b):a.isNotBlank(b)&&this.$el.children(".ipt").append("<span class='tips'>"+b+"</span>")},e.setDescription=function(b){var c=this.$el.children(".desc");c&&c.length>0?c.html(b):a.isNotBlank(b)&&this.$el.append("<div class='desc'>"+b+"</div>")},e.showError=function(a){if(this.$el.removeClass("show-error").find(".errmsg").remove(),a&&(this.$el.addClass("show-error"),"string"==typeof a)){var b=$("<div class='errmsg'></div>").appendTo(this.$el);b.text(a);var c=this.$el.children(".ipt");b.insertAfter(c),this.isRenderAsApp()||b.css("top",c.height()+8)}};var f=function(b){if(this.showError(!1),a.isControlKey(b))return!0;var c=this.input.val()||"",d=this.$el.attr("opt-type")||"text";if("number"===d||"num"===d){if(!k(b,c))return!1}else if("tel"===d||"mobile"===d||"phone"===d){if(!/[0-9]|\-/.test(b.key))return!1;if("-"===b.key&&"mobile"===d)return!1}else if("text"===d&&this.maxSize>0&&c.length>=this.maxSize)return!1;this.$el.addClass("has-val")},g=function(a){var b=this.input.val()||"",c=b,d=this.$el.attr("opt-type")||"text";if("number"===d||"num"===d?c=b.replace(/[^0-9\.\-]/g,""):"tel"!==d&&"mobile"!==d&&"phone"!==d||(c=b.replace(/[^0-9\-]/g,"")),c!=b&&this.input.val(c),0===c.length&&this.$el.removeClass("has-val"),this.maxSize>0&&this.$el.find(".ipt > .size").text(c.length+"/"+this.maxSize),13===a.which){var e=this;setTimeout(function(){e.input.focusout(),e.trigger("enter",c)})}},h=function(a){var b=this;this.$el.addClass("focus");var c=this.input.val();this._changeTimer=setInterval(function(){var a=b.input.val();a!=c&&(c=a,b.trigger("change",a))},100)},i=function(b){this.$el.removeClass("focus");var c=this.input.val()||"";if(0===c.length)"required"===this.$el.attr("required")&&this.showError(this.$el.attr("opt-empty")||"输入框不能为空");else{var d=this.$el.attr("opt-type")||"text";if("number"===d||"num"===d)if(isNaN(c))this.showError("数据格式不正确");else{var e=parseFloat(c),f=parseFloat(this.$el.attr("opt-min"));!isNaN(f)&&f>e&&this.showError("数据不正确，请输入大于等于 "+f+" 的值");var g=parseFloat(this.$el.attr("opt-max"));!isNaN(g)&&g<e&&this.showError("数据不正确，请输入小于等于 "+g+" 的值");var h=parseFloat(this.$el.attr("opt-decimal"))||0;h>0&&this.input.val(e.toFixed(h))}else"tel"===d?a.isMobile(c)||a.isPhone(c)||this.showError("手机或电话号码不正确"):"text"===d?this.maxSize>0&&this.maxSize<c.length&&this.showError("输入内容太长，允许最大长度为："+this.maxSize):"email"===d?a.isEmail(c)||this.showError("Email格式不正确，请重新输入"):"mobile"===d?a.isMobile(c)||this.showError("手机号码不正确，必须是1开头的11位数字"):"phone"===d?a.isPhone(c)||this.showError("电话号码不正确"):"url"===d&&(a.isUrl(c)||this.showError("url格式不正确"))}if(this._changeTimer){var i=this._changeTimer;this._changeTimer=null,setTimeout(function(){clearInterval(i)},100)}},j=function(a){this.val(""),this.trigger("change","");var b=this;setTimeout(function(){b.input.focus()},0)},k=function(a,b){return!!/[0-9]/.test(a.key)||("-"===a.key?!/\-/.test(b):"."===a.key&&!/\./.test(b))};b.register(".ui-textview",d)}}(),function(a){if(a||!VRender.Component.Render.combobox){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").ListRenderer:VRender.Component.Render._list,d=a?require("./dropdownlist"):VRender.Component.Render.dropdownlist,e=function(a,b){c.call(this,a,b)},f=e.prototype=new c;f.render=function(a,d){return d.addClass("ui-combobox"),b.isTrue(this.options.native)&&d.attr("opt-native","1"),d.attr("opt-scroll",this.options.scroller),this.options.data=h.call(this,this.options.data),c.render.call(this,a,d),g.call(this,a,d),this},f.getData=function(){return d.getData.call(this)},f.renderData=function(a,b){d.renderData.call(this,a,b)},f._getItemContainer=function(){return null};var g=function(a,c){var d=a("<div class='ipt'></div>").appendTo(c),e=a("<input type='text'/>").appendTo(d),f=this.getSelectedData(!0);if(f&&f.length>0){c.addClass("has-val");var g=this,h=b.map(f,function(a){return g._getDataLabel(a)});e.val(h.join(",")||"")}b.isTrue(this.options.editable)?c.addClass("editable"):e.attr("readonly","readonly"),c.is(".disabled")&&e.attr("disabled","disabled"),d.append("<button class='dropdownbtn'></button>"),d.append("<span class='prompt'>"+b.trimToEmpty(this.options.prompt)+"</span>")},h=function(a){return d.dataFormat.call(this,a)};a?module.exports=e:(e.dataFormat=h,VRender.Component.Render.combobox=e)}}("undefined"==typeof VRender),function(){if(!VRender.Component.Combobox){var a=VRender.Utils,b=VRender.Component,c=b.Render.combobox,d=window.UICombobox=b.Combobox=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.isRenderAsApp()&&this.isNative()&&(u.call(this,$,this.$el),this.$el.children("select").on("change",i.bind(this))),this.isRenderAsApp()&&this.isNative()||this.tap(".ipt",f.bind(this)),this.$el.is(".editable")&&(this.$el.on("keydown","input",k.bind(this)),this.$el.on("keyup","input",k.bind(this)),this.$el.on("focusin","input",l.bind(this)),this.$el.on("focusout","input",l.bind(this)))},e=d.prototype=new b.list;d.find=function(a){return b.find(a,".ui-combobox",d)},d.create=function(a){return b.create(a,d,c)},e.getData=function(){return b.Render.dropdownlist.getData.call(this)},e.setData=function(a){var d=this._snapshoot();a=c.dataFormat.call(this,a),this.options.data=b.Render.dropdownlist.doAdapter.call(this,a),n.call(this,[],[]),this.isRenderAsApp()&&this.isNative()?(this.$el.children("select").remove(),u.call(this,$,this.$el),this.$el.children("select").on("change",i.bind(this))):this.dropdownList&&this.dropdownList.setData(this.options.data),this._dataChanged("set",this.options.data),d.done([],[])},e.setSelectedIndex=function(c){var d=this._snapshoot(),e=b.list.getIntValues.call(this,c,0);if(n.call(this,e),this.dropdownList)this.dropdownList.setSelectedIndex(e);else{var f=this.$el.children("select"),g=f.children("option").removeAttr("select");a.each(e,function(a){g.eq(a).attr("select","select")})}d.done(e)},e.addItem=function(a,b){},e.updateItem=function(a,b){},e.removeItemAt=function(a){},e.setDisabled=function(b){void 0!==b&&null!==b||(b=!0),a.isTrue(b)?(this.$el.addClass("disabled").attr("disabled","disabled"),this.$el.find(".ipt > input").attr("disabled","disabled")):(this.$el.removeClass("disabled").removeAttr("disabled"),this.$el.find(".ipt > input").removeAttr("disabled"))},e.val=function(b){if(a.isNull(b))return this.$el.find(".ipt > input").val();var c=this._snapshoot(),d=o.call(this,b);d?this.setSelectedIndex(d[0]):(this.setSelectedIndex(-1),this.isMatchRequired()||this.$el.find(".ipt > input").val(b)),c.done()},e.isNative=function(){return 1==this.$el.attr("opt-native")},e.isEditable=function(){return this.$el.is(".editable")},e.isMatchRequired=function(){return 1==this.$el.attr("opt-match")},e._getItemContainer=function(){return null},e._snapshoot_shoot=function(a,b,c){a.selectedIndex=b||this.getSelectedIndex(),a.selectedData=c||this.getSelectedData(),a.value=this.$el.find(".ipt > input").val()||"",a.data=a.selectedData},e._snapshoot_compare=function(a,c){var d=this.$el.find(".ipt > input").val()||"";return a.value!=d||(c||(c=this.getSelectedIndex(!0)),!b.list.equalIndex(c,a.selectedIndex))};var f=function(a){var b=$(a.target);if(this.isRenderAsApp()){if(this.$el.is(".editable")&&!b.is(".dropdownbtn"))return}else this.$el.is(".editable")&&b.is(".dropdownbtn")&&this.$el.find(".ipt > input").focus();r.call(this),p.call(this)},g=function(a){if("mouseenter"===a.type)this.mouseTimerId&&(clearTimeout(this.mouseTimerId),this.mouseTimerId=0);else if(q.call(this)){var b=this;this.mouseTimerId=setTimeout(function(){b.mouseTimerId=0,s.call(b)},500)}},h=function(a){$(a.target).is(".ui-dropdownlist")&&s.call(this)},i=function(b){var c=[],d=[],e=this.$el.children("select").find(":selected");a.each(e,function(a){c.push(a.attr("ind")),d.push(a.data("itemData"))}),n.call(this,c,d,!0)},j=function(b,c){s.call(this);var d=this._snapshoot(),e=this.dropdownList.getSelectedIndex(!0);d.compare(e)?(c=a.toArray(c),n.call(this,e,c),d.done(e,c)):d.release()},k=function(a){if("keydown"===a.type){if(!this.isRenderAsApp()&&(r.call(this),this.$el.off("mouseenter").off("mouseleave"),38===a.which||40===a.which)){var c=this.dropdownList.getSelectedIndex(!0);c=c&&c.length>0?c[0]:-1,38===a.which&&c>0&&(c-=1),40===a.which&&c<this.dropdownList.length()-1&&(c+=1),this.dropdownList.off("change"),this.dropdownList.setSelectedIndex(c),this.dropdownList.on("change",j.bind(this))}}else if("keyup"===a.type){var d=$(a.currentTarget),e=d.val();if(13===a.which)if(this.isRenderAsApp())m.call(this);else{s.call(this);var c=this.dropdownList.getSelectedIndex(!0);if(c&&c.length>0)b.list.equalIndex(this._lastSelectedIndex,c)||(this._lastSelectedIndex=c,n.call(this,c,null,!0),d.select());else{this._lastSelectedIndex=-1;var f=this.isMatchRequired()?[]:[e];n.call(this,[],f,!0),d.select()}}else if(38===a.which||40===a.which);else if(e&&e.length>0?this.$el.addClass("has-val"):this.$el.removeClass("has-val"),!this.isRenderAsApp()){var g=o.call(this,e,!0);this.dropdownList.off("change"),this.dropdownList.setSelectedIndex(g?g[0]:-1),this.dropdownList.on("change",j.bind(this))}}},l=function(a){if("focusin"===a.type)this.focusOutTimerId||(this._lastSelectedIndex=this.getSelectedIndex());else if("focusout"===a.type)if(q.call(this)){var b=this;this.focusOutTimerId=setTimeout(function(){b.focusOutTimerId=0,s.call(b),m.call(b)},250)}else m.call(this)},m=function(){var b=this.$el.find(".ipt > input"),c=b.val(),d=o.call(this,c,this.isMatchRequired());d=d||[-1,null];var e=this._snapshoot();if(this.dropdownList)this.dropdownList.setSelectedIndex(d[0]);else{var f=this.$el.children("select");f&&f.length>0&&(f.get(0).selectedIndex=d[0],n.call(this,a.toArray(d[0]),a.toArray(d[1])))}d[0]<0&&!this.isMatchRequired()&&(b.val(c),c&&c.length>0&&this.$el.addClass("has-val")),this._lastSelectedIndex=d[0],e.done()},n=function(c,d,e){var f=e?this._snapshoot():null;c=b.list.setSelectedIndex.call(this,c);var g=this;d=d||this.getSelectedData(!0);var h=a.map(d,function(a){return g._getDataLabel(a)});h=h.join(",")||"",this.$el.find(".ipt > input").val(h),d&&d.length>0?this.$el.addClass("has-val"):this.$el.removeClass("has-val"),e&&f.done(c)},o=function(b,c,d){if(a.isBlank(b))return null;for(var e=this.getData()||[],f=0,g=e.length;f<g;f++){var h=e[f],i=this._getDataLabel(h)||"";if(b==i)return[f,h];if(c&&b.length<i.length){var j=i.indexOf(b);if(0==j||j>0&&!d)return[f,h]}}return null},p=function(){var a=this.$el.children(".ui-dropdownlist");if(this.isRenderAsApp()){if(this.isNative())return;a=a.children("ul")}var b=a.find(".item.selected");if(b&&b.length>0){var c=a.offset().top,d=a.innerHeight(),e=b.offset().top,f=b.innerHeight(),g=a.scrollTop();c>e?a.scrollTop(g-(c-e)):e>c+d&&a.scrollTop(g+(e-c-d+f))}},q=function(){return this.$el.is(".show-dropdown")},r=function(){if(!q.call(this)){this.dropdownList||(this.dropdownList=t.call(this,$,this.$el),this.dropdownList.on("change",j.bind(this))),this.$el.addClass("show-dropdown").removeClass("show-before");var a=this;if(this.isRenderAsApp())this.isNative()||($("html,body").addClass("ui-scrollless"),setTimeout(function(){$("body").on("tap.combobox",function(b){h.call(a,b)})},50));else{var b=$(window).height()+$("html").scrollTop()+$("body").scrollTop(),c=$(this.$el.attr("opt-scroll"));c&&c.length>0&&(b=c.offset().top+c.outerHeight());var d=this.$el.children(".ui-dropdownlist");b<d.offset().top+d.outerHeight()&&this.$el.addClass("show-before"),this.$el.on("mouseenter",function(b){return g.call(a,b)}),this.$el.on("mouseleave",function(b){return g.call(a,b)}),setTimeout(function(){a.focusOutTimerId&&(clearTimeout(a.focusOutTimerId),a.focusOutTimerId=0)},100)}}},s=function(){$("html,body").removeClass("ui-scrollless"),q.call(this)&&(this.$el.removeClass("show-dropdown"),this.$el.off("mouseenter").off("mouseleave"),$("body").off("tap.combobox"))},t=function(a,b){var c={};return c.data=this.options.data,c.labelField=this.getLabelField(),c.labelFunction=this.getLabelFunction(),c.itemRenderer=this.getItemRenderer(),c.dataAdapter=this.getDataAdapter(),c.dataMapper=this.getDataMapper(),c.multiple=this.isMultiple(),c.selectedIndex=this.getSelectedIndex(),c.selectedId=this.getSelectedId(),c.style="popup",c.target=b,VRender.Component.DropdownList.create(c)},u=function(b,c){var d=b("<select size='1'></select>").appendTo(c);if(this.isMultiple()?d.attr("multiple","multiple"):d.append("<option disabled='disabled' selected='selected'>请选择..</option>"),a.isArray(this.options.data)){var e=this,f=0,g=this.getSelectedIndex(!0),h=this.getSelectedId(!0)||null,i=function(a,c){if(c){var d=b("<option></option>").appendTo(a);d.text(e._getDataLabel(c,f)),d.attr("ind",f).data("itemData",c),e._isSelected(c,f,g,h)&&d.attr("selected","selected")}f+=1};a.each(this.options.data,function(b){a.isArray(b)?a.each(b,function(a){i(d,a)}):a.isNotBlank(b)&&i(d,b)})}return d};b.register(".ui-combobox",d)}}(),function(a){if(a||!VRender.Component.Render.datepicker){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=a?require("../../../ui/component/UIButton"):VRender.Component.Button,e=["一","二","三","四","五","六","七","八","九","十","十一","十二"],f=["周日","周一","周二","周三","周四","周五","周六"],g=function(a,b){c.call(this,a,b)},h=g.prototype=new c;h.render=function(a,d){c.render.call(this,a,d),d.addClass("ui-datepicker");var e=this.options||{},f=b.toDate(e.min);f&&d.attr("opt-min",b.toDateString(f,"yyyy-MM-dd"));var g=b.toDate(e.max);g&&d.attr("opt-max",b.toDateString(g,"yyyy-MM-dd"));var h=this.getDate();return this.isRangeDate()?(d.addClass("is-range"),h&&(d.attr("data-start",b.toDateString(h[0],"yyyy-MM-dd")),d.attr("data-end",b.toDateString(h[1],"yyyy-MM-dd")))):h&&d.attr("data-dt",b.toDateString(h,"yyyy-MM-dd")),i.call(this,a,d),j.call(this,a,d),k.call(this,a,d),l.call(this,a,d,h),this},h.getDate=function(){var a=this.getMinDate(),c=this.getMaxDate(),d=u(a),e=u(c);if(d&&e&&d>e)return null;if(this.isRangeDate()){var f=b.toDate(this.options.start);if(f){f=new Date(f.getTime());var g=b.toDate(this.options.end)||new Date(f.getTime());g=new Date(g?g.getTime():f.getTime());var h=u(f),i=u(g);if(h<=i&&(d&&h<d&&(f=a),e&&i>e&&(g=c),u(f)<=u(g)))return[f,g]}}else{var j=b.toDate(this.options.date);if(j){j=new Date(j.getTime());var k=u(j);return d&&k<d||e&&k>e?null:j}}return null},h.getMinDate=function(){return b.toDate(this.options.min)},h.getMaxDate=function(){return b.toDate(this.options.max)},h.isRangeDate=function(){return b.isTrue(this.options.range)};var i=function(a,b){var c=a("<header></header>").appendTo(b),d=a("<div class='title'></div>").appendTo(c),e=function(){var b=a("<dl class='item'></dl>").appendTo(d);return b.append("<dt class='lbl'>-</dt><dd class='val'>-</dd>"),b.append("<button class='prev y'>&nbsp;</button>"),b.append("<button class='prev m'>&nbsp;</button>"),b.append("<button class='next m'>&nbsp;</button>"),b.append("<button class='next y'>&nbsp;</button>"),b};this.isRangeDate()?(e().addClass("s").children(".lbl").html("开始日期<span class='y'></span>"),e().addClass("e").children(".lbl").html("结束日期<span class='y'></span>")):e(),this.isRenderAsApp()&&(c.append("<button class='today'><label>今天</label></button>"),c.append("<button class='clear'><label>清除</label></button>"))},j=function(a,b){var c=a("<section></section>").appendTo(b);this.isRangeDate()&&!this.isRenderAsApp()?(r(a,c).addClass("s"),r(a,c).addClass("e")):r(a,c).addClass("t0")},k=function(a,b){if(this.isRangeDate()){var c=a("<footer></footer>").appendTo(b);if(this.isRenderAsApp())s.call(this,c,{label:"使用日期",type:"primary",cls:"okbtn"});else{c.append("<div class='vals'><span class='s'>-</span> - <span class='e'>-</span></div>");var d=a("<div class='btns'></div>").appendTo(c);s.call(this,d,{label:"确定",type:"primary",cls:"okbtn"}),s.call(this,d,{label:"取消",type:"cancel",cls:"cancelbtn"})}}},l=function(a,c,d,e){e=b.toArray(e),e[0]instanceof Date||(this.isRangeDate()&&!this.isRenderAsApp()?(e.push(d&&d[0]||new Date),e.push(d&&d[1])):e=d||new Date),m.call(this,a,c,e,d),n.call(this,a,c,e,d),o.call(this,a,c,e,d)},m=function(a,c,d,g){var h=c.children("header");if(this.isRangeDate()){var i,j,k="--",l="--",m=" ",n=" ";if(this.isRenderAsApp()){if(g){i=g[0],j=g[1];var o=new Date,p=o.getFullYear();i&&(i.getFullYear()!=p&&(m=i.getFullYear()),k=b.toDateString(i,"M月d日")+" "+f[i.getDay()]),j&&(j.getFullYear()!=p&&(n=j.getFullYear()),n=j.getFullYear()==p?" ":j.getFullYear(),l=b.toDateString(j,"M月d日")+" "+f[j.getDay()])}h.find(".item.s .y").text(m),h.find(".item.e .y").text(n)}else i=d&&d[0]||new Date,j=d&&d[1]||i,t(i,j)&&(j=new Date(j.getTime()),j.setMonth(j.getMonth()+1)),k=i.getFullYear()+"年 "+e[i.getMonth()]+"月",l=j.getFullYear()+"年 "+e[j.getMonth()]+"月",q(a,c,i,j);h.find(".item.s .val").text(k),h.find(".item.e .val").text(l)}else{var r=d&&d[0]||new Date,s=r.getFullYear()+"年 "+e[r.getMonth()]+"月";h.find(".item .lbl").text(s),h.find(".item .val").text(g?b.toDateString(g,"yyyy.MM.dd"):"-")}},n=function(a,b,c,d){if(this.isRangeDate()&&!this.isRenderAsApp()){var e=c&&c[0]||new Date,f=c&&c[1]||e;t(e,f)&&(f=new Date(f.getTime()),f.setMonth(f.getMonth()+1)),p.call(this,a,b,b.find(".table.s"),e,d),p.call(this,a,b,b.find(".table.e"),f,d)}else{var g=c&&c[0]||new Date;p.call(this,a,b,b.find(".table.t0"),g,d)}},o=function(a,c,d,e){if(this.isRangeDate()&&!this.isRenderAsApp()){var f=" ",g=" ";e&&(e[0]&&(f=b.toDateString(e[0],"yyyy.MM.dd")),e[1]&&(g=b.toDateString(e[1],"yyyy.MM.dd")));var h=c.find("footer .vals");h.children(".s").text(f),h.children(".e").text(g)}},p=function(a,b,c,d,f){var g=d.getFullYear(),h=d.getMonth();c.attr("data-y",g).attr("data-m",h);var i=new Date,j=u(i),k=f instanceof Date?f:f&&f[0],l=f instanceof Date?f:f&&f[1],m=u(k),n=u(l)||m,o=u(this.getMinDate()),p=u(this.getMaxDate())||21001231,q=new Date(g,h,1),r=q.getDay();q.setDate(r?2-r:-5);var s=(i.getFullYear()==g?"":g+"年 ")+e[h]+"月";c.find(".month").text(s);for(var t=c.find("table.body tbody").empty();;){for(var v=a("<tr></tr>").appendTo(t),w=0;w<7;w++){var x=q.getFullYear(),y=q.getMonth(),z=q.getDate(),A=1e4*x+100*y+z,B=a("<td></td>").appendTo(v);B.append("<span>"+z+"</span>"),B.attr("data-dt",x+"-"+(y+1)+"-"+z),A==j&&B.addClass("today"),y!=h&&B.addClass("over"),(y!=h||A<o||A>p)&&B.addClass("disabled"),A>=m&&A<=n&&(B.addClass("selected"),A==m&&B.addClass("start"),A==n&&B.addClass("end")),q.setDate(z+1)}if(q.getMonth()>h||q.getFullYear()>g)break}},q=function(a,b,c,d){b=b.children("header");var e=b.find(".item.s .next.y, .item.e .prev.y"),f=b.find(".item.s .next.m, .item.e .prev.m"),g=c.getFullYear(),h=c.getMonth(),i=d.getFullYear(),j=d.getMonth();100*g+h>=100*(i-1)+j?e.addClass("disabled"):e.removeClass("disabled"),g>i||g==i&&h>=j-1?f.addClass("disabled"):f.removeClass("disabled")},r=function(a,b){b=a("<div class='table'></div>").appendTo(b);var c=a("<table class='head'></table>").appendTo(b);c.append("<thead><tr><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th><th>日</th></tr></thead>");var c=a("<table class='body'></table>").appendTo(b);return c.append("<thead><tr><th colspan='7'><div class='month'>-</div></th></tr></thead>"),c.append("<tbody></tbody>"),b},s=function(c,e){a?new d(this.context,e).render(c):d.create(b.extend({},e,{target:c}))},t=function(a,b){return!(!a||!b)&&(a.getMonth()==b.getMonth()&&a.getFullYear()==b.getFullYear())},u=function(a){return a?1e4*a.getFullYear()+100*a.getMonth()+a.getDate():0};a?module.exports=g:(g.createTable=r,g.renderDate=l,g.renderPickerDate=p,VRender.Component.Render.datepicker=g)}}("undefined"==typeof VRender),function(){if(!VRender.Component.DatePicker){var a=VRender.Utils,b=VRender.Component,c=b.Render.datepicker,d=window.UIDatePicker=b.DatePicker=function(a,c){if(this.init(a,c)!==this)return b.get(a);if(this.tap("header .title button",f.bind(this)),this.tap("section td",g.bind(this)),this.tap("footer .okbtn",h.bind(this)),this.tap("footer .cancelbtn",i.bind(this)),this.isRenderAsApp()){this.$el.on("tap",function(a){return!1}),this.tap("header .today",j.bind(this)),this.tap("header .clear",k.bind(this));var d=this.$el.children("section");d.on("touchstart",l.bind(this)),d.on("touchmove",l.bind(this)),d.on("touchend",l.bind(this))}},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-datepicker",d)},d.create=function(a){return b.create(a,d,c)},e.getDate=function(b){if(!this.isRangeDate()){var c=a.toDate(this.$el.attr("data-dt"));return c&&a.isNotBlank(b)?a.toDateString(c,b):c}var d=a.toDate(this.$el.attr("data-start"));if(d){var e=a.toDate(this.$el.attr("data-end"))||new Date(d.getTime());return e=a.toDate(a.toDateString(e,"yyyy-MM-dd 23:59:59")),a.isNotBlank(b)&&(d=a.toDateString(d,b),e=a.toDateString(e,b)),[d,e]}return null},e.setDate=function(b){var c=this._snapshoot(),d=this.getMinDate(),e=this.getMaxDate(),f=p(d),g=p(e);if(this.isRangeDate()){var h=a.toDate(arguments[0]),i=null;if(h){i=a.toDate(arguments[1])||new Date(h.getTime());var j=p(h),k=p(i);f&&j<f&&(h=d),g&&k>g&&(i=e),p(h)<=p(i)?(h=a.toDateString(h,"yyyy-MM-dd"),i=a.toDateString(i,"yyyy-MM-dd")):h=i=null}this.$el.attr("data-start",h||""),this.$el.attr("data-end",i||"")}else{var l=a.toDate(b);if(l){var n=p(l);(f&&n<f||g&&n>g)&&(l=null)}this.$el.attr("data-dt",l?a.toDateString(l,"yyyy-MM-dd"):"")}c.compare()||m.call(this,this.getDate()),c.done()},e.getMinDate=function(){return a.toDate(this.$el.attr("opt-min"))},e.setMinDate=function(b){var c=a.toDate(b);if(p(c)!=p(this.getMinDate())){var d=this._snapshoot();if(this.$el.attr("opt-min",c?a.toDateString(c,"yyyy-MM-dd"):""),c){var e=p(c);if(this.isRangeDate()){var f=a.toDate(this.$el.attr("data-end"));if(f&&e>p(f))this.$el.attr("data-start","").attr("data-end","");else{var g=a.toDate(this.$el.attr("data-start"));g&&e>p(g)&&this.$el.attr("data-start",this.$el.attr("opt-min"))}}else{var h=a.toDate(this.$el.attr("data-dt"));h&&e>p(h)&&this.$el.attr("data-dt","")}}m.call(this),d.done()}},e.getMaxDate=function(){return a.toDate(this.$el.attr("opt-max"))},e.setMaxDate=function(b){var c=a.toDate(b);if(p(c)!=p(this.getMaxDate())){var d=this._snapshoot();if(this.$el.attr("opt-max",c?a.toDateString(c,"yyyy-MM-dd"):""),c){var e=p(c);if(this.isRangeDate()){var f=a.toDate(this.$el.attr("data-start"));if(f&&e<p(f))this.$el.attr("data-start","").attr("data-end","");else{var g=a.toDate(this.$el.attr("data-end"));g&&e<p(g)&&this.$el.attr("data-end",this.$el.attr("opt-max"))}}else{var h=a.toDate(this.$el.attr("data-dt"));h&&e<p(h)&&this.$el.attr("data-dt","")}}m.call(this),d.done()}},e.submit=function(){h.call(this)},e.cancel=function(){i.call(this)},e.isRangeDate=function(){return this.$el.is(".is-range")},e._snapshoot_shoot=function(a,b){a.selectedDate=b||this.getDate(),a.pickerDate=o.call(this),a.data=a.selectedDate},e._snapshoot_compare=function(a,b){var c=b||this.getDate();return c&&a.selectedDate?this.isRangeDate()?p(c[0])==p(a.selectedDate[0])&&p(c[1])==p(a.selectedDate[1]):p(c)==p(a.selectedDate):!(c||a.selectedDate)};var f=function(a){var b=$(a.currentTarget),c=null;if(this.isRangeDate()&&!this.isRenderAsApp()){var d=b.parent();d.is(".s")?c=this.$el.find(".table.s"):d.is(".e")&&(c=this.$el.find(".table.e"))}else c=this.$el.find(".table.t0");var e=parseInt(c.attr("data-y")),f=parseInt(c.attr("data-m")),g=new Date(e,f,1);b.is(".y")?g.setFullYear(e+(b.is(".prev")?-1:1)):g.setMonth(f+(b.is(".prev")?-1:1)),c.attr("data-y",g.getFullYear()).attr("data-m",g.getMonth()),m.call(this)},g=function(b){var c=$(b.currentTarget);if(!c.is(".disabled"))if(this.isRangeDate()){if(this.selectedSnapshoot||(this.selectedSnapshoot=this._snapshoot()),this.lastSelectedDate&&1==this.lastSelectedDate.length){var d=a.toDate(c.attr("data-dt"));d.getTime()>=this.lastSelectedDate[0].getTime()?this.lastSelectedDate.push(d):this.lastSelectedDate.unshift(d)}else this.lastSelectedDate=[],this.lastSelectedDate.push(a.toDate(c.attr("data-dt")));m.call(this)}else{var e=this._snapshoot();this.$el.find("td.selected").removeClass("selected"),c.addClass("selected"),this.$el.attr("data-dt",c.attr("data-dt"));var f=a.toDate(c.attr("data-dt"));this.$el.find(".title .item .val").text(a.toDateString(f,"yyyy.MM.dd")),e.done()}},h=function(){if(this.isRangeDate()){if(this.lastSelectedDate&&this.lastSelectedDate.length>0){var b=this.lastSelectedDate[0],c=this.lastSelectedDate[1]||b;this.$el.attr("data-start",a.toDateString(b,"yyyy-MM-dd")),this.$el.attr("data-end",a.toDateString(c,"yyyy-MM-dd")),this.lastSelectedDate=null}n.call(this,!0)}this.trigger("submit",this.getDate())},i=function(){if(this.isRangeDate())if(this.lastSelectedDate=null,this.selectedSnapshoot){var b=this.selectedSnapshoot.getState();n.call(this);var c=b.selectedDate,d=c&&c[0],e=c&&c[1];this.$el.attr("data-start",d?a.toDateString(d,"yyyy-MM-dd"):""),this.$el.attr("data-end",e?a.toDateString(e,"yyyy-MM-dd"):""),m.call(this,b.pickerDate)}else m.call(this);this.trigger("cancel",this.getDate())},j=function(){m.call(this,[new Date])},k=function(){var a=this._snapshoot();this.isRangeDate()?(n.call(this),this.$el.attr("data-start","").attr("data-end","")):this.$el.attr("data-dt",""),m.call(this),a.done()},l=function(a){var b=a.touches&&a.touches[0];if("touchstart"==a.type)this.touchData={startX:b.pageX,startY:b.pageY},this.touchData.tableContainer=this.$el.find(".table.t0"),this.touchData.mainTable=this.touchData.tableContainer.children("table.body");else if("touchmove"==a.type){if(a.touches.length>1)return;var d=b.pageX-this.touchData.startX;if(!this.touchData.moving&&(Math.abs(d)<10||Math.abs(b.pageY-this.touchData.startY)>15))return;this.touchData.moving=!0,this.touchData.lastOffset=d,this.touchData.mainTable.css("transform","translate("+d+"px,0px)");var e=d>0?this.touchData.prevTable:this.touchData.nextTable;if(!e){var f=parseInt(this.touchData.tableContainer.attr("data-y")),g=parseInt(this.touchData.tableContainer.attr("data-m"));e=c.createTable($,this.$el.children("section")).addClass("t1"),d>0?(g-=1,this.touchData.prevTable=e):(g+=1,this.touchData.nextTable=e);var h=new Date(f,g,1),i=this.lastSelectedDate||this.getDate();c.renderPickerDate.call(this,$,this.$el,e,h,i)}this.touchData.contentWidth||(this.touchData.contentWidth=this.$el.children("section").width()),d+=this.touchData.contentWidth*(d>0?-1:1),e.css("transform","translate("+d+"px,0px)")}else if("touchend"==a.type&&this.touchData.moving){var d=0;Math.abs(this.touchData.lastOffset)>20&&(d+=this.touchData.contentWidth*(this.touchData.lastOffset>0?1:-1));this.touchData.mainTable.css("transition","transform 200ms"),this.touchData.mainTable.css("transform","translate("+d+"px,0px)"),this.touchData.lastOffset>0?(this.touchData.prevTable.css("transition","transform 200ms"),this.touchData.prevTable.css("transform","translate(0px,0px)")):(this.touchData.nextTable.css("transition","transform 200ms"),this.touchData.nextTable.css("transform","translate(0px,0px)"));var j=this,k=this.touchData;if(Math.abs(k.lastOffset)>20){var l=k.lastOffset>0?".prev.m":".next.m";j.$el.children("header").find(l).eq(0).tap()}setTimeout(function(){k.prevTable&&k.prevTable.remove(),k.nextTable&&k.nextTable.remove(),k.mainTable.css("transition",""),k.mainTable.css("transform","")},200)}},m=function(a){this.rerenderTimerId&&clearTimeout(this.rerenderTimerId);var b=this;this.rerenderTimerId=setTimeout(function(){b.rerenderTimerId=0;var d=b.lastSelectedDate||b.getDate();a=a||o.call(b),c.renderDate.call(b,$,b.$el,d,a)},0)},n=function(a){this.lastSelectedDate=null,this.selectedSnapshoot&&(a?this.selectedSnapshoot.done():this.selectedSnapshoot.release(),this.selectedSnapshoot=null)},o=function(){var a=[];if(this.isRangeDate()&&!this.isRenderAsApp()){var b=this.$el.find(".table.s");a.push(new Date(parseInt(b.attr("data-y")),parseInt(b.attr("data-m")),1));var c=this.$el.find(".table.e");a.push(new Date(parseInt(c.attr("data-y")),parseInt(c.attr("data-m")),1))}else{var d=this.$el.find(".table.t0");a.push(new Date(parseInt(d.attr("data-y")),parseInt(d.attr("data-m")),1))}return a},p=function(a){return a?1e4*a.getFullYear()+100*a.getMonth()+a.getDate():0};b.register(".ui-datepicker",d)}}(),function(a){if(a||!VRender.Component.Render.dateinput){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;e.render=function(a,d){c.render.call(this,a,d),d.addClass("ui-dateipt"),b.isTrue(this.options.native)&&d.attr("opt-native","1");var e=b.toDate(this.options.min);e&&d.attr("opt-min",b.toDateString(e,"yyyy-MM-dd"));var g=b.toDate(this.options.max);g&&d.attr("opt-max",b.toDateString(g,"yyyy-MM-dd"));var i=b.toDate(this.options.date);if(i){var j=h(i);(e&&h(e)>j||g&&h(g)<j)&&(i=null)}return i&&(d.addClass("has-val"),d.attr("data-dt",b.toDateString(i,"yyyy-MM-dd"))),f.call(this,a,d,i),this},e.getDateFormat=function(){return this.options.dateFormat||this.options.format};var f=function(c,d,e){var f=c("<div class='ipt'></div>").appendTo(d),h=c("<input type='text' readonly='readonly'/>").appendTo(f);f.append("<span class='clear'></span>");var i=this.options.prompt;b.isNotBlank(i)&&c("<span class='prompt'></span>").appendTo(f).text(i);var j=this.getDateFormat();h.val(g(e,j)||""),a&&j&&(b.isFunction(j)?d.write("<div class='format format-fn'>"+escape(j)+"</div>"):d.write("<div class='format'>"+j+"</div>"))},g=function(a,c){return a?b.isFunction(c)?c(a):(b.isBlank(c)&&(c="yyyy-MM-dd"),b.toDateString(a,c)):""},h=function(a){return a instanceof Date?1e4*a.getFullYear()+100*a.getMonth()+a.getDate():0};a?module.exports=d:(d.getFormatDate=g,VRender.Component.Render.dateinput=d)}}("undefined"==typeof VRender),function(){if(!VRender.Component.DateInput){var a=VRender.Utils,b=VRender.Component,c=b.Render.dateinput,d=window.UIDateInput=b.DateInput=function(c,d){if(this.init(c,d)!==this)return b.get(c);a.isTrue(this.options.native)&&this.$el.attr("opt-native","1");var e=this.inputTag=this.$el.children(".ipt");e.on("tap",".clear",g.bind(this)),this.isRenderAsApp()&&this._isNative()?k.call(this):(e.on("tap",f.bind(this)),this.$el.on("mouseenter",h.bind(this)),this.$el.on("mouseleave",h.bind(this)))},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-dateipt",d)},d.create=function(a){return b.create(a,d,c)},e.getDate=function(b){var c=a.toDate(this.$el.attr("data-dt"));return c&&a.isNotBlank(b)?a.toDateString(c,b):c},e.setDate=function(b){var c=this._snapshoot(),d=a.toDate(b);if(d){var e=p(d),f=this.getMinDate();if(f&&p(f)>e)d=null;else{var g=this.getMaxDate();g&&p(g)<e&&(d=null)}}this.$el.attr("data-dt",d?a.toDateString(d,"yyyy-MM-dd"):""),n.call(this),c.done(d)},e.getMinDate=function(){return a.toDate(this.$el.attr("opt-min"))},e.setMinDate=function(b){var c=a.toDate(b);if(p(c)!=p(this.getMinDate())){var d=this._snapshoot();if(this.$el.attr("opt-min",c?a.toDateString(c,"yyyy-MM-dd"):""),c){var e=this.getDate();e&&p(c)>p(e)&&this.$el.attr("data-dt","")}n.call(this),d.done()}},e.getMaxDate=function(){return a.toDate(this.$el.attr("opt-max"))},e.setMaxDate=function(b){var c=a.toDate(b);if(p(c)!=p(this.getMaxDate())){var d=this._snapshoot();if(this.$el.attr("opt-max",c?a.toDateString(c,"yyyy-MM-dd"):""),c){var e=this.getDate();e&&p(c)<p(e)&&this.$el.attr("data-dt","")}n.call(this),d.done()}},e.getDateFormat=function(){if(this.hasOwnProperty("_dateFormat"))return this._dateFormat;if(this.options.hasOwnProperty("format"))return this.options.format;if(this.options.hasOwnProperty("dateFormat"))return this.options.dateFormat;var a=this.$el.children(".format").text()
;return a&&this.$el.children(".format-fn").length>0&&(a=new Function("var Utils=VRender.Utils;return ("+unescape(a)+");")()),this.$el.children(".format").remove(),this._dateFormat=a},e.setDateFormat=function(a){this._dateFormat=a,this.$el.children(".format").remove(),this.setDate(this.getDate())},e._isNative=function(){return 1==this.$el.attr("opt-native")},e._snapshoot_shoot=function(a,b){a.data=b||this.getDate()},e._snapshoot_compare=function(a,b){return b=b||this.getDate(),b&&a.data?b.getDate()==a.data.getDate()&&b.getMonth()==a.data.getMonth()&&b.getFullYear()==a.data.getFullYear():b==a.data};var f=function(a){l.call(this)},g=function(a){return this.setDate(null),!1},h=function(a){var b=this.$el;if(this.hideTimerId&&(clearTimeout(this.hideTimerId),this.hideTimerId=0),"mouseleave"===a.type&&this.$el.is(".show-picker")){var c=this;this.hideTimerId=setTimeout(function(){c.hideTimerId=0,b.removeClass("show-picker")},500)}},i=function(a,b){this.setDate(b);var c=this;setTimeout(function(){m.call(c)},100)},j=function(b){this.setDate(a.toDate($(b.currentTarget).val()))},k=function(){var a=$("<input class='origin-dateipt' type='date'/>").appendTo(this.inputTag);o.call(this,this.getDate(),this.getMinDate(),this.getMaxDate()),a.on("change",j.bind(this))},l=function(){if(!this.picker){var a={};a.target=$("<div class='picker'></div>").appendTo(this.$el),a.date=this.getDate(),a.min=this.getMinDate(),a.max=this.getMaxDate(),this.picker=b.DatePicker.create(a),this.picker.on("change",i.bind(this))}if(!this.$el.is(".show-picker"))if(this.$el.addClass("show-picker").removeClass("show-before"),this.isRenderAsApp())$("html, body").addClass("ui-scrollless"),this.$el.children(".picker").on("tap",m.bind(this));else{var c=this.$el.children(".picker"),d=$(window).height()+$("body").scrollTop(),e=c.offset().top+c.height();d<e&&this.$el.addClass("show-before")}},m=function(){this.$el.removeClass("show-picker"),this.isRenderAsApp()&&($("html, body").removeClass("ui-scrollless"),this.$el.children(".picker").off("tap"))},n=function(){this.refreshTimerId&&clearTimeout(this.refreshTimerId);var a=this;this.refreshTimerId=setTimeout(function(){var b=a.getDate();b?a.$el.addClass("has-val"):a.$el.removeClass("has-val"),a.inputTag.find("input").val(c.getFormatDate(b,a.getDateFormat())),o.call(a,b,a.getMinDate(),a.getMaxDate())},0)},o=function(b,c,d){if(this.isRenderAsApp()&&this._isNative()){var e=this.inputTag.children(".origin-dateipt");e.val(b?a.toDateString(b,"yyyy-MM-dd"):""),e.attr("min",c?a.toDateString(c,"yyyy-MM-dd"):""),e.attr("max",d?a.toDateString(d,"yyyy-MM-dd"):"")}else this.picker&&(this.picker.setMinDate(c),this.picker.setMaxDate(d),this.picker.setDate(b))},p=function(a){return a?1e4*a.getFullYear()+100*a.getMonth()+a.getDate():0};b.register(".ui-dateipt",d)}}(),function(a){if(a||!VRender.Component.Render.daterange){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;e.render=function(a,d){c.render.call(this,a,d),d.addClass("ui-daterange"),b.isTrue(this.options.dropdown)&&d.addClass("tools-dropdown"),b.isTrue(this.options.native)&&d.attr("opt-native","1");var e=b.toDate(this.options.min);e&&d.attr("opt-min",b.toDateString(e,"yyyy-MM-dd"));var h=b.toDate(this.options.max);h&&d.attr("opt-max",b.toDateString(h,"yyyy-MM-dd"));var i=b.toDate(this.options.start),j=null;return i&&(j=b.toDate(this.options.end)||new Date(i.getTime()),e&&k(e)>k(i)&&(i=e),h&&k(h)<k(j)&&(j=h),k(i)>k(j)&&(i=j=null)),i&&j&&(d.addClass("has-val"),d.attr("data-start",b.toDateString(i,"yyyy-MM-dd")),d.attr("data-end",b.toDateString(j,"yyyy-MM-dd"))),f.call(this,a,d,this.getShortcutDates()),g.call(this,a,d,i,j),this},e.getDateFormat=function(){return this.options.dateFormat||this.options.format},e.getShortcutDates=function(){return this.options.shortcuts||this.options.quickDates};var f=function(a,c,d){if(c.removeClass("has-tools").children(".tools").remove(),(d=i(d))&&d.length>0){c.addClass("has-tools");var e=a("<div class='tools'></div>").prependTo(c);e.append("<span class='label'>选择日期</span>");var f=a("<div class='items'></div>").appendTo(e);b.each(d,function(c){var d=parseInt(c.value)||0,e=a("<div class='item'></div>").appendTo(f);e.attr("data-val",d),e.text(b.isBlank(c.label)?"最近"+d+"天":c.label)})}},g=function(c,d,e,f){var g=c("<div class='ipt'></div>").appendTo(d),h=c("<input type='text' readonly='readonly'/>").appendTo(g);g.append("<span class='clear'></span>");var i=this.options.prompt;b.isNotBlank(i)&&c("<span class='prompt'></span>").appendTo(g).text(i);var k=this.getDateFormat();h.val(j(e,f,k)||""),a&&k&&(b.isFunction(k)?d.write("<div class='format format-fn'>"+escape(k)+"</div>"):d.write("<div class='format'>"+k+"</div>"))},h=function(a,c){return b.isFunction(c)?c(a):(b.isBlank(c)&&(c="yyyy-MM-dd"),b.toDateString(a,c))},i=function(a){var c=[];return b.each(b.toArray(a),function(a){b.isNotBlank(a)&&("object"!=typeof a&&(a={value:a}),a.value=parseInt(a&&a.value)||0,a.value>0&&c.push(a))}),c},j=function(a,b,c){return a&&b?h(a,c)+" 至 "+h(b,c):""},k=function(a){return a instanceof Date?1e4*a.getFullYear()+100*a.getMonth()+a.getDate():0};a?module.exports=d:(d.getDateRangeLabel=j,d.renderShortcuts=f,VRender.Component.Render.daterange=d)}}("undefined"==typeof VRender),function(){if(!VRender.Component.DateRange){var a=VRender.Utils,b=VRender.Component,c=b.Render.daterange,d=window.UIDateRange=b.DateRange=function(a,c){if(this.init(a,c)!==this)return b.get(a);var d=this.inputTag=this.$el.children(".ipt");if(d.on("tap",".clear",m.bind(this)),this.isRenderAsApp()&&this._isNative())t.call(this);else if(d.on("tap",f.bind(this)),d.on("tap",".picker",function(a){return!1}),!this.isRenderAsApp()){var e=this.$el.children(".tools");e.on("tap",".item",g.bind(this)),e.on("tap",".label",h.bind(this)),e.on("mouseenter, mouseleave",i.bind(this))}},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-daterange",d)},d.create=function(a){return b.create(a,d,c)},e.getDateRange=function(b){var c=this.getStartDate(),d=this.getEndDate();return c&&d?(a.isNotBlank(b)&&(c=a.toDateString(c,b),d=a.toDateString(d,b)),[c,d]):null},e.setDateRange=function(b,c){var d=this._snapshoot();if(b=a.toDate(b),c=(b?a.toDate(c):null)||b,b&&c){var e=this.getMinDate(),f=this.getMaxDate();e&&w(e)>w(b)&&(b=e),f&&w(f)<w(c)&&(c=f),w(b)>w(c)&&(b=c=null)}this.$el.attr("data-start",b?a.toDateString(b,"yyyy-MM-dd"):""),this.$el.attr("data-end",c?a.toDateString(c,"yyyy-MM-dd"):""),o.call(this,d),d.done()},e.getStartDate=function(){return a.toDate(this.$el.attr("data-start"))},e.setStartDate=function(a){this.setDateRange(a,this.getEndDate())},e.getEndDate=function(){return a.toDate(this.$el.attr("data-end"))},e.setEndDate=function(a){this.setDateRange(this.getStartDate(),a)},e.getMinDate=function(){return a.toDate(this.$el.attr("opt-min"))},e.setMinDate=function(b){var c=a.toDate(b);if(w(c)!=w(this.getMinDate())){var d=this._snapshoot();if(this.$el.attr("opt-min",c?a.toDateString(c,"yyyy-MM-dd"):""),c){var e=this.getEndDate();if(e&&w(e)<w(c))this.$el.attr("data-start","").attr("data-end","");else{var f=this.getStartDate();f&&w(f)<w(c)&&this.$el.attr("data-start",this.$el.attr("opt-min"))}}o.call(this,d),d.done()}},e.getMaxDate=function(){return a.toDate(this.$el.attr("opt-max"))},e.setMaxDate=function(b){var c=a.toDate(b);if(w(c)!=w(this.getMaxDate())){var d=this._snapshoot();if(this.$el.attr("data-max",c?a.toDateString(c,"yyyy-MM-dd"):""),c){var e=this.getStartDate();if(e&&w(e)>w(c))this.$el.attr("data-start","").attr("data-end","");else{var f=this.getEndDate();f&&w(f)>w(c)&&this.$el.attr("data-end",this.$el.attr("opt-max"))}}o.call(this,d),d.done()}},e.getDateFormat=function(){if(this.hasOwnProperty("_dateFormat"))return this._dateFormat;if(this.options.hasOwnProperty("dateFormat"))return this.options.dateFormat;if(this.options.hasOwnProperty("format"))return this.options.format;var a=this.$el.children(".format").text();return a&&this.$el.children(".format-fn").length>0&&(a=new Function("var Utils=VRender.Utils;return ("+unescape(a)+");")()),this.$el.children(".format").remove(),this._dateFormat=a},e.setDateFormat=function(a){if(this._dateFormat=a,this.$el.children(".format").remove(),this.$el.is("has-val")){var b=this.getStartDate(),d=this.getEndDate(),e="";b&&d&&(e=c.getDateRangeLabel.call(this,b,d,a)),this.inputTag.find("input").val(e||"")}},e.setShortcuts=function(a){c.renderShortcuts.call(this,this.$el,a)},e._snapshoot_shoot=function(a){a.data=this.getDateRange(),a.min=this.getMinDate(),a.max=this.getMaxDate()},e._snapshoot_compare=function(a){var b=this.getDateRange();return a.data&&b?w(a.data[0])==w(b[0])&&w(a.data[1])==w(b[1]):!(a.data||b)},e._isNative=function(){return 1==this.$el.attr("opt-native")};var f=function(a){u.call(this)},g=function(a){var b=$(a.currentTarget);b.addClass("selected").siblings().removeClass("selected"),b.parent().parent().children(".label").text(b.text()),this.$el.removeClass("show-dropdown"),s.call(this,b.attr("data-val"))},h=function(a){this.$el.addClass("show-dropdown")},i=function(a){if(this.shortcutMouseTimerId&&clearTimeout(this.shortcutMouseTimerId),"mouseleave"==a.type&&this.$el.is(".show-dropdown")){var b=this;this.shortcutMouseTimerId=setTimeout(function(){b.shortcutMouseTimerId=0,b.$el.removeClass("show-dropdown")},1e3)}},j=function(a,b){v.call(this),this.setDateRange(b&&b[0],b&&b[1])},k=function(a){v.call(this)},l=function(a){v.call(this),this.picker&&this.picker.cancel()},m=function(a){return this.setDateRange(null,null),!1},n=function(b){var c=$(b.currentTarget),d=a.toDate(c.val());c.is(".start")?this.setDateRange(d,this.getEndDate()):this.setDateRange(this.getStartDate(),d)},o=function(a){this.refreshTimerId&&clearTimeout(this.refreshTimerId);var b=this;this.refreshTimerId=setTimeout(function(){var a=b.getDateRange(),c=a&&a[0],d=a&&a[1];p.call(b,c,d),q.call(b,c,d),r.call(b,c,d,b.getMinDate(),b.getMaxDate())},0)},p=function(a,b){var d=c.getDateRangeLabel(a,b,this.getDateFormat());this.inputTag.find("input").val(d||""),a&&b?this.$el.addClass("has-val"):this.$el.removeClass("has-val")},q=function(b,c){var d=this.$el.children(".tools"),e=d.children(".label").text("选择日期"),f=d.find(".item").removeClass("selected");if(b&&c&&-1==a.getDays(c,new Date))for(var g=a.getDays(c,b)+1,h=0,i=f.length;h<i;h++){var j=f.eq(h);if(j.attr("data-val")==g){j.addClass("selected"),e.text(j.text());break}}},r=function(b,c,d,e){if(this.isRenderAsApp()&&this._isNative()){var f=this.inputTag.children(".origin-dateipt.start"),g=this.inputTag.children(".origin-dateipt.end");f.val(b?a.toDateString(b,"yyyy-MM-dd"):""),g.val(c?a.toDateString(c,"yyyy-MM-dd"):""),d=d?a.toDateString(d,"yyyy-MM-dd"):"",e=e?a.toDateString(e,"yyyy-MM-dd"):"",f.attr("min",d).attr("max",e),g.attr("min",d).attr("max",e)}else this.picker&&(this.picker.setMinDate(d),this.picker.setMaxDate(e),this.picker.setDate(b,c))},s=function(a){if((a=parseInt(a)||0)>0){var b=new Date,c=new Date;b.setDate(b.getDate()-a),c.setDate(c.getDate()-1),this.setDateRange(b,c)}},t=function(){var a=$("<input class='origin-dateipt start' type='date'/>").appendTo(this.inputTag),b=$("<input class='origin-dateipt end' type='date'/>").appendTo(this.inputTag);r.call(this,this.getStartDate(),this.getEndDate(),this.getMinDate(),this.getMaxDate()),a.on("change",n.bind(this)),b.on("change",n.bind(this))},u=function(){if(!this.picker){var a={range:!0};a.target=$("<div class='picker'></div>").appendTo(this.inputTag),a.min=this.getMinDate(),a.max=this.getMaxDate(),a.start=this.getStartDate(),a.end=this.getEndDate(),this.picker=b.DatePicker.create(a),this.picker.on("submit",j.bind(this)),this.picker.on("cancel",k.bind(this))}if(!this.$el.is(".show-picker"))if(this.$el.addClass("show-picker").removeClass("show-before").removeClass("show-right"),this.isRenderAsApp())$("html, body").addClass("ui-scrollless"),this.inputTag.children(".picker").on("tap",l.bind(this));else{var c=this.inputTag.children(".picker"),d=c.offset(),e=d.left+c.width(),f=d.top+c.height(),g=$(window).width()+$("body").scrollLeft()+$("html").scrollLeft(),h=$(window).height()+$("body").scrollTop()+$("html").scrollTop();e>g&&this.$el.addClass("show-right"),f>h&&this.$el.addClass("show-before")}},v=function(){this.$el.removeClass("show-picker"),this.isRenderAsApp()&&($("html, body").removeClass("ui-scrollless"),this.$el.children(".picker").off("tap"))},w=function(a){return a instanceof Date?1e4*a.getFullYear()+100*a.getMonth()+a.getDate():0};b.register(".ui-daterange",d)}}(),function(a){if(a||!VRender.Component.Render.popupmenu){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").ListRenderer:VRender.Component.Render._list,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;e.render=function(d,e){if(c.render.call(this,d,e),e.addClass("ui-popupmenu"),a){var f=this.options.actionTarget;f&&(b.isFunction(f.getViewId)?e.attr("opt-target","[vid='"+f.getViewId()+"']"):e.attr("opt-target",b.trimToEmpty(f))),this.options.actionType&&e.attr("opt-trigger",this.options.actionType);var g=this.options.iconFunction;b.isFunction(g)?c.renderFunction(e,"icfunc",g):this.options.iconField&&e.attr("opt-ic",this.options.iconField),this.options.childrenField&&e.attr("opt-child",this.options.childrenField),this.options.disabledField&&e.attr("opt-disable",this.options.disabledField),this.options.offsetLeft&&e.attr("opt-offsetl",this.options.offsetLeft),this.options.offsetTop&&e.attr("opt-offsett",this.options.offsetTop)}return this},e._renderItems=function(a,b){},e._doAdapter=function(d,e){if(b.isArray(d)){var f=this,g=b.map(d,function(a){return c.doAdapter.call(f,a)});return d.title&&(a?g.unshift({__group__:d.title}):g.title=d.title),g}return c.doAdapter.call(this,d,e)},a?module.exports=d:VRender.Component.Render.popupmenu=d}}("undefined"==typeof VRender),function(){if(!VRender.Component.PopupMenu){var a=VRender.Utils,b=VRender.Component,c=b.Render.popupmenu,d=window.UIPopupMenu=b.PopupMenu=function(c,d){if(this.init(c,d)!=this)return b.get(c);this.viewId=a.randomTxt(8),this.options.autoLoad=!1,this.setActionTarget(this.getActionTarget()),this.$el.on("tap",g.bind(this)),this.$el.on("tap",".menu",h.bind(this)),this.$el.on("tap",".more",i.bind(this)),this.isRenderAsApp()?this.$el.on("tap",".back",j.bind(this)):(this.$el.on("mouseenter",".menu",k.bind(this)),this.$el.on("mouseleave",".menu",l.bind(this)),this.$el.on("mouseenter",".menu-container > .btn",m.bind(this)),this.$el.on("mouseleave",".menu-container > .btn",n.bind(this)))},e=d.prototype=new b.list;d.find=function(a){return b.find(a,".ui-popupmenu",d)},d.create=function(a){return b.create(a,d,c)},e.open=function(){var a=this.$el.show();if(o.call(this,a),this.isRenderAsApp())$("body").addClass("ui-scrollless"),setTimeout(function(){a.addClass("animate-open")},0);else{var b=this;setTimeout(function(){$("body").on("tap._"+b.viewId,function(){b.close()})},0)}},e.close=function(){var a=this.$el;this.isRenderAsApp()?($("body").removeClass("ui-scrollless"),a.removeClass("animate-open"),a.children(".menu-container").last().height(0),setTimeout(function(){a.empty().hide()},300)):(a.empty().hide(),$("body").off("tap._"+this.viewId))},e.getActionTarget=function(){return this.options.hasOwnProperty("actionTarget")?this.options.actionTarget:(this.options.actionTarget=a.trimToNull(this.$el.attr("opt-target")),this.$el.removeAttr("opt-target"),this.options.actionTarget)},e.setActionTarget=function(b){if(this.actionTarget!=b){var c=a.trimToNull(this.getActionType())||"click",d=c+"."+this.viewId;this.actionTarget&&("string"==typeof this.actionTarget?$("body").off(d,this.actionTarget):this.actionTarget.off(d)),this.actionTarget=b,this.actionTarget&&("string"==typeof this.actionTarget?$("body").on(d,this.actionTarget,f.bind(this)):(this.actionTarget=$(this.actionTarget),this.actionTarget.on(d,f.bind(this)))),this.$el.removeAttr("opt-target")}},e.getActionType=function(){return this.options.hasOwnProperty("actionType")?this.options.actionType:(this.options.actionType=a.trimToNull(this.$el.attr("opt-tigger")),this.$el.removeAttr("opt-tigger"),this.options.actionType)},e.setActionType=function(a){this.options.actionType=a,this.$el.removeAttr("opt-tigger")},e.getIconField=function(){return this.options.hasOwnProperty("iconField")?this.options.iconField:(this.options.iconField=a.trimToNull(this.$el.attr("opt-ic"))||"icon",this.$el.removeAttr("opt-ic"),this.options.iconField)},e.setIconField=function(a){this.options.iconField=a,this.$el.removeAttr("opt-ic")},e.getIconFunction=function(){return b.list.getFunction.call(this,"iconFunction","icfunc")},e.setIconFunction=function(a){this.options.iconFunction=a,this.$el.children(".ui-fn[name='icfunc']").remove()},e.getOffsetLeft=function(){return this.options.hasOwnProperty("offsetLeft")||(this.options.offsetLeft=this.$el.attr("opt-offsetl"),this.$el.removeAttr("opt-offsetl")),this.options.offsetLeft?a.getFormatSize(this.options.offsetLeft,this.isRenderAsRem()):null},e.setOffsetLeft=function(a){this.options.offsetLeft=a,this.$el.removeAttr("opt-offsetl")},e.getOffsetTop=function(){return this.options.hasOwnProperty("offsetTop")||(this.options.offsetTop=this.$el.attr("opt-offsett"),this.$el.removeAttr("opt-offsett")),this.options.offsetTop?a.getFormatSize(this.options.offsetTop,this.isRenderAsRem()):null},e.setOffsetTop=function(a){this.options.offsetTop=a,this.$el.removeAttr("opt-offsett")},e._getChildrenField=function(){return"children"},e._getDisabledField=function(){return"disabled"},e._getIcon=function(b){var c=this.getIconFunction();if(a.isFunction(c))return c(b);var d=this.getIconField();return b&&d?b[d]:null},e._isDisabled=function(b){if(b){var c=this._getDisabledField();return!(!c||!a.isTrue(b[c]))}return!0},e._isChecked=function(a){return!!a&&!!a.checked},e._checkIfEmpty=function(){};var f=function(a){this._isMounted(this.$el)?this.open():this.setActionTarget(null)},g=function(a){return this.isRenderAsApp()&&$(a.target).is(".ui-popupmenu")&&this.close(),!1},h=function(b){var c=$(b.currentTarget);if(!c.is(".disabled"))if(c.is(".has-child"))this.isRenderAsApp()&&o.call(this,c);else{var d=A.call(this,c);if(d.toggle)if(d.checked)d.toggleRadio||(d.checked=!1);else{var e=this,f=function(b){b&&b.length>0&&a.each(b,function(b){a.isArray(b)?f(b):(b.toggle===d.toggle&&(b.checked=!1),f(C.call(e,b)))})};f(this.getData()),d.checked=!0}this.trigger("itemclick",d),this.close()}},i=function(b){var c=$(b.currentTarget),d=c.parent().parent().parent(),e=w.call(this),f=x.call(this);f.p_no=parseInt(c.attr("page-no"))||1,f.p_no+=1;var g=d.data("itemData");f.pid=this._getDataId(g),c.parent().remove();var h=g?C.call(this,g):this.getData();h.pop();v.call(this,d,e,f,function(b,c){c&&c.length>0&&a.each(c,function(a){h.push(a)})})},j=function(a){var b=$(a.currentTarget),c=b.parent();c.height(0);var d=c.prev();d.height(0),setTimeout(function(){c.remove(),d.height(d.get(0).scrollHeight)},120)},k=function(a){var b=$(a.currentTarget);if(!b.is(".disabled")){var c=b.parent().parent().parent(),d=c.find(".hover");if(d&&d.length>0){d.removeClass("hover"),t.call(this,c);var e=parseInt(d.attr("t-hover"));e&&(clearTimeout(e),d.removeAttr("t-hover"))}b.addClass("hover"),b.is(".has-child")&&o.call(this,b)}},l=function(a){var b=$(a.currentTarget),c=b.data("submenu");if(!c||0==c.length){var d=setTimeout(function(){b.removeClass("hover"),b.removeAttr("t-hover")},100);b.attr("t-hover",d)}},m=function(a){var b=$(a.currentTarget),c=b.parent(),d=function(){var a=c.children(".menus"),d=c.height()-a.height(),e=parseInt(c.attr("scroll-top"))||0,f=b.is(".up")?5:-5,g=function(){var h=setTimeout(function(){var h=e+f;b.is(".up")?h>0&&(h=0):h<d&&(h=d),e!=h&&(e=h,c.attr("scroll-top",e),a.css("transform","translate(0px, "+e+"px)")),g()},50);c.attr("t_scroll",h)};g()};c.attr("t_scroll",setTimeout(d,200))},n=function(a){var b=$(a.currentTarget).parent(),c=parseInt(b.attr("t_scroll"));c&&(clearTimeout(c),b.removeAttr("t_scroll"))},o=function(b){var c=A.call(this,b),d=B.call(this,b),e=p.call(this,b,c,d);if(a.isNull(e)){if(!u.call(this,b))return}else if(!(e&&e.length>0||u.call(this,b)))return;var f=$("<div class='menu-container'></div>").appendTo(this.$el);f.append("<div class='btn up'></div><div class='btn down'></div>"),this.isRenderAsApp()&&!y(b)&&$("<div class='back'></div>").appendTo(f).text(this.options.backText||"返回");var g=$("<div class='menus'></div>").appendTo(f);r.call(this,g,e),b.data("submenu",f),f.data("itemData",c),q.call(this,b,f),this.trigger("open",c)},p=function(b,c,d){var e={type:"open_before"};this.trigger(e,c,d),e.hasOwnProperty("returnValue")&&(d=e.returnValue);var f=d?a.toArray(d):null;if(c){c[this._getChildrenField()]=f}return f},q=function(b,c){if(this.isRenderAsApp());else{if(y(b)){var d=this.getOffsetLeft();d&&c.css("left",d);var e=this.getOffsetTop();e&&c.css("top",e)}else{var f=b.offset();f.top-=3,f.left+=b.outerWidth()+1,c.offset(f)}var g=$(window),h=g.width(),i=g.height();c.css("maxHeight",i);var f=a.offsetWindow(c);f.width=c.outerWidth(),f.height=c.outerHeight();var j=c.offset();f.left+f.width>h&&(j.left=b.offset().left-b.outerWidth()),f.top+f.height>i&&(y(b)?c.css("maxHeight",i-f.top):j.top-=f.top+f.height-i),c.offset({left:j.left,top:j.top}),c.height()<c.children(".menus").height()&&c.addClass("scroll").css("minHeight","80px")}},r=function(b,c){if(c&&0!=c.length){var d=this,e=b.children(".grp").last();if(a.each(c,function(c,f){if(a.isArray(c)&&c.length>0)e=$("<div class='grp'></div>").appendTo(b),c.title&&$("<div class='title'></div>").appendTo(e).text(c.title),a.each(c,function(a,b){if(0===b&&a.__group__)$("<div class='title'></div>").appendTo(e).text(a.__group__);else if("more"==a.__type__){var c=$("<div class='more'></div>").appendTo(e);c.attr("page-no",a.page),c.text(d.options.moreText||"加载更多")}else{var f=$("<div class='menu'></div>").appendTo(e);s.call(d,f,a)}}),e=null;else{e&&0!=e.length||(e=$("<div class='grp'></div>").appendTo(b));var g=$("<div class='menu'></div>").appendTo(e);s.call(d,g,c)}}),this.isRenderAsApp()){var f=b.parent();f.height(0),setTimeout(function(){f.height(f.get(0).scrollHeight)},0)}}},s=function(b,c){b.data("itemData",c);var d=this._getIcon(c);if(a.isNotBlank(d)){$("<i></i>").appendTo(b).css("backgroundImage","url("+d+")")}var e=$("<div></div>").appendTo(b),f=this.getItemRenderer();if(a.isFunction(f)){var g=f($,e,c);a.isNotNull(g)&&e.empty().append(g)}else{var h=this._getDataLabel(c);e.text(a.trimToEmpty(h))}C.call(this,c)&&b.addClass("has-child"),this._isDisabled(c)&&b.addClass("disabled").attr("disabled","disabled"),this._isChecked(c)&&b.addClass("checked")},t=function(a){for(var b=this.$el.children(".menu-container"),c=a.index(),d=b.length-1;d>=0;d--){if(c>=d)return;b.eq(d).remove()}},u=function(b){var c=w.call(this);if(a.isBlank(c))return!1;var d=x.call(this)||{};d.p_no=1,d.pid=z.call(this,b);var e=this;return setTimeout(function(){var a=b.data("submenu");v.call(e,a,c,d,function(c,d){var f=!1;if(d&&0!=d.length||(f=!0,d=[{label:"没有选项"}],d[0][e._getDisabledField()]=!0),y(b))e.options.data=d;else{var g=A.call(e,b);g&&(g[e._getChildrenField()]=d)}f&&r.call(e,a.children(".menus"),d)})},0),!0},v=function(c,d,e,f){var g=c.children(".menus"),h=$("<div class='grp'></div>").appendTo(g);$("<div class='loading'></div>").appendTo(h).append(this.options.loadingText||"正在加载...");var i=this;b.load.call(this,d,e,function(b,c){h.remove();var d=b?null:a.toArray(c);d&&d.length>0&&(d[0].children=[],i._totalSize>i._pageSize*i._pageNo&&d.push([{__type__:"more",page:i._pageNo}]),r.call(i,g,d)),f(b,d)})},w=function(){return this.lastLoadApi?this.lastLoadApi:this.options.hasOwnProperty("api")?this.options.api:this.$el.attr("api-name")},x=function(){if(this.lastLoadParams)return this.lastLoadParams;if(this.options.hasOwnProperty("params"))return this.options.params;try{return JSON.parse(this.$el.attr("api-params")||null)}catch(a){}return null},y=function(a){return a.is(".ui-popupmenu")},z=function(a){return this._getDataId(A.call(this,a))},A=function(a){return y(a)?null:a.data("itemData")},B=function(a){if(y(a))return this.getData();var b=A.call(this,a);return C.call(this,b)},C=function(b){if(b){var c=this._getChildrenField();if(a.isArray(b[c]))return b[c]}return null};b.register(".ui-popupmenu",d)}}(),function(a){if(a||!VRender.Component.Render.radiogroup){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").ListRenderer:VRender.Component.Render._list,d=a?require("../../../ui/component/UIRadiobox"):VRender.Component.Radiobox,e=1,f=function(a,b){c.call(this,a,b)},g=f.prototype=new c;g.render=function(d,f){f.addClass("ui-radgrp"),this.radioGroupId="rad-"+b.randomTxt(a?3:4)+e++,c.render.call(this,d,f)},g._renderOneItem=function(a,b,c,d,e){i.call(this,a,b,c,d,e)},g._getNewItem=function(a,b){return h.call(this,a,b)};var h=function(a,b){return a("<div class='item'></div>").appendTo(b)},i=function(b,c,e,f,g){var h={};if(h.name=this.radioGroupId,h.checked=g,h.label=this._getDataLabel(e,f),a)return new d(this.context,h).render(c);h.target=c,d.create(h)};a?module.exports=f:(f.getNewItem=h,f.renderOneItem=i,VRender.Component.Render.radiogroup=f)}}("undefined"==typeof VRender),function(){if(!VRender.Component.RadioGroup){var a=VRender.Utils,b=VRender.Component,c=b.Render.radiogroup,d=window.UIRadioGroup=b.RadioGroup=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.$el.on("change","input",f.bind(this))},e=d.prototype=new b.list;d.find=function(a){return b.find(a,".ui-radgrp",d)},d.create=function(a){return b.create(a,d,c)},e.setSelectedIndex=function(c){var d=this._snapshoot(),e=a.getIndexValue(c);e>=0?b.get(this.$el.children().eq(e).children()).setChecked(!0):d.selectedIndex>=0&&b.get(this.$el.children().eq(d.selectedIndex).children()).setChecked(!1),d.done()},e._getItems=function(){return this.$el.children()},e._getNewItem=function(a,b,d,e){return c.getNewItem.call(this,a,b,d,e)},e._renderOneItem=function(a,b,d,e,f){c.renderOneItem.call(this,a,b,d,e,f)};var f=function(c){var d=this._snapshoot(),e=a.index(this.$el.find("input"),function(a){return a.is(":checked")});b.list.setSelectedIndex.call(this,e),d.done()};b.register(".ui-radgrp",d)}}(),function(a){if(a||!VRender.Component.Render.panel){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;e.render=function(a,b){return b.addClass("ui-panel"),c.render.call(this,a,b),this._viewports=l.call(this,this.options.viewports),f.call(this,a,b),j.call(this,a,b),this},e.getTitle=function(){return this.options.hasOwnProperty("title")?this.options.title:!(this._viewports&&this._viewports.length>0)&&"标题"};var f=function(a,c){var d=this.options||{},e=a("<header></header>").appendTo(c);if(d.focusHtmlTitle)a("<div class='title'></div>").appendTo(e).html(d.focusHtmlTitle);else{var f=this.getTitle();!1!==f&&b.isNotBlank(f)&&a("<div class='title'></div>").appendTo(e).text(f)}g.call(this,a,c,this._viewports);var i=b.toArray(this.options.buttons);h.call(this,a,c,i)},g=function(a,c,d){var e=c.children("header");if(e.children(".tabbar").remove(),d&&d.length>0){var f=a("<div class='tabbar'></div>").prependTo(e);e.children(".title").after(f),f.append("<div class='thumb'></div>");var g=b.getIndexValue(this.options.viewIndex);b.each(d,function(b,c){var d=a("<div class='tab'></div>").appendTo(f);d.attr("name",b.name),b.focusHtmlLabel?d.html(b.focusHtmlLabel):a("<span></span>").appendTo(d).text(b.label||b.name),c==g&&d.addClass("selected")})}},h=function(a,c,d){var e=c.children("header");if(e.children(".btnbar").remove(),d&&d.length>0){var f=this,g=a("<div class='btnbar'></div>").appendTo(e);this.isRenderAsApp()?g.append("<button class='popbtn'>&nbsp;</button>"):b.each(d,function(b){i.call(f,a,g,b)})}},i=function(a,c,d){if(!b.isBlank(d)){"string"==typeof d&&(d={name:d});var e=a("<div class='item'></div>").appendTo(c);e.attr("name",b.trimToNull(d.name));var f=b.isTrue(d.toggle);f&&e.attr("opt-toggle","1"),b.isNotBlank(d.tooltip)&&e.attr("title",d.tooltip);var g=a("<button class='btn'></button>").appendTo(e);if(d.icon){var h=a("<i>&nbsp;</i>").appendTo(g);"string"==typeof d.icon&&h.css("backgroundImage","url("+d.icon+")")}if(!d.icon||!1!==d.label){a("<span></span>").appendTo(g).text(b.trimToNull(d.label)||"按钮")}if(b.isArray(d.items)&&d.items.length>0){var i=a("<ul></ul>").appendTo(e.attr("has-dropdown","1")),j=!1;b.each(d.items,function(c,e){var g=a("<li></li>").appendTo(i);g.attr("name",b.trimToNull(c.name)),b.isNotBlank(c.icon)&&(j=!0,a("<i>&nbsp;</i>").appendTo(g).css("backgroundImage","url("+c.icon+")"));var h=b.trimToNull(c.label);a("<span></span>").appendTo(g).text(h||"选项"),f&&h&&h==d.label&&g.addClass("active")}),j&&i.attr("show-ic","1")}}},j=function(a,c,d){var e=a("<section></section>").appendTo(c);e=a("<div class='container'></div>").appendTo(e);var f=a("<div></div>").appendTo(e),g=this.options.content||this.options.view;b.isNotNull(g)&&(b.isFunction(g.render)?g.render(f):f.append(g.$el||g)),d=d||this._viewports,k.call(this,a,e,d),0==e.children(".selected").length&&f.addClass("selected")},k=function(a,c,d){if(c.children(":not(:first-child)").remove(),d&&d.length>0){var e=b.getIndexValue(this.options.viewIndex);b.each(d,function(d,f){if(contentView=d.content||d.view,b.isNotNull(contentView)){var g=a("<div></div>").appendTo(c);g.attr("name",d.name),f==e&&g.addClass("selected"),b.isFunction(contentView.render)?contentView.render(g):g.append(contentView.$el||contentView)}})}},l=function(a){var c=[];return b.each(b.toArray(a),function(a,d){b.isNotBlank(a)&&"object"==typeof a&&(a.name=a.name||"view_"+d,c.push(a))}),c};a?module.exports=d:(d.renderTabs=g,d.renderButtons=h,d.renderViewports=k,d.getFormatViewports=l,VRender.Component.Render.panel=d)}}("undefined"==typeof VRender),function(){if(!VRender.Component.Panel){var a=VRender.Utils,b=VRender.Component,c=b.Render.panel,d=window.UIPanel=b.Panel=function(a,c){if(this.init(a,c)!=this)return b.get(a);this.header=this.$el.children("header"),this.container=this.$el.children("section").children(),this.header.on("tap",".tabbar > .tab",j.bind(this)),this.isRenderAsApp()?this.header.on("tap",".btnbar > .popbtn",g.bind(this)):(this.header.on("tap",".btnbar > .item > .btn",f.bind(this)),this.header.on("tap",".btnbar > .item > ul > li",h.bind(this)),this.header.on("mouseenter",".btnbar > .item",i.bind(this)),this.header.on("mouseleave",".btnbar > .item",i.bind(this))),k.call(this)},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-panel",d)},d.create=function(a){return b.create(a,d,c)},e.getTitle=function(){return this.header.children(".title").text()},e.setTitle=function(b){if(a.isNotNull(b)){b=a.trimToEmpty(b);var c=this.header.children(".title");c&&c.length>0?b?c.empty().append(b):c.remove():b&&(c=$("<div class='title'></div>").prependTo(this.header),c.append(b))}},e.setButtons=function(b){c.renderButtons.call(this,$,this.$el,a.toArray(b))},e.setViewports=function(a,b){var d=c.getFormatViewports.call(this,a);c.renderTabs.call(this,$,this.$el,d),c.renderViewports.call(this,$,this.container,d),this.setViewActive(b)},e.isViewActive=function(b){var c=a.each(this.header.find(".tabbar .tab"),function(a){return a.attr("name")==b});return c&&c.is(".selected")},e.setViewActive=function(b){a.isNotBlank(b)&&l.call(this,b)};var f=function(b){var c=$(b.currentTarget),d=c.parent();if(1==d.attr("has-dropdown")){var e=d.children("ul");e.height(e.get(0).scrollHeight)}else 1==d.attr("opt-toggle")&&d.toggleClass("active");var f=d.attr("name");a.isNotBlank(f)&&this.trigger("btnclick",f,c.is(".active"))},g=function(a){},h=function(b){var c=$(b.currentTarget),d=c.parent().parent();if(1==d.attr("opt-toggle")&&!c.is(".active")){c.addClass("active").siblings().removeClass("active");var e=d.children(".btn"),f=e.children("span");f&&f.length>0&&f.text(c.children("span").text());var g=e.children("i");if(g&&g.length>0){g.attr("data-src")||g.attr("data-src",g.css("backgroundImage"))
;var h=c.children("i").css("backgroundImage")||g.attr("data-src");g.css("backgroundImage",h)}}c.parent().css("height","");var i=c.attr("name");a.isNotBlank(i)&&this.trigger("btnclick",i,c.is(".active"))},i=function(a){var b=$(a.currentTarget),c=parseInt(b.attr("timerid"));c&&(clearTimeout(c),b.removeAttr("timerid")),"mouseleave"==a.type&&(c=setTimeout(function(){b.removeAttr("timerid"),b.children("ul").css("height","")},400),b.attr("timerid",c))},j=function(a){var b=$(a.currentTarget);b.is(".selected")||l.call(this,b.attr("name"))},k=function(){var a=this.header.find(".tabbar .tab.selected");a&&a.length>0&&m.call(this,a)},l=function(b){var c=this.header.find(".tabbar .tab"),d=a.find(c,function(a){return a.attr("name")==b});if(d&&d.length>0&&!d.is(".selected")){var e=c.filter(".selected").removeClass("selected");d.addClass("selected"),m.call(this,d);var f=this.container.children(),g=a.find(f,function(a){return a.attr("name")==b});if(g&&g.length>0||(g=f.eq(0)),!g.is(".selected")){var h=f.filter(".selected"),i=e.index()<d.index();g.addClass("animate-in"),g.addClass(i?"animate-in-right":"animate-in-left"),h.addClass("animate-out"),setTimeout(function(){g.removeClass("animate-in-left animate-in-right"),h.addClass(i?"animate-out-left":"animate-out-right"),setTimeout(function(){g.addClass("selected").removeClass("animate-in"),h.removeClass("selected animate-out animate-out-left animate-out-right")},400)},0)}this.trigger("change",d.attr("name"),e.attr("name"))}},m=function(a){var b=this.header.children(".tabbar").children(".thumb");b&&b.length>0&&(b.css("left",a.position().left),b.css("width",a.outerWidth()))};b.register(".ui-panel",d)}}(),function(a){if(a||!VRender.Component.Render.container){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)};(d.prototype=new c).render=function(a,d){c.render.call(this,a,d),d.addClass("ui-container");var f=this.options&&this.options.styles||{},g=this.isRenderAsRem();e(d,"display",f.display),e(d,"position",f.position),e(d,"padding",f.padding,g),e(d,"padding-left",f.paddingLeft,g),e(d,"padding-right",f.paddingRight,g),e(d,"padding-top",f.paddingTop,g),e(d,"padding-bottom",f.paddingBottom,g),e(d,"margin",f.margin,g),e(d,"margin-left",f.marginLeft,g),e(d,"margin-right",f.marginRight,g),e(d,"margin-top",f.marginTop,g),e(d,"margin-bottom",f.marginBottom,g),e(d,"border",f.border,g),e(d,"border-radius",f.borderRadius,g),e(d,"border-color",f.borderColor),e(d,"border-width",f.borderWidth,g),e(d,"border-left",f.borderLeft,g),e(d,"border-right",f.borderRight,g),e(d,"border-top",f.borderTop,g),e(d,"border-bottom",f.borderBottom,g),e(d,"background",f.bg||f.background),e(d,"background-color",f.bgcolor||f.backgroundColor),e(d,"background-image",f.image||f.backgroundImage),e(d,"background-size",f.backgroundSize),e(d,"background-position",f.backgroundPosition),e(d,"background-repeat",f.backgroundRepeat),e(d,"width",f.width,g),e(d,"min-width",f.minWidth,g),e(d,"max-width",f.maxWidth,g),e(d,"height",f.height,g),e(d,"min-height",f.minHeight,g),e(d,"max-height",f.maxHeight,g),e(d,"overflow",f.overflow),e(d,"color",f.color),e(d,"font-size",f.fontSize,g),e(d,"text-align",f.align||f.textAlign),e(d,"box-shadow",f.shadow);var h=this.options.content||this.options.view;return b.isNotBlank(h)&&(b.isFunction(h.render)?h.render(d):d.append(h.$el||h)),this};var e=function(a,c,d,e){b.isNotBlank(d)&&(isNaN(d)||(d=b.getFormatSize(d,e)),a.css(c,d))};a?module.exports=d:VRender.Component.Render.container=d}}("undefined"==typeof VRender),function(){if(!VRender.Component.Container){var a=(VRender.Utils,VRender.Component),b=a.Render.container,c=window.UIContainer=a.Container=function(b,c){if(this.init(b,c)!=this)return a.get(b)};c.prototype=new a.base;c.find=function(b){return a.find(b,".ui-container",c)},c.create=function(d){return a.create(d,c,b)}}}(),function(a){if(a||!VRender.Component.Render.paginator){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;d.getMode=function(a){return!1!==a&&("spread"==a||"dropdown"==a?a:"normal")},d.getShowNum=function(a){return a=parseInt(a)||0,a>0?a:10},d.getSizes=function(a){if(a){var c=[];return b.each(b.toArray(a),function(a){(a=parseInt(a)||0)>0&&c.indexOf(a)<0&&c.push(a)}),c.length>0?c:null}return null},d.getStatus=function(a){return!0===a?"_default":!1===a?null:b.trimToNull(a)},d.getSkip=function(a){return b.isNull(a)||!0===a?"1":b.isArray(a)?b.trimToEmpty(a[0])+"♮"+b.trimToEmpty(a[1]):null},e.render=function(d,e){c.render.call(this,d,e),e.addClass("ui-paginator");var g=o.call(this);if(e.attr("data-no",g.pageNo),e.attr("data-size",g.pageSize),e.attr("data-pages",g.pageCount),e.attr("data-total",g.totalCount),e.attr("opt-mode",g.mode||""),e.attr("opt-nums",g.showNum),g.status&&e.attr("opt-status",g.status),g.skip&&e.attr("opt-skip",g.skip),g.pageSizes.length>1&&e.attr("opt-sizes",g.pageSizes.join(",")),f.call(this,d,e,g),a){var h=this.options.buttons;!1===h?e.attr("opt-btns",""):!0!==h&&b.isNotBlank(h)&&e.attr("opt-btns",JSON.stringify(h))}},e._getButtons=function(){return this.options.buttons};var f=function(a,c,d){var e=a("<div class='pagebar'></div>").appendTo(c);if(g.call(this,a,c,e,d),d.pageSizes.length>1){var f=a("<div class='sizebar'></div>").appendTo(c);l.call(this,a,c,f,d)}if(b.isNotBlank(d.status)){var h=a("<div class='statusbar'></div>").appendTo(c);m.call(this,a,c,h,d)}if(b.isNotBlank(d.skip)){var i=a("<div class='skipbar'></div>").appendTo(c);n.call(this,a,c,i,d)}},g=function(a,b,c,d){var e=p.call(this,"first");e&&a("<button class='btn first'></button>").appendTo(c).text(e);var f=p.call(this,"prev");f&&a("<button class='btn prev'></button>").appendTo(c).text(f),h.call(this,a,b,c,d);var g=p.call(this,"next");g&&a("<button class='btn next'></button>").appendTo(c).text(g);var i=p.call(this,"last");i&&a("<button class='btn last'></button>").appendTo(c).text(i),b.removeClass("is-first").removeClass("is-last"),d.isFirstPage&&b.addClass("is-first"),d.isLastPage&&b.addClass("is-last")},h=function(a,b,c,d){var e=d.mode;if(!1!==e&&"false"!==e){var f=a("<div class='pages'></div>").appendTo(c);"spread"==e?j.call(this,a,b,f,d):"dropdown"==e?k.call(this,a,b,f,d):i.call(this,a,b,f,d)}},i=function(a,b,c,d){var e=[];e.push("<span class='pageno'>"+d.pageNo+"</span>"),e.push("<span class='pagecount'>"+d.pageCount+"</span>"),c.html(e.join("/"))},j=function(a,b,c,d){var e=d.showNum;(e=e>0?e:10)>3&&this.isRenderAsApp()&&(e=3);var f=d.pageNo-Math.floor(e/2);f+e-1>d.pageCount&&(f=d.pageCount-e+1),f<1&&(f=1),c.removeClass("has-prev").removeClass("has-next"),f>1&&c.addClass("has-prev");for(var g=0;g<e&&f<=d.pageCount;g++){var h=a("<span class='page'></span>").appendTo(c);h.text(f),f==d.pageNo&&h.addClass("selected"),f+=1}f-1<d.pageCount&&c.addClass("has-next")},k=function(a,b,c,d){a("<div class='lbl'></div>").appendTo(c).text(d.pageNo+"/"+d.pageCount);for(var e=a("<ul></ul>").appendTo(c),f=1;f<=d.pageCount;f++){var g=a("<li class='page'></li>").appendTo(e);g.text(f),f==d.pageNo&&g.addClass("selected")}},l=function(a,c,d,e){a("<div class='lbl'></div>").appendTo(d).text(e.pageSize);var f=a("<ul></ul>").appendTo(d);b.each(e.pageSizes,function(a){f.append("<li>"+a+"</li>")})},m=function(a,b,c,d){c.html(q.call(this,d.status,d))},n=function(a,c,d,e){var f=/♮/.test(e.skip)?e.skip.split("♮"):["",""];b.isBlank(f[0])&&e.status&&(f[0]="到第"),b.isNotBlank(f[0])&&a("<span class='txt t1'></span>").appendTo(d).text(f[0]),d.append("<input type='number'/>"),b.isBlank(f[1])&&e.status&&(f[1]="页"),b.isNotBlank(f[1])&&a("<span class='txt t2'></span>").appendTo(d).text(f[1]);var g=p.call(this,"skip")||"GO";a("<button class='btn skip'></button>").appendTo(d).text(g)},o=function(){var a={};return a.totalCount=parseInt(this.options.total)||0,a.totalCount=Math.max(0,a.totalCount),a.pageSize=parseInt(this.options.size)||0,a.pageSizes=d.getSizes(this.options.sizes)||[],a.pageSize<=0&&a.pageSizes&&a.pageSizes.length>0&&(a.pageSize=a.pageSizes[0]),a.pageSize<=0&&(a.pageSize=20),a.pageSizes.indexOf(a.pageSize)<0&&a.pageSizes.push(a.pageSize),a.pageSizes.sort(function(a,b){return a-b}),a.pageCount=Math.ceil(a.totalCount/a.pageSize)||1,a.pageNo=parseInt(this.options.page)||0,a.pageNo=Math.max(1,Math.min(a.pageNo,a.pageCount)),a.pageStart=Math.min((a.pageNo-1)*a.pageSize+1,a.totalCount),a.pageEnd=Math.min(a.pageNo*a.pageSize,a.totalCount),a.mode=d.getMode(this.options.mode),a.showNum=d.getShowNum(this.options.showNum),a.status=d.getStatus(this.options.status),a.skip=d.getSkip(this.options.skip),a.isFirstPage=1==a.pageNo,a.isLastPage=a.pageNo==a.pageCount,a},p=function(a){var c=this._getButtons();if(!1===c)return!1;var d=null;return b.isArray(c)&&("first"==a?d=c[0]:"prev"==a?d=c[1]:"next"==a?d=c[2]:"last"==a?d=c[3]:"skip"==a&&(d=c[4])),!1!==d&&(!0!==d&&b.isNotBlank(d)?""+d:"first"==a?"|<":"last"==a?">|":"prev"==a?"<":"next"==a?">":"skip"==a?"GO":""+a)},q=function(a,c){return!0===a||"_default"==a?"共"+c.totalCount+"条":(b.isNotBlank(a)&&(a=a.replace(/\{pageNo\}/g,c.pageNo),a=a.replace(/\{pageSize\}/g,c.pageSize),a=a.replace(/\{pageCount\}/g,c.pageCount),a=a.replace(/\{totalCount\}/g,c.totalCount),a=a.replace(/\{pageStart\}/g,c.pageStart),a=a.replace(/\{pageEnd\}/g,c.pageEnd)),b.trimToEmpty(a))};a?module.exports=d:(d.renderView=f,d.renderPageBar=g,d.renderPageSizeBar=l,d.renderPageStatusBar=m,VRender.Component.Render.paginator=d)}}("undefined"==typeof VRender),function(){if(!VRender.Component.Paginator){var a=VRender.Utils,b=VRender.Component,c=b.Render.paginator,d=window.UIPaginator=b.Paginator=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.tap("button.btn",f.bind(this)),this.tap(".pagebar .page",g.bind(this)),this.tap(".pagebar .lbl",h.bind(this)),this.tap(".sizebar .lbl",k.bind(this)),this.tap(".sizebar li",k.bind(this)),this.$el.on("keydown",".skipbar input",m.bind(this))},e=d.prototype=new b.base;d.find=function(a){return b.find(a,".ui-paginator",d)},d.create=function(a){return b.create(a,d,c)},e.set=function(a,b,c){var d=this._snapshoot();n.call(this,a,b,c),d.done()},e.getPage=function(){return parseInt(this.$el.attr("data-no"))||1},e.setPage=function(a){var b=this._snapshoot();n.call(this,null,a),b.done()},e.getSize=function(){return parseInt(this.$el.attr("data-size"))||0},e.setSize=function(a){n.call(this,null,null,a)},e.getTotal=function(){return parseInt(this.$el.attr("data-total"))||0},e.setTotal=function(a){var b=this._snapshoot();n.call(this,a),b.done()},e.getPageNo=function(){return this.getPage()},e.setPageNo=function(a){this.setPage(a)},e.getPageCount=function(){return parseInt(this.$el.attr("data-pages"))||1},e.setMode=function(a){this.$el.attr("opt-mode",c.getMode(a)||""),p.call(this)},e.setSizes=function(b){var d=a.isArray(b)?b:null;d&&(d=c.getSizes(d)),d&&d.length>0?this.$el.attr("opt-sizes",d.join(",")):this.$el.removeAttr("opt-sizes"),p.call(this)},e.setShowNum=function(a){(a=parseInt(a)||0)>0&&(this.$el.attr("opt-nums",a),p.call(this))},e.setStatus=function(a){a=c.getStatus(a),a?this.$el.attr("opt-status",a):this.$el.removeAttr("opt-status"),p.call(this)},e.setSkip=function(a){a=c.getSkip(a),a?this.$el.attr("opt-skip",a):this.$el.removeAttr("opt-skip"),p.call(this)},e.setButtons=function(a){this.options.buttons=a,this.$el.removeAttr("opt-btn"),p.call(this)},e._snapshoot_shoot=function(a){a.data={page:this.getPageNo(),size:this.getSize()}},e._snapshoot_compare=function(a){return a.data.page==this.getPageNo()},e._getMode=function(){return this.$el.attr("opt-mode")||!1},e._getSizes=function(){var a=this.$el.attr("opt-sizes")||"";return c.getSizes(a.split(","))},e._getShowNum=function(){return parseInt(this.$el.attr("opt-nums"))||c.getShowNum(-1)},e._getStatus=function(){var a=this.$el.attr("opt-status");return"_default"===a?"共{totalCount}条":a||""},e._getSkip=function(){var a=this.$el.attr("opt-skip");return 1==a||!!a&&a.split("♮")},e._getButtons=function(){if(this.options.hasOwnProperty("buttons"))return this.options.buttons;var a=this.$el.attr("opt-btns");return""!==a&&(a?JSON.parse(a):null)},e._isFirst=function(){return this.$el.is(".is-first")},e._isLast=function(){return this.$el.is(".is-last")};var f=function(a){var b=$(a.currentTarget);if(b.is(".disabled"))return!1;if(b.is(".skip")){var c=this.$el.find(".skipbar input"),d=parseInt(c.val())||0;d>0&&d!=this.getPageNo()&&this.setPageNo(d),c.val("")}else{var e=this.getPageNo();b.is(".prev")?this._isFirst()||this.setPageNo(e-1):b.is(".next")?this._isLast()||this.setPageNo(e+1):b.is(".first")?this._isFirst()||this.setPageNo(1):b.is(".last")&&(this._isLast()||this.setPageNo(this.getPageCount()))}},g=function(a){var b=$(a.currentTarget);if(!b.is(".selected")){if(r.call(this),this.isRenderAsApp()){var c=this;setTimeout(function(){c.setPageNo(b.text())},200)}else this.setPageNo(b.text());return!1}},h=function(b){var c=$(b.currentTarget).parent();if(!c.is(".show-dropdown")){c.addClass("show-dropdown");var d=c.children("ul");if(this.isRenderAsApp())$("html,body").addClass("ui-scrollless"),$("body").on("tap.paginator",j.bind(this)),setTimeout(function(){c.addClass("animate-in")},0);else{a.getViewScreenOffset(d).bottom<0&&c.addClass("show-before"),c.on("mouseenter mouseleave",i.bind(this))}var e=d.children(".selected");if(e&&e.length>0){var f=d.scrollTop();f+=e.offset().top,f-=d.offset().top,d.scrollTop(f)}}},i=function(a){if(this.t_dropdown&&(clearTimeout(this.t_dropdown),this.t_dropdown=0),"mouseleave"==a.type){var b=this;this.t_dropdown=setTimeout(function(){b.t_dropdown=0,r.call(b)},500)}},j=function(a){r.call(this)},k=function(b){var c=$(b.currentTarget);if(c.is(".lbl")){if(c=c.parent(),c.is(".show-dropdown"))return;c.addClass("show-dropdown").removeClass("show-before"),a.getViewScreenOffset(c.children("ul")).bottom<0&&c.addClass("show-before"),c.on("mouseenter mouseleave",l.bind(this))}else{var d=parseInt(c.text());d!=this.getSize()&&this.setSize(d),c=c.parent().parent(),c.removeClass("show-dropdown"),c.off("mouseenter mouseleave")}},l=function(a){if(this.t_sizebar&&(clearTimeout(this.t_sizebar),this.t_sizebar=0),"mouseleave"==a.type){var b=this;this.t_sizebar=setTimeout(function(){b.t_sizebar=0;var a=b.$el.children(".sizebar");a.removeClass("show-dropdown"),a.off("mouseenter mouseleave")},500)}},m=function(b){if("keydown"==b.type){if(13==b.which){var c=$(b.currentTarget),d=parseInt(c.val())||0;return d>0&&d!=this.getPageNo()&&this.setPageNo(d),c.val(""),!0}return a.isControlKey(b)||a.isNumberKey(b)}},n=function(b,c,d){b=Math.max(0,a.isBlank(b)||isNaN(b)?this.getTotal():parseInt(b)),c=Math.max(1,a.isBlank(c)||isNaN(c)?this.getPageNo():parseInt(c)),d=a.isBlank(d)||isNaN(d)?this.getSize():parseInt(d);var e=Math.ceil(b/d)||1;c=Math.min(c,e),this.$el.attr("data-total",b),this.$el.attr("data-size",d),this.$el.attr("data-no",c),this.$el.attr("data-pages",e),q.call(this),this.$el.find(".sizebar .lbl").text(d)},o=function(){var a={};return a.totalCount=this.getTotal(),a.pageSize=this.getSize(),a.pageSizes=this._getSizes()||[],a.pageSizes.indexOf(a.pageSize)<0&&a.pageSizes.push(a.pageSize),a.pageSizes.sort(function(a,b){return a-b}),a.pageNo=this.getPageNo(),a.pageCount=this.getPageCount(),a.pageStart=Math.min((a.pageNo-1)*a.pageSize+1,a.totalCount),a.pageEnd=Math.min(a.pageNo*a.pageSize,a.totalCount),a.mode=this._getMode(),a.showNum=this._getShowNum(),a.status=this._getStatus(),a.skip=this._getSkip(),a.isFirstPage=1==a.pageNo,a.isLastPage=a.pageNo==a.pageCount,a},p=function(){this.t_renderview&&(clearTimeout(this.t_renderview),this.t_renderview=0),this.t_renderpage&&(clearTimeout(this.t_renderpage),this.t_renderpage=0);var a=this;this.t_renderview=setTimeout(function(){a.t_renderview=0,c.renderView.call(a,$,a.$el.empty(),o.call(a))},0)},q=function(){if(!this.t_renderview){this.t_renderpage&&(clearTimeout(this.t_renderpage),this.t_renderpage=0);var a=this;this.t_renderpage=setTimeout(function(){a.t_renderpage=0;var b=o.call(a),d=a.$el.children(".pagebar").empty();c.renderPageBar.call(a,$,a.$el,d,b);var e=a.$el.children(".statusbar");e&&e.length>0&&c.renderPageStatusBar.call(a,$,a.$el,e,b)},0)}},r=function(){var a=this.$el.children(".pagebar").children(".pages");this.isRenderAsApp()?($("body").off("tap.paginator"),$("html,body").removeClass("ui-scrollless"),a.addClass("animate-out"),setTimeout(function(){a.removeClass("show-dropdown"),a.removeClass("animate-in").removeClass("animate-out")},200)):(a.removeClass("show-dropdown").removeClass("show-before"),a.off("mouseenter mouseleave"))};b.register(".ui-paginator",d)}}(),function(a){if(a||!VRender.Component.Render.tabbar){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").ListRenderer:VRender.Component.Render._list,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;e.render=function(a,b){b.addClass("ui-tabbar");var d=a("<div class='bar'></div>").appendTo(b);return d.append("<ul class='tabs'></ul>"),d.append("<div class='thumb'></div>"),c.render.call(this,a,b),h.call(this,a,b),this},e._renderOneItem=function(a,b,c,d,e){f.call(this,a,b,c,d,e)},e._getItemContainer=function(a,b){return b.find(".tabs")},e._getNewItem=function(a,b){return g.call(this,a,b)};var f=function(a,d,e,f,g){var h=d.children(".box");c.renderOneItem.call(this,a,d,h,e,f,g),e=e||{},b.isNotBlank(e.name)&&d.attr("name",e.name),b.isTrue(e.closable)&&d.addClass("closable").append("<i class='close'></i>")},g=function(a,b){var c=a("<li class='tab'></li>").appendTo(b);return c.append("<div class='box'></div>"),c},h=function(a,b){b=a("<div class='btns'></div>").appendTo(b),b.append("<span class='btn prev'>&lt;</span>"),b.append("<span class='btn next'>&gt;</span>")};a?module.exports=d:(d.renderOneItem=f,d.getNewItem=g,VRender.Component.Render.tabbar=d)}}("undefined"==typeof VRender),function(){if(!VRender.Component.Tabbar){var a=VRender.Utils,b=VRender.Component,c=b.Render.tabbar,d=window.UITabbar=b.Tabbar=function(a,c){if(this.init(a,c)!=this)return b.get(a);this.tabsView=this.$el.find(".tabs"),this.tap(".tab",f.bind(this)),this.tap(".close",j.bind(this)),this.isRenderAsApp()?(this.$el.on("touchstart",h.bind(this)),this.$el.on("touchmove",h.bind(this)),this.$el.on("touchend",h.bind(this)),this.$el.on("taphold",".tab",i.bind(this))):(this.$el.on("mousedown",".btn",g.bind(this)),this.$el.on("mouseup",".btn",g.bind(this)),this.$el.on("mouseleave",".btn",g.bind(this)),$(window).on("resize",k.bind(this))),l.call(this)},e=d.prototype=new b.list;d.find=function(a){return b.find(a,".ui-tabbar",d)},d.create=function(a){return b.create(a,d,c)},e.setSelectedIndex=function(b){var c=a.getIndexValue(b);p.call(this,c>=0?this._getItems().eq(c):null),l.call(this)},e.removeItemAt=function(b){this.close(a.getIndexValue(b))},e.close=function(b){var c=null;return"number"==typeof b?b>=0&&(c=this.tabsView.find(".tab").eq(b)):a.isNotBlank(b)&&(c=this.tabsView.find(".tab[name='"+b+"']")),c&&c.length>0?(q.call(this,c),c):null},e.isMultiple=function(){return!1},e._dataChanged=function(a){m.call(this)},e._getItemContainer=function(){return this.$el.find(".tabs")},e._getItems=function(){return this.$el.find(".tab")},e._getNewItem=function(a,b,d,e){return c.getNewItem.call(this,a,b,d,e)},e._renderOneItem=function(a,b,d,e,f){return c.renderOneItem.call(this,a,b,d,e,f)};var f=function(a){var b=$(a.currentTarget);b.is(".disabled")||(p.call(this,b),this.trigger("itemclick",this._getItemData(b)))},g=function(a){$(a.currentTarget);if(this.btnMouseTimerId&&(clearInterval(this.btnMouseTimerId),this.btnMouseTimerId=0),"mousedown"==a.type){var b=this,c=this.tabsView,d=parseInt(c.attr("opt-l"))||0,e=20*($(a.currentTarget).is(".prev")?1:-1);this.btnMouseTimerId=setInterval(function(){d+=e,n.call(b,d)},50)}},h=function(a){var b=a.touches&&a.touches[0];if("touchstart"===a.type)this.touchData={startX:b.pageX},this.touchData.startL=parseInt(this.tabsView.attr("opt-l"))||0;else if("touchmove"===a.type){if(a.touches.length>1||!this.$el.is(".over"))return;var c=b.pageX-this.touchData.startX;if(!this.touchData.moving&&Math.abs(c)<10)return;this.touchData.moving=!0;var d=this.touchData.startL+c;n.call(this,d)}else a.type},i=function(a){console.log(a)},j=function(a){var b=$(a.currentTarget).parent();return q.call(this,b),!1},k=function(a){m.call(this)},l=function(){if(m.call(this),this.$el.is(".over")){var a=this.tabsView.find(".tab.selected");if(a&&a.length>0){var b=this.tabsView.parent(),c=a.offset().left,d=b.offset().left,e=parseInt(this.tabsView.attr("opt-l"))||0;c<d?n.call(this,e+d-c):c-d>b.width()&&n.call(this,e-(c-d-b.width()+a.outerWidth()))}}o.call(this)},m=function(){var a=this.tabsView;a.width()<=this.$el.width()?(this.$el.removeClass("over over-l over-r"),n.call(this,0)):(this.$el.addClass("over"),n.call(this,parseInt(a.attr("opt-l"))||0))},n=function(a){var b=this.tabsView.width(),c=this.tabsView.parent().width();a>=0?a=0:a+b<c&&(a=c-b),this.$el.removeClass("over-l over-r"),a<0&&this.$el.addClass("over-l"),a+b>c&&this.$el.addClass("over-r"),a?(this.tabsView.css("transform","translate("+a+"px,0px)"),this.tabsView.attr("opt-l",a)):this.tabsView.css("transform","").removeAttr("opt-l"),o.call(this)},o=function(){this.thumbTimerId&&clearTimeout(this.thumbTimerId);var a=this;this.thumbTimerId=setTimeout(function(){a.thumbTimerId=0;var b=a.$el.find(".thumb"),c=a.tabsView.find(".tab.selected");if(c&&c.length>0){var d=c.offset().left;d-=a.tabsView.parent().offset().left;var e=c.outerWidth();if(a.isRenderAsApp()){var f=c.width();d+=(e-f)/2,e=f}b.css("left",d+"px"),b.width(e)}else b.width(0)},100)},p=function(a){var c=a&&a.length>0;if(!c||!a.is(".selected")){var d=c?a.index():[];b.list.setSelectedIndex.call(this,d);var e=r.call(this),f=null;e&&e.length>0&&(e.removeClass("selected"),f=this._getItemData(e),this.trigger("hide",f));var g=null;c&&(a.addClass("selected"),g=this._getItemData(a),this.trigger("show",g)),o.call(this);var h=this;setTimeout(function(){h.trigger("change",g,f)},0)}},q=function(a){var c=a.is(".selected"),d=this._getItemData(a),e=null,f=null;c&&(e=a.next(),e&&0!=e.length||(e=a.prev()),this.trigger("hide",d)),b.list.removeItem.call(this,a),this.trigger("close",d),e&&e.length>0?(e.addClass("selected"),f=this._getItemData(e),this.trigger("show",f),b.list.setSelectedIndex.call(this,e.index())):b.list.setSelectedIndex.call(this,[]),c&&this.trigger("change",f,d),m.call(this)},r=function(){return this.tabsView.find(".tab.selected")};b.register(".ui-tabbar",d)}}(),function(a){if(a||!VRender.Component.Render.listview){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").ListRenderer:VRender.Component.Render._list,d=a?require("../../../ui/component/UIButton"):VRender.Component.Button,e=function(a,b){c.call(this,a,b)},f=e.prototype=new c;e.itemRenderer_simple=function(a){var b={style:"ui-listview-item1",title:null,desc:null};return"string"==typeof a?(b.title=a,b.desc=arguments&&arguments[1]):a&&(b.title=a.titleField,b.desc=a.descField),e.itemRendererFunction.call(this,b)},e.itemRenderer_icon=function(a){var b={style:"ui-listview-item2",icon:null,title:null,desc:null};return"string"==typeof a?(b.icon=a,b.title=arguments&&arguments[1],b.desc=arguments&&arguments[2]):a&&(b.icon=a.iconField,b.title=a.titleField,b.desc=a.descField,b.defIcon=a.defaultIconUrl),e.itemRendererFunction.call(this,b)},e.itemRenderer_button=function(a){var c={style:"ui-listview-item3",buttons:null,title:null,desc:null};return"string"==typeof a?(c.title=a,c.desc=arguments&&arguments[1]):b.isArray(a)?(c.buttons=a,c.title=arguments&&arguments[1],c.desc=arguments&&arguments[2]):a&&(c.buttons=a.buttons,c.title=a.titleField,c.desc=a.descField),e.itemRendererFunction.call(this,c)},e.itemRenderer_icon_button=function(a){var c={style:"ui-listview-item4",buttons:null,icon:null,title:null,desc:null};return"string"==typeof a?(c.icon=a,c.buttons=arguments&&arguments[1],c.title=arguments&&arguments[2],c.desc=arguments&&arguments[3]):b.isArray(a)?(c.buttons=a,c.title=arguments&&arguments[1],c.desc=arguments&&arguments[2]):a&&(c.icon=a.iconField,c.buttons=a.buttons,c.title=a.titleField,c.desc=a.descField),e.itemRendererFunction.call(this,c)},e.itemRendererFunction=function(a){var c=function(c,e,f,g){var h=a||{},i=this,j=function(a,c){if(b.isNotNull(a))return f&&f[a];if(f&&c)for(var d in c){var e=c[d];if(b.isNotBlank(e)&&f.hasOwnProperty(e))return f[e]}return"title"==a&&b.isFunction(i._getDataLabel)?i._getDataLabel(f,g):void 0},e=c("<div></div>").addClass(h.style);if(h.hasOwnProperty("icon")){var k=j(h.icon,["icon","image","img"]);c("<img class='icon'/>").appendTo(e).attr("src",b.trimToEmpty(k)||h.defIcon||null)}var l=c("<div class='content'></div>").appendTo(e),m=j(h.title,["title"]);c("<div class='title'></div>").appendTo(l).html(m||"&nbsp;");var n=j(h.desc,["desc","description","remark"]);if(b.isNotBlank(n)&&c("<div class='desc'></div>").appendTo(l).html(n),h.hasOwnProperty("buttons")){var o=c("<div class='btnbar'></div>").appendTo(e);b.each(b.toArray(h.buttons),function(a){"undefined"==typeof VRender?new d(i.context,a).render(o):d.create(b.extend({},a,{target:o}))})}return e};return c._state=1,c._data=JSON.stringify(a),c},f.render=function(a,b){return b.addClass("ui-listview"),this.isChkboxVisible()&&b.addClass("show-chkbox"),b.append("<ul></ul>"),c.render.call(this,a,b),h.call(this,a,b),i.call(this,a,b),j.call(this,a,b),this},f.isChkboxVisible=function(){return b.isTrue(this.options.chkbox)},f.getPaginator=function(){return this.options.paginator||this.options.pager},f._renderOneItem=function(a,b,c,d,e){g.call(this,a,b,c,d,e)},f._getItemContainer=function(a,b){return b.children("ul")};var g=function(a,b,d,e,f){var g=a("<div class='box'></div>").appendTo(b);c.renderOneItem.call(this,a,b,g,d,e,f),this.isChkboxVisible()&&b.prepend("<span class='chkbox'></span>")},h=function(b,d){a&&c.renderPager.call(this,d,this.getPaginator())},i=function(a,b){c.renderEmptyView.call(this,a,b,"listview")},j=function(a,b){c.renderLoadView.call(this,a,b,"listview")};a?module.exports=e:(e.renderOneItem=g,VRender.Component.Render.listview=e)}}("undefined"==typeof VRender),function(){if(!VRender.Component.ListView){var a=VRender.Utils,b=VRender.Component,c=b.Render.listview,d=window.UIListView=b.ListView=function(a,c){if(this.init(a,c)!==this)return b.get(a);(this.list=this.$el.children("ul")).on("tap","li",f.bind(this))},e=d.prototype=new b.list;d.find=function(a){return b.find(a,".ui-listview",d)},d.create=function(a){return b.create(a,d,c)},e.isChkboxVisible=function(){return this.$el.is(".show-chkbox")},e.getPaginator=function(){return b.list.getPager.call(this)},e.setPaginator=function(a){b.list.setPager.call(this,a)},e._getItemContainer=function(){return this.$el.children("ul")},e._renderOneItem=function(a,b,d,e,f){c.renderOneItem.call(this,a,b,d,e,f)};var f=function(c){var d=$(c.currentTarget);if(d.parent().is(this.list)){if(d.is(".disabled"))return;var e=this._snapshoot();d.is(".selected")?d.removeClass("selected"):(d.addClass("selected"),this.isMultiple()||d.siblings().removeClass("selected"));var f=a.map(this.list.children(".selected"),function(a){return a.index()});b.list.setSelectedIndex.call(this,f),e.done()}};b.register(".ui-listview",d)}}(),function(a){if(a||!VRender.Component.Render.treeview){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").ListRenderer:VRender.Component.Render._list,d=function(a,b){c.call(this,a,b)},e=d.prototype=new c;d.getNewItem=function(a,b,c,d){var e=a("<li></li>").appendTo(b),f=a("<div class='tree-node'></div>").appendTo(e);return f.append("<span class='ep'></span>"),this.isChkboxVisible()&&f.append("<span class='chkbox'><i></i></span>"),this._isIconVisible()&&f.append("<span class='ic'><i></i></span>"),f.append("<div class='lbl'></div>"),e},e.render=function(a,b){return b.addClass("ui-treeview"),b.append("<ul class='root' level='0'></ul>"),c.render.call(this,a,b),k.call(this,a,b),this},e.getData=function(){var a=b.toArray(this.options.data);if(a._vr_adapter_flag)return a;var c=this,d=0,e=this.getChildrenField()||"children",f=function(a){return b.map(a,function(a,g){return a=c._doAdapter(a,d++),b.isArray(a[e])&&(a[e]=f(a[e])),a})};return a=f(a),a._vr_adapter_flag=!0,this.options.data=a,a},e.isChkboxVisible=function(){return b.isTrue(this.options.chkbox)},e.getChildrenField=function(){return this.options.childrenField},e.getLeafField=function(){return this.options.leafField},e._getItemContainer=function(a,b){return b.children("ul")},e._renderItems=function(a,b){var c=this._getItemContainer(a,b);f.call(this,a,b,c,this.getData())},e._getNewItem=function(a,b,c,e){return d.getNewItem.call(this,a,b,c,e)},e._isIconVisible=function(){return b.isTrue(this.options.icon)},e._getIcon=function(a,b){return r.call(this,this.options.icon,a,b)},e._getOpenProps=function(){var a=p.call(this,this.options.openIndex);a=a&&a.length>0?a:null;var b=q.call(this,this.options.openId);return b=b&&b.length>0?b:null,{indexs:a,ids:b}};var f=function(b,c,d,e){g.call(this,b,d,e,0,1),i.call(this,b,d),j.call(this,b,d),a&&d.find("li").removeData("_node_data")},g=function(a,c,d,e,f){var i=this,j=this.getChildrenField()||"children";return b.each(d,function(d){var k=i._getNewItem(a,c,d,e);h.call(i,a,k,d,e,f),e+=1;var l=d&&d[j];if(b.isArray(l)&&l.length>0){var m=a("<ul></ul>").appendTo(k);m.attr("level",f),e=g.call(i,a,m,l,e,f+1)}}),e},h=function(d,e,f,g,h){a&&e.data("_node_data",f);var i=this.getLeafField()||"leaf";b.isTrue(f&&f[i])&&e.addClass("is-leaf");var j=e.children(".tree-node"),k=j.children(".ic");if(k&&k.length>0){var l=this._getIcon(f,g);b.isNotBlank(l)&&k.children("i").css("backgroundImage","url("+l+")")}var m=j.children(".lbl");c.renderOneItem.call(this,d,j,m,f,g,!1)},i=function(a,b){var c=this._getOpenProps()||{},d=c.indexs;if(d&&d.length>0)for(var e=0,f=d.length;e<f;e++){var g=l.call(this,b,d[e],!0);g&&g.addClass("open")}else{var h=c.ids;if(h&&h.length>0)for(var e=0,f=h.length;e<f;e++){var g=m.call(this,b,h[e]);if(g)for(g.addClass("open");;){var i=g.parent();if(i.is(".root"))break;g=i.parent(),g.addClass("open")}}}},j=function(a,b){var c=this.getSelectedIndex(!0);if(c)for(var d=0,e=c.length;d<e;d++){var f=l.call(this,b,c[d],!0);f&&f.addClass("selected")}else{var g=this.getSelectedId(!0);if(g)for(var d=0,e=g.length;d<e;d++){var f=m.call(this,b,g[d]);f&&f.addClass("selected")}}o.call(this,b,!1)},k=function(c,d){this.isChkboxVisible()&&d.attr("opt-chk","1");var e=this.getChildrenField();if(b.isNotBlank(e)&&d.attr("opt-child",e),this.options.apiName){var f=this._getOpenProps()||{},g=f.indexs&&f.indexs.join(",");d.attr("opt-openinds",g||null);var h=f.ids&&f.ids.join(",");d.attr("opt-openids",h||null)}if(a){var i=this.options.icon;b.isFunction(i)?i=escape(i):"string"!=typeof i&&(i=b.isTrue(i)?1:0),i&&d.attr("opt-icon",i)}},l=function(a,b,c){var d=0,e=function(a){for(var f=a.children(),g=0,h=f.length;g<h;g++){var i=f.eq(g);if(d==b)return i;if(d+=1,(!c||i.is(".open"))&&(i=e(i.children("ul"))))return i}return null};return e(a)},m=function(a,b,c){var d=this,e=function(a){for(var f=a.children(),g=0,h=f.length;g<h;g++){var i=f.eq(g);if(d._getDataId(n.call(d,i))==b)return i;if((!c||i.is(".open"))&&(i=e(i.children("ul"))))return i}return null};return e(a)},n=function(b){return a?b.data("_node_data"):b.data("itemData")},o=function(a,b){var c=a.children();if(c&&c.length>0){for(var d=!1,e=!0,f=0,g=c.length;f<g;f++){var h=c.eq(f),i=h.children("ul");if(b||h.is(".selected"))d=!0,h.addClass("selected"),o.call(this,i,!0);else{var j=o.call(this,i,!1);"all"==j?(h.addClass("selected"),d=!0):"part"==j?(h.addClass("selected_"),d=!0,e=!1):e=!1}}return e?"all":d?"part":null}return null},p=function(a){if(b.isBlank(a))return[];b.isArray(a)||(a=(""+a).split(","));var c=[];return b.each(a,function(a){isNaN(a)||(a=parseInt(a),!isNaN(a)&&a>=0&&c.push(a))}),c},q=function(a){if(b.isBlank(a))return[];b.isArray(a)||(a=(""+a).split(","));var c=[];return b.each(a,function(a){(a||0===a)&&c.push(isNaN(a)?a:parseInt(a))}),c},r=function(a,c,d){
return b.isFunction(a)?a(c,d):(!0!==a&&1!=a||(a="icon"),"string"==typeof a?/\/|\./.test(a)?a:c&&c[a]||null:null)};a?module.exports=d:(d.getIcon=r,d.getOpenIndex=p,d.getOpenId=q,d.renderItems=f,d.renderOneNode=h,VRender.Component.Render.treeview=d)}}("undefined"==typeof VRender),function(){if(!VRender.Component.Tree){var a=VRender.Utils,b=VRender.Component,c=b.Render.treeview,d=window.UITreeView=b.Tree=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.$el.on("tap",".tree-node",j.bind(this)),this.$el.on("tap",".tree-node > .chkbox",l.bind(this)),this.$el.on("tap","li.more > div",m.bind(this)),this.isRenderAsApp()||this.$el.on("tap",".tree-node > .ep",k.bind(this)),f.call(this)},e=d.prototype=new b.list;d.find=function(a){return b.find(a,".ui-treeview",d)},d.create=function(a){return b.create(a,d,c)},e.getDataAt=function(a,b){var c=t.call(this,a,b);return c?this._getItemData(c):null},e.getDataIndex=function(a,b){var c=v.call(this,a,b);return c?w.call(this,c,b):-1},e.getDataById=function(a,b){var c=u.call(this,a,b);return c?this._getItemData(c):null},e.getIndexById=function(a,b){var c=u.call(this,a,b);return c?w.call(this,c,b):-1},e.getDataByName=function(b,c){if(a.isBlank(b))return null;var d=this,e=null;return z.call(this,function(a){var f=d._getItemData(a);return f&&f.name==b?(e=f,!1):!c&&!a.is(".open")||void 0}),e},e.getIndexByName=function(b,c){if(a.isBlank(b))return-1;var d=this,e=-1;return z.call(this,function(a,f){var g=d._getItemData(a);return g&&g.name==b?(e=f,!1):!c&&!a.is(".open")||void 0}),e},e.isChkboxVisible=function(){return"1"==this.$el.attr("opt-chk")},e.setChkboxVisible=function(b){if(b=!!a.isNull(b)||a.isTrue(b),this.isChkboxVisible()!=b){var c=this._snapshoot(),d=this.$el.find(".tree-node");b?(this.$el.attr("opt-chk","1"),d.children(".ep").after("<span class='chkbox'><i></i></span>")):(this.$el.removeAttr("opt-chk"),d.parent().removeClass("selected").removeClass("selected_"),d.children(".chkbox").remove()),c.done()}},e.getChildrenField=function(){return this.$el.attr("opt-child")||null},e.getLeafField=function(){return this.options.leafField},e.getSelectedIndex=function(a,b){var c=[],d=this.isChkboxVisible(),e=this.isMultiple();return z.call(this,function(a,f){if(d){if(a.is(".selected")){if(c.push(f),!e)return!1;if(!b)return!0}}else if(a.children(".tree-node").is(".active"))return c.push(f),!1;if(!b&&!a.is(".open"))return!0}),a||e?c.length>0?c:null:c.length>0?c[0]:-1},e.setSelectedIndex=function(a,c){var d=this.isChkboxVisible(),e=this.isMultiple(),f=b.list.getIntValues(a,0);!(f.length>1)||d&&e||(f=[f.pop()]);var g=this._snapshoot(),h=this.$el.find(".tree-node");d?h.parent().removeClass("selected").removeClass("selected_"):h.removeClass("active"),f.length>0&&z.call(this,function(a,b){if(f.indexOf(b)>=0){if(!d)return a.children(".tree-node").addClass("active"),!1;if(!a.is(".selected")){if(a.addClass("selected"),p(a),!e)return!1;o(a,!0)}}if(!c&&!a.is(".open"))return!0}),g.done()},e.getSelectedId=function(a,b){var c=[],d=this.isChkboxVisible(),e=this.isMultiple(),f=this;return z.call(this,function(a){if(d){if(a.is(".selected")){if(c.push(x.call(f,a)),!e)return!1;if(!b)return!0}}else if(a.children(".tree-node").is(".active"))return c.push(x.call(f,a)),!1;if(!b&&!a.is(".open"))return!0}),a||e?c.length>0?c:null:c.length>0?c[0]:-1},e.setSelectedId=function(b,c){var d=this.isChkboxVisible(),e=this.isMultiple(),f=a.isArray(b)?b:a.isBlank(b)?[]:a.trimToEmpty(b).split(",");!(f.length>1)||d&&e||(f=[f.pop()]);var g=this._snapshoot(),h=this.$el.find(".tree-node");if(d?h.parent().removeClass("selected").removeClass("selected_"):h.removeClass("active"),f.length>0){var i=this;z.call(this,function(b,g){var h=x.call(i,b);if(a.index(f,function(a){return a==h})>=0){if(!d)return b.children(".tree-node").addClass("active"),!1;if(!b.is(".selected")){if(b.addClass("selected"),p(b),!e)return!1;o(b,!0)}}if(!c&&!b.is(".open"))return!0})}g.done()},e.getSelectedData=function(a,b){var c=[],d=this.isChkboxVisible(),e=this.isMultiple(),f=this;return z.call(this,function(a){if(d){if(a.is(".selected")){if(c.push(y.call(f,a)),!e)return!1;if(!b)return!0}}else if(a.children(".tree-node").is(".active"))return c.push(y.call(f,a)),!1;if(!b&&!a.is(".open"))return!0}),a||e?c.length>0?c:null:c.length>0?c[0]:null},e.isAllSelected=function(){var a=!0;return z.call(this,function(b){return!!b.is(".selected")||(a=!1,!1)}),a},e.open=function(a){var b=v.call(this,a,!0);b&&h.call(this,b)},e.openAt=function(a,b){var c=t.call(this,a,b);c&&h.call(this,c)},e.openById=function(a){var b=u.call(this,a,!0);b&&h.call(this,b)},e.close=function(a){var b=v.call(this,a,!0);b&&i.call(this,b)},e.closeAt=function(a,b){var c=t.call(this,a,b);c&&i.call(this,c)},e.closeById=function(a){var b=u.call(this,a,!0);b&&i.call(this,b)},e.addItem=function(b,c,d){if(a.isBlank(b))return!1;var e=this._getItemContainer();if(a.isNotBlank(c)){var f=v.call(this,c,!0);f&&((e=f.children("ul"))&&e.length>0||(e=$("<ul></ul>").appendTo(f),e.attr("level",parseInt(f.parent().attr("level"))+1)))}var g=e.children(),h=e.is(".root")?0:w.call(this,e.parent(),!0);(d=a.getIndexValue(d))>=0&&d<g.length-1&&(h+=d);var i=this._snapshoot();return q.call(this,e,b,d,h),i.done(),!0},e.updateItem=function(b,c,d){if(a.isBlank(b))return!1;isNaN(c)||!c&&0!==c||(d=c,c=null);var e=this._snapshoot();if(c){var f=v.call(this,c,!0);if(!f)return e.release(),!1;var g=f.children("ul").children();if(a.isBlank(d)){var h=this,i=this._getDataId(b),j=a.find(g,function(a){var c=h._getItemData(a);return b==c||i==h._getDataId(c)});j&&r.call(this,j,b)}else isNaN(d)||(d=parseInt(d))>=0&&d<g.length&&r.call(this,g.eq(d),b)}else if(a.isBlank(d)){var j=v.call(this,b,!0);j&&r.call(this,j,b)}else if(!isNaN(d)){d=parseInt(d);var j=t.call(this,d);j&&r.call(this,j,b)}return e.done(),!0},e.removeItem=function(b,c){if(a.isBlank(b))return!1;var d=this._snapshoot();if(c){var e=v.call(this,c,!0);if(!e)return d.release(),!1;var f=this,g=this._getDataId(b),h=e.children("ul").children(),i=a.find(h,function(a){var c=f._getItemData(a);return b==c||g==f._getDataId(c)});i&&s.call(this,i)}else{var i=v.call(this,b,!0);i&&s.call(this,i)}return d.done(),!0},e.removeItemAt=function(b,c){if((b=a.getIndexValue(b))<0)return!1;var d=this._snapshoot();if(c){var e=v.call(this,c,!0);if(!e)return d.release(),!1;var f=e.children("ul").children();b<f.length&&s.call(this,f.eq(b))}else{var g=t.call(this,b);g&&s.call(this,g)}return d.done(),!0},e.addOrUpdateItem=function(b,c){a.isBlank(b)||this.updateItem(b,c)||this.addItem(b,c)},e.setItems=function(b,c){if(b=a.toArray(b),c){var d=v.call(this,c,!0);if(!d)return;for(var e=this._snapshoot(),f=d.children("ul").children(),g=f.length-1;g>=0;g--)s.call(this,f.eq(g));if(b&&b.length>0){var h=d.children("ul");h&&h.length>0||(h=$("<ul></ul>").appendTo(d),h.attr("level",parseInt(d.parent().attr("level"))+1));for(var i=w.call(this,d,!0),g=0,j=b.length;g<j;g++)q.call(this,h,b[g],g,i),i+=1}e.done()}else this.setData(b)},e.load=function(b,c,d){if(b=b||this.lastLoadApi,a.isBlank(b))return!1;var e=this._getOpenProps()||{};e.indexs&&(e.ids=null);var f=this,h=0,i=[],j=[],k=function(l,m){h+=1,g.call(f,l,b,m,function(b,g){if(h-=1,b?i.push(b):g&&g.length>0&&(j=j.concat(g)),e.indexs&&e.indexs.length>0){var l=t.call(f,e.indexs.shift(),!0);if(l&&!l.is(".is-loaded")){var m=x.call(f,l);k(l.addClass("open"),a.extend(c,{pid:m}))}}else e.ids&&a.each(e.id,function(b){var d=u.call(f,b,!0);if(d&&!d.is(".is-loaded")){var e=x.call(f,d);k(d.addClass("open"),a.extend(c,{pid:e}))}});h<=0&&a.isFunction(d)&&(i=i.join("\n"),d(i||!1,j),f.trigger("loaded",i,j))})};k(this._getItemContainer().empty(),c)},e._renderItems=function(a,b,d){c.renderItems.call(this,a,this.$el,b,d)},e._getItemContainer=function(){return this.$el.children("ul")},e._getNewItem=function(a,b,d,e){return c.getNewItem.call(this,a,b,d,e)},e._isIconVisible=function(){if(a.isTrue(this.options.icon))return!0},e._getIcon=function(a,b,d){return c.getIcon.call(this,this.options.icon,a,b)},e._getOpenProps=function(){var b={},d=this.$el.attr("opt-openinds");a.isNotBlank(d)&&(d=c.getOpenIndex.call(this,d),b.indexs=d&&d.length>0?d:null);var e=this.$el.attr("opt-openids");return a.isNotBlank(e)&&(e=c.getOpenId.call(this,e),b.ids=e&&e.length>0?e:null),this.$el.removeAttr("opt-openinds").removeAttr("opt-openids"),b},e._getItemData=function(a){return y.call(this,a)},e._doAdapter=function(c){var d=a.toArray(c);if(d._vr_adapter_flag)return d;var e=this,f=0,g=this.getChildrenField()||"children",h=function(c){return a.map(c,function(c,d){return c=b.list.doAdapter.call(e,c,f++),a.isArray(c[g])&&(c[g]=h(c[g])),c})};return d=h(d),d._vr_adapter_flag=!0,d},e._snapshoot_shoot=function(a){a.selectedIndex=this.getSelectedIndex(!0)},e._snapshoot_compare=function(a){var c=this.getSelectedIndex(!0);return b.list.equalIndex(a.selectedIndex,c)};var f=function(){if(!this.options.hasOwnProperty("icon")){var b=this.$el.attr("opt-icon");"1"==b?b=!0:/^function/.test(b)?b=new Function("var Utils=VRender.Utils;return ("+unescape(b)+");")():a.isBlank(b)&&(b=!1),this.options.icon=b}this.$el.removeAttr("opt-icon"),this.$el.removeAttr("data-inds").removeAttr("data-ids")},g=function(c,d,e,f){var g=c;if(c.is("li")&&((g=c.children("ul"))&&g.length>0||(g=$("<ul></ul>").appendTo(c),g.attr("level",parseInt(c.parent().attr("level"))+1))),c.is(".is-loaded,.is-loading"))return!1;c.addClass("is-loading");var h=$("<li class='loading'></li>").appendTo(g);h.append("<div>"+(this.loadingText||"正在加载...")+"</div>"),g.children(".more").remove();var i=this,j=w.call(this,c.is("li")?c:c.children().last);b.load.call(this,d,e,function(b,d){h.remove();var e=b?null:a.toArray(d);if(e&&e.length>0){a.each(e,function(a){q.call(i,g,a,-1,j),j+=1});if(i._totalSize>i._pageSize*i._pageNo){var k=$("<li class='more'></li>").appendTo(g);k.append("<div>"+(i.moreText||"加载更多..")+"</div>"),k.attr("page-no",i._pageNo)}else c.addClass("is-loaded")}else c.addClass("is-loaded"),0==g.children().length&&c.addClass("is-leaf").removeClass("open");c.removeClass("is-loading"),a.isFunction(f)&&f(b,e)})},h=function(b){for(var c=[],d=b.parent();!d.is(".root");)d=d.parent(),c.push(d),d=d.parent();var e=this;if(a.each(c,function(a){a.is(".open")||(a.addClass("open"),e.trigger("open",e._getItemData(a)))}),!b.is(".open")&&!b.is(".is-leaf")){A.call(this,b);var f=this._getItemData(b);if(this.lastLoadApi&&!b.is(".is-loaded")&&0==b.children("ul").children().length){var h={pid:x.call(this,b),p_no:1};h=a.extend(this.lastLoadParams,h),g.call(this,b,this.lastLoadApi,h,function(a,b){e.trigger("loaded",a,b,f)})}this.trigger("open",f)}},i=function(a){a.is(".open")&&(B.call(this,a),this.trigger("close",this._getItemData(a)))},j=function(a){var b=$(a.currentTarget);if(b.is(".active")||(this.$el.find(".tree-node.active").removeClass("active"),b.addClass("active"),this.trigger("itemclick",this._getItemData(b.parent()))),this.isRenderAsApp()){var c=b.parent();c.is(".open")?i.call(this,c):h.call(this,c)}},k=function(a){var b=$(a.currentTarget).parent().parent();return b.is(".open")?i.call(this,b):h.call(this,b),!1},l=function(a){var b=$(a.currentTarget).parent().parent();return n.call(this,b,!b.is(".selected")),!1},m=function(b){var c=$(b.currentTarget).parent(),d={p_no:parseInt(c.attr("page-no"))+1},e=c.parent();e.is(".root")?d.pid=null:(e=e.parent(),d.pid=x.call(this,e)),d=a.extend(this.lastLoadParams,d);var f=this,h=this._getItemData(e);g.call(this,e,this.lastLoadApi,d,function(a,b){f.trigger("loaded",a,b,h)})},n=function(a,b){var c=this.isMultiple();if(b){if(a.is(".selected"))return;if(c||(this.$el.find("li.selected").removeClass("selected"),this.$el.find("li.selected_").removeClass("selected_")),a.addClass("selected").removeClass("selected_"),c)o(a,!0),p(a);else for(;;){var d=a.parent();if(d.is(".root"))break;a=d.parent(),a.addClass("selected_")}}else{if(a.is(".selected"))a.removeClass("selected");else{if(!a.is(".selected_"))return;a.removeClass(".selected_")}c&&o(a,!1),p(a)}},o=function(b,c){a.each(b.children("ul").children(),function(a){a.is(".more,.loading")||(a.removeClass("selected_"),c?a.addClass("selected"):a.removeClass("selected"),o(a,c))})},p=function(b){var c=b.parent();if(!c.is(".root")){var d=!1,e=!0;a.each(c.children(),function(a){a.is(".more,.loading")||(a.is(".selected")?d=!0:a.is(".selected_")?(d=!0,e=!1):e=!1)});var f=c.parent();f.removeClass("selected").removeClass("selected_"),e?f.addClass("selected"):d&&f.addClass("selected_"),p(f)}},q=function(b,d,e,f){e=a.getIndexValue(e);var g=this._getNewItem($,b,d,f);e>=0&&e<b.children().length-1&&b.children().eq(e).before(g);var h=parseInt(b.attr("level"));if(c.renderOneNode.call(this,$,g,d,f,h),!b.is(".root")){var i=b.parent().removeClass("is-leaf");this.isChkboxVisible()&&this.isMultiple()&&i.is(".selected")&&g.addClass("selected")}var j=null;if(b.is(".root"))j=this.getData();else if(j=this._getItemData(b.parent())){var k=this.getChildrenField()||"children";a.isArray(j[k])||(j[k]=[]),j=j[k]}a.isArray(j)&&(e>=0&&e<j.length?j.splice(e,0,d):j.push(d))},r=function(b,d){var e=b.parent(),f=w.call(this,b,!0);b.children(".tree-node .lbl").empty();var g=parseInt(e.attr("level"));c.renderOneNode.call(this,$,b,d,f,g);var h=null;h=e.is(".root")?this.getData():this._getItemData(e.parent());var i=b.index();if(a.isArray(h)&&i<h.length){var j=this.getChildrenField()||"children";a.isArray(d[j])||(d[j]=h[i][j]),h.splice(i,1,d)}},s=function(b){B.call(this,b);var c=b.parent(),d=b.index();if(c.is(".root")){var e=this.getData();e&&d<e.length&&e.splice(d,1)}else{var f=this._getItemData(c.parent()),g=this.getChildrenField()||"children";a.isArray(f[g])&&d<f[g].length&&f[g].splice(d,1)}var h=this;setTimeout(function(){if(b.remove(),!c.is(".root")){b=c.parent();var a=c.children();a.length>0?p.call(h,a.eq(0)):(c.remove(),b.is(".selected_")&&(b.removeClass("selected_"),p.call(h,b)))}},220)},t=function(b,c){if((b=a.getIndexValue(b))<0)return null;var d=null;return z.call(this,function(a,e){return b==e?(d=a,!1):!c&&!a.is(".open")||void 0}),d},u=function(b,c){if(a.isBlank(b))return null;var d=this,e=null;return z.call(this,function(a){var f=x.call(d,a);return b==f?(e=a,!1):!c&&!a.is(".open")||void 0}),e},v=function(a,b){var c=this,d=null,e=this._getDataId(a);return z.call(this,function(f){var g=c._getItemData(f),h=a==g;if(!h){h=c._getDataId(g)==e}return h?(d=f,!1):!b&&!f.is(".open")||void 0}),d},w=function(a,b){var c=-1;return a&&a.length>0&&z.call(this,function(d,e){return d.is(a)?(c=e,!1):!b&&!d.is(".open")||void 0}),c},x=function(a){return this._getDataId(this._getItemData(a))},y=function(b){var c=b.children(".tree-node").data("itemData");if(a.isBlank(c)){var d=0,e=w.call(this,b,!0),f=this.getChildrenField()||"children",g=function(b){for(var c=0,h=b.length;c<h;c++){var i=b[c];if(d==e)return i;if(d+=1,a.isArray(i[f])&&(i=g(i[f])))return i}};c=g(this.getData())}return c},z=function(a){var b=0,c=function(d){for(var e=parseInt(d.attr("level"))||0,f=d.children(),g=0,h=f.length;g<h;g++){var i=f.eq(g);if(!i.is(".more,.loading")){var j=a(i,b,e);if(b+=1,!1===j)return!0;if(!0!==j&&(j=c(i.children("ul"))))return!0}}};c(this._getItemContainer())},A=function(a){a.addClass("open");var b=a.children("ul");b&&b.length>0&&(b.addClass("animate-in"),setTimeout(function(){b.height(b.get(0).scrollHeight),setTimeout(function(){b.removeClass("animate-in").css("height","")},200)},0))},B=function(a){var b=a.children("ul");b&&b.length>0?(b.height(b.get(0).offsetHeight),b.addClass("animate-out"),setTimeout(function(){b.height(1),setTimeout(function(){b.removeClass("animate-out").css("height",""),a.removeClass("open")},200)},0)):a.removeClass("open")};b.register(".ui-treeview",d)}}(),function(a){if(a||!VRender.Component.Render.datagrid){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").ListRenderer:VRender.Component.Render._list,d={date:"yyyy-MM-dd",datetime:"yyyy-MM-dd HH:mm:ss",time:"HH:mm:ss"},e={asc:"/VRender/icons/020c.png",desc:"/VRender/icons/021c.png"},f=function(a,b){c.call(this,a,b)},g=f.prototype=new c;f.rowRenderer=function(a,b,c,d,e){o.call(this,a,b,this.__columns,c,d,e)},f.rowRenderer._state=1,g.render=function(a,d){d.addClass("ui-datagrid");var e=b.getFormatSize(this.options.height,this.isRenderAsRem());e&&d.attr("opt-fixed","1").css("height",e),this.isChkboxVisible()&&d.attr("opt-chk","1");var f=parseInt(this.options.expandcols);f&&d.attr("opt-expcols",f);var g=a("<div class='table'></div>").appendTo(d);g.append("<header><div></div></header>"),g.append("<section><div><table><thead></thead><tbody></tbody></table></div></section>");var i=this.__columns=this.getColumns();return c.render.call(this,a,d),h.call(this,a,d,i),t.call(this,a,d,i),q.call(this,a,d),r.call(this,a,d),s.call(this,a,d),this.renderComplete=!0,this},g._getItemContainer=function(a,b){return b=b.children(".table").children("section").children(),b.children("table").children("tbody")},g._getNewItem=function(a,b,c,d){return a("<tr></tr>").appendTo(b)},g._renderItems=function(a,c){var d=this.getData(),e=!1,f=null,g=[].concat(d);if(d&&d.length>0){var h=this;b.each(this.__columns,function(a){if(b.isTrue(a.filter)&&b.isNotBlank(a.filterValue)){var c=h._getFilterFunction(a,a.filterValue);g=b.filter(g,function(b,d){return c(a,b,a.filterValue)}),e=!0}});var i=b.find(this.__columns,function(a){return b.isTrue(a.sortable)&&a.sortType});if(i){var j=this._getSortFunction(i,i.sortType);g.sort(function(a,b){return j(i,a,b,i.sortType)}),e=!0}}e&&(f=b.map(g,function(a){return b.index(d,function(b){return b==a})})),this._renderDatas=g,n.call(this,a,c,g,f)},g.getItemRenderer=function(){return f.rowRenderer},g._getSortFunction=function(a,b){return z.call(this,a,b)},g._getFilterFunction=function(a,b){return A.call(this,a,b)},g._hasExpand=function(){return b.index(this.__columns,function(a){return!!a.expand})>=0},g.getColumns=function(){return v(this.options.columns)},g.isChkboxVisible=function(){return b.isTrue(this.options.chkbox)},g.isHeaderVisible=function(){return!!b.isBlank(this.options.showHeader)||b.isTrue(this.options.showHeader)},g.getPaginator=function(){return this.options.paginator||this.options.pager},g.getHeadRenderer=function(){return this.options.headRenderer},g.getColumnRenderer=function(){return this.options.columnRenderer||this.options.renderer},g.getExpandRenderer=function(){return this.options.expandRenderer},g.getRowStyleFunction=function(){return this.options.rowStyleFunction},g.getCellStyleFunction=function(){return this.options.cellStyleFunction};var h=function(c,d,e){if(this.isHeaderVisible()){var f=this.isRenderAsApp();d=d.removeClass("no-head").children(".table");var g=d.children("section").children().children("table").children("thead").empty();row=c("<tr></tr>").appendTo(g),this.isAllSelected(this._renderDatas||[])&&row.addClass("selected"),this._hasExpand()&&!f&&row.append("<th class='col-exp'></th>"),this.isChkboxVisible()&&row.append("<th class='col-chk'><span class='chkbox'></span></th>");var h=this;b.each(e,function(a,d){if(!a.expand){var e=c("<th></th>").appendTo(row);e.addClass("col-"+d),b.isNotBlank(a.name)&&e.attr("col-name",a.name),b.isNotBlank(a.dataType)&&e.attr("col-type",a.dataType);var f=b.getFormatSize(a.width,h.isRenderAsRem());f&&e.css("width",f),i.call(h,c,e,a,d),j.call(h,c,e,a,d)}}),this._hasExpand()&&f&&row.append("<th class='col-exp'></th>");var k=d.children("header").children().empty();a?k.write("<table><thead>"+g.html()+"</thead></table>"):k.html("<table><thead>"+g.html()+"</thead></table>"),row.find(".dropdown").remove()}else d.addClass("no-head")},i=function(c,d,e,f){if(!e.html){var g=this.getHeadRenderer();if(b.isFunction(g)){var h=g(e,f);if(h)return void(a&&b.isFunction(h.render)?h.render(d):d.append(h.$el||h))}}e.icon&&c("<i>&nbsp;</i>").appendTo(d).css("backgroundImage","url("+e.icon+")");var i=c("<div class='title'></div>").appendTo(d);e.html?i.html(e.html):i.text(e.title||e.name||"列 "+(f+1))},j=function(a,b,c,d){if(c.sortable||c.filter){var e=a("<div class=toolbar></div>").appendTo(b);c.sortable&&(c.sortType&&b.attr("opt-sort",c.sortType),k.call(this,a,e,c)),c.filter&&(c.filterValue&&b.attr("opt-filter",c.filterValue),l.call(this,a,e,c))}},k=function(a,c,d){var e=a("<div class='sort'><i title='排序'></i></div>").appendTo(c);this.isRenderAsApp()||b.isArray(d.sortable)&&d.sortable.length>0&&m.call(this,a,e,d.sortable,d.sortType,"无")},l=function(a,c,d){var e=a("<div class='filter'><i title='筛选'></i></div>").appendTo(c),f=d.filter;if("enum"==f&&(f=u.call(this,d),f=f&&f.length>0?b.map(f,function(a){return{label:a,value:a}}):[{label:"无选项",value:""}]),!this.isRenderAsApp())if(b.isArray(f))m.call(this,a,e,f,d.filterValue,"空");else{var g=a("<div class='dropdown ipt'></div>").appendTo(e),h=a("<input/>").appendTo(g);d.filterValue&&h.val(d.filterValue)}},m=function(a,c,d,f,g){var h=a("<ul class='dropdown'></ul>").appendTo(c);b.each(d,function(b){var d=a("<li></li>").appendTo(h),i=!1;b.hasOwnProperty("type")&&(d.attr("data-type",b.type),i=b.type==f),b.hasOwnProperty("value")&&(d.attr("data-val",b.value),i=b.value==f);var j=a("<i></i>").appendTo(d),k=b.icon||e[b.type];if(k&&j.css("backgroundImage","url("+k+")"),a("<span></span>").appendTo(d).text(b.label||g),i){d.addClass("selected");var l=c.children("i");k&&l.css("backgroundImage","url("+k+")"),b.label&&l.attr("title",b.label)}})},n=function(a,c,d,e,f){var g=this._getItemContainer(a,c).empty(),h=f||this.getSelectedIndex(!0),i=this.getSelectedId(!0)||[],j=this;b.each(d,function(b,c){var d=e?e[c]:c,f=j._getNewItem(a,g,b,d);if(f){var k=j._isSelected(b,c,h,i);j._renderOneItem(a,f,b,d,k)}})},o=function(a,c,d,e,f,g){c.attr("opt-ind",f);var h=this.isRenderAsApp(),i=this.getRowStyleFunction();if(b.isFunction(i)){var j=i(e,f);j&&c.css(j)}this._hasExpand()&&!h&&c.append("<td class='col-exp'><span class='expbtn'></span></td>"),this.isChkboxVisible()&&c.append("<td class='col-chk'><span class='chkbox'></span></td>");var k=this;b.each(d,function(b,d){if(!b.expand){var g=a("<td></td>").appendTo(c);p.call(k,a,g,b,e,f,d)}}),this._hasExpand()&&h&&c.append("<td class='col-exp'><span class='expbtn'></span></td>")},p=function(c,d,e,f,g,h){var i=this.getCellStyleFunction();if(b.isFunction(i)){var j=i(e.name,f,g,h);j&&d.css(j)}d.addClass("col-"+h),b.isNotBlank(e.name)&&d.attr("col-name",e.name);var k=null,l=this.getColumnRenderer();b.isFunction(l)&&(k=l(e.name,f,g,h,e)),b.isNull(k)&&(k=D.call(this,e,f,h)),b.isBlank(k)&&(k="&nbsp;"),a&&b.isFunction(k.render)?k.render(d):d.append(k.$el||k)},q=function(b,d){a&&c.renderPager.call(this,d,this.getPaginator())},r=function(a,b){c.renderEmptyView.call(this,a,b,"datagrid")},s=function(a,b){c.renderLoadView.call(this,a,b,"datagrid")},t=function(d,e,f){if(a){var g=b.map(f,function(a){var c=b.extend({},a);return c.html&&(c.html=escape(c.html)),b.isFunction(c.sortFunction)?c.sortFunction=escape(c.sortFunction):b.isArray(c.sortable)&&b.each(c.sortable,function(a){b.isFunction(a.handler)&&(a.handler=escape(a.handler))}),b.isFunction(c.filterFunction)?c.filterFunction=escape(c.filterFunction):b.isArray(c.filter)&&b.each(c.filter,function(a){b.isFunction(a.handler)&&(a.handler=escape(a.handler))}),c});e.write("<div class='ui-hidden' name='columns' data='"+JSON.stringify(g)+"'></div>"),c.renderFunction(e,"hrender",this.getHeadRenderer()),c.renderFunction(e,"crender",this.getColumnRenderer()),c.renderFunction(e,"erender",this.getExpandRenderer()),c.renderFunction(e,"rstyle",this.getRowStyleFunction()),c.renderFunction(e,"cstyle",this.getCellStyleFunction())}},u=function(a,c){var d=[],e=a&&a.name;return e&&(c=c||this.getData(!0),b.each(c,function(a){var c=a&&a[e];b.index(d,function(a){return a==c})<0&&d.push(c)})),d.sort()},v=function(a){a=b.map(b.toArray(a),w);var c=null,d=!0;return b.each(a,function(a){a.sortType&&(c&&(c.sortType=null),c=a),a.expand||(d=!1)}),d&&a.length>0&&(a[0].expand=!1),a},w=function(a,c){var d={};return b.isNull(a)?d.title="列 "+(c+1):b.isPrimitive(a)?d.name=b.trimToEmpty(a):(d.name=b.trimToEmpty(a.name),d.title=b.trimToNull(a.title),d.html=b.trimToNull(a.focusHtmlTitle),d.icon=b.trimToNull(a.icon),d.width=b.trimToNull(a.width),d.expand=b.isTrue(a.expand),b.isTrue(a.sortable)&&x(d,a),b.isTrue(a.filter)&&y(d,a)),d},x=function(a,c){b.isFunction(c.sortFunction)?a.sortFunction=c.sortFunction:b.isFunction(c.sortable)&&(a.sortFunction=c.sortable),b.isArray(c.sortable)&&c.sortable.length>0?a.sortable=b.map(c.sortable,function(a){return{type:a.type,label:a.label,icon:a.icon,handler:a.handler,custom:a.custom}}):a.sortable="custom"!=c.sortable||"custom",a.sortType=c.sortType?b.trimToNull(c.sortType):null},y=function(a,c){b.isFunction(c.filterFunction)?a.filterFunction=c.filterFunction:b.isFunction(c.filter)&&(a.filterFunction=c.filter),b.isArray(c.filter)&&c.filter.length>0?a.filter=b.map(c.filter,function(a){return{label:a.label,value:a.value,icon:a.icon,handler:a.handler,custom:a.custom}}):a.filter=!/^(custom|enum)$/.test(c.filter)||c.filter,a.filterValue=c.filterValue?b.trimToNull(c.filterValue):null},z=function(a,c){if(a){if(b.isNotNull(c)&&b.isArray(a.sortable)){var d=b.findBy(a.sortable,"type",c);if(d&&b.isFunction(d.handler))return function(a,b,c,e){return d.handler(b,c,e)}}if(b.isFunction(a.sortFunction))return function(b,c,d,e){return a.sortFunction(c,d,e)}}if(b.isFunction(this.options.sortFunction)){var e=this.options.sortFunction;return function(a,b,c,d){return e(b,c,d,a)}}return B},A=function(a,c){if(a){if(b.isNotNull(c)&&b.isArray(a.filter)){var d=b.findBy(a.filter,"value",c);if(d&&b.isFunction(d.handler))return function(a,b,c){return d.handler(b,c)}}if(b.isFunction(a.filterFunction))return function(b,c,d){return a.filterFunction(c,d)}}if(b.isFunction(this.options.filterFunction)){var e=this.options.filterFunction;return function(a,b,c){return e(b,c,a)}}return C},B=function(a,c,d,e){if(a&&a.name&&/^(asc|desc)$/i.test(e)){var f=c?c[a.name]:null,g=d?d[a.name]:null;return function(){if(b.isNull(f))return b.isNull(g)?0:-1;if(b.isNull(g))return b.isNull(f)?0:1;var c=a.dataType;if(/date/i.test(c)){if(f=b.toDate(f),g=b.toDate(g),!f)return g?1:0;if(!g)return f?-1:0;var d=/^date$/i.test(c)?"yyyyMMddHHmmss":"yyyyMMdd";return f=b.toDateString(f,d),g=b.toDateString(g,d),f<g?-1:f>g?1:0}return/num/i.test(c)||!isNaN(f)&&!isNaN(g)?parseFloat(f)-parseFloat(g):f.localeCompare(g)}()*(/^asc$/i.test(e)?1:-1)}return 0},C=function(a,c,d){if(!a&&!a.name)return!0;if(b.isNull(c))return!1;var e=c[a.name];if(e===d)return!0;var f=a.dataType;if(/date/i.test(f)){if(!(d=b.toDate(d)))return!0;if(e=b.toDate(e)){var g=/^date$/i.test(f)?"yyyyMMdd":"yyyyMMddHHmmss";return d=b.toDateString(d,g),e=b.toDateString(e,g),0===e.indexOf(d)}return!1}return b.isNull(e)?b.isNull(d):b.isNull(d)?b.isNull(e):/num/i.test(f)||!isNaN(d)&&!isNaN(e)?parseFloat(d)==parseFloat(e):d==e||(d=b.trimToEmpty(d),e=b.trimToEmpty(e),e.indexOf(d)>=0)},D=function(a,c,e){if(b.isBlank(c))return null;if(b.isBlank(a.name))return""+c;var f=c[a.name];if(a.dataType&&b.isNotBlank(f)){var g=a.dataType;if("localtime"===g)f=b.toLocalDateString(b.toDate(f));else if(/^(date|datetime|time)$/.test(g))(f=b.toDate(f))&&(f=b.toDateString(f,d[g]));else if("money"===g)f=parseFloat(f),isNaN(f)?f=null:(f=f.toFixed(2).split("."),f="<span class='val'>￥<span class='v1'>"+f[0]+"</span>.<span class='v2'>"+f[1]+"</span></span>");else if("number"===g||"num"===g)if(f=parseFloat(f),isNaN(f))f=null;else{var h=parseFloat(a.decimals);(isNaN(h)||h<0)&&(h=0),f=f.toFixed(h)}}return f};a?module.exports=f:(f.dateFormats=d,f.defaultIcons=e,f.getFormatColumns=v,f.getSortFunction=z,f.getFilterFunction=A,f.renderHeader=h,f.renderItems=n,f.renderCell=p,f.getColumnValueSet=u,f.renderToolDropdown=m,VRender.Component.Render.datagrid=f)}}("undefined"==typeof VRender),function(){if(!VRender.Component.Datagrid){var a=VRender.Utils,b=VRender.Component,c=b.Render.datagrid,d=window.UIDatagrid=b.Datagrid=function(a,c){if(this.init(a,c)!==this)return b.get(a);this.__columns=this.getColumns(),this.gridHead=this.$el.children(".table").children("header").children(),this.gridBody=this.$el.children(".table").children("section").children(),this.gridHead.on("tap","th.col-chk",h.bind(this)),this.gridBody.on("tap","tr",f.bind(this)),this.gridBody.on("tap","td.col-exp .expbtn",i.bind(this)),this.isRenderAsApp()?(this.gridHead.on("tap","th",g.bind(this)),this.$el.on("tap",".sort-and-filter",n.bind(this)),this.$el.on("tap",".sort-and-filter .item",o.bind(this)),this.$el.on("tap",".sort-and-filter input",p.bind(this)),this.$el.on("tap",".sort-and-filter .clearbtn",q.bind(this)),this.$el.on("tap",".sort-and-filter .submitbtn",r.bind(this)),this.$el.on("keyup",".sort-and-filter input",s.bind(this))):(this.gridHead.on("tap",".toolbar > *",j.bind(this)),this.gridHead.on("tap",".toolbar .dropdown li",l.bind(this)),this.gridHead.on("mouseenter",".toolbar > *",k.bind(this)),this.gridHead.on("mouseleave",".toolbar > *",k.bind(this))),y.call(this),this.renderComplete=!0},e=d.prototype=new b.list;d.find=function(a){return b.find(a,".ui-datagrid",d)},d.create=function(a){return b.create(a,d,c)},e.getData=function(b){if(b)return this.options.data=this._doAdapter(this.options.data),this.options.data;var c=this.getData(!0);return a.map(this._getItems(),function(a){var b=a.data("itemData");if(!b){var d=parseInt(a.attr("opt-ind"))||0;b=c[d]}return b})},e.setData=function(a){var c=this._snapshoot();this.options.data=this._doAdapter(a),b.list.setSelectedIndex.call(this,[]),this._getItems().removeClass("selected").removeClass("expand"),v.call(this),this._dataChanged("set",this.options.data),c.done([],[])},e.getColumns=function(){if(this.options.hasOwnProperty("columns"))return this.options.columns;var b=function(a){return new Function("var Utils=VRender.Utils;return ("+unescape(a)+");")()},c=this.$el.children("[name='columns']");if(c&&c.length>0)try{c=JSON.parse(c.remove().attr("data")),a.each(c,function(c){c.html&&(c.html=unescape(c.html)),/^function/.test(c.sortable)?c.sortable=b(c.sortable):a.isArray(c.sortable)&&a.each(c.sortable,function(a){/^function/.test(a.handler)&&(a.handler=b(a.handler))}),/^function/.test(c.sortFunction)&&(c.sortFunction=b(c.sortFunction)),/^function/.test(c.filter)?c.filter=b(c.filter):a.isArray(c.filter)&&a.each(c.filter,function(a){/^function/.test(a.handler)&&(a.handler=b(a.handler))}),/^function/.test(c.filterFunction)&&(c.filterFunction=b(c.filterFunction))})}catch(a){c=[]}else c=[];return this.options.columns=c,this.options.columns},e.setColumns=function(b){this.options.columns=c.getFormatColumns(b);var d=this.__columns=this.options.columns;if(this.currentSort&&this.currentSort.name){var e=a.findBy(d,"name",this.currentSort.name);e&&a.isTrue(e.sortable)&&e.sortType==this.currentSort.type?this.currentSort.column=e:this.currentSort=null}this.currentFilters&&a.remove(this.currentFilters,function(b){if(b.name){var c=a.findBy(d,"name",b.name);if(!c)return!0;b.column=c}}),t.call(this)},e.isHeaderVisible=function(){return!this.$el.is(".no-head")},e.setHeaderVisible=function(b){a.isNull(b)||a.isTrue(b)?this.isHeaderVisible()||(this.$el.removeClass("no-head"),u.call(this)):this.isHeaderVisible()&&(this.$el.addClass("no-head"),u.call(this))},e.isChkboxVisible=function(){return"1"==this.$el.attr("opt-chk")},e.setChkboxVisible=function(b){a.isNull(b)||a.isTrue(b)?this.isChkboxVisible()||(this.$el.attr("opt-chk","1"),t.call(this)):this.isChkboxVisible()&&(this.$el.removeAttr("opt-chk"),t.call(this))},e.getPaginator=function(){return b.list.getPager.call(this)},e.setPaginator=function(a){b.list.setPager.call(this,a)},e.getItemRenderer=function(){return c.rowRenderer},e.setItemRenderer=function(a){},e.getHeadRenderer=function(){return b.list.getFunction.call(this,"headRenderer","hrender")},e.setHeadRenderer=function(a){var b=this.getHeadRenderer()!=a;this.options.headRenderer=a,b&&u.call(this)},e.getColumnRenderer=function(){return this.options.hasOwnProperty("renderer")?this.options.renderer:b.list.getFunction.call(this,"columnRenderer","crender")},e.setColumnRenderer=function(a){var b=this.getColumnRenderer()!=a;this.options.columnRenderer=a,delete this.options.renderer,
b&&v.call(this)},e.getExpandRenderer=function(){return b.list.getFunction.call(this,"expandRenderer","erender")},e.setExpandRenderer=function(a){var b=this.getExpandRenderer()!=a;if(this.options.expandRenderer=a,b){var c=this._getItemContainer();c.children(".row-expand").remove();c.children(".expand").removeClass("expand").children(".col-exp").children(".expbtn").trigger("tap")}},e.getExpandColspan=function(){return parseInt(this.$el.attr("opt-expcols"))||0},e.setExpandColsapn=function(a){if(!isNaN(a)&&(a||0===a)&&(a=parseInt(a),!isNaN(a)&&a>0&&this.getExpandColspan()!=a)){this.$el.attr("opt-expcols",a);var b=this._getItemContainer();b.children(".row-expand").remove();b.children(".expand").removeClass("expand").children(".col-exp").children(".expbtn").trigger("tap")}},e.getRowStyleFunction=function(){return b.list.getFunction.call(this,"rowStyleFunction","rstyle")},e.setRowStyleFunction=function(a){var b=this.getRowStyleFunction()!=a;this.options.rowStyleFunction=a,b&&v.call(this)},e.getCellStyleFunction=function(){return b.list.getFunction.call(this,"cellStyleFunction","cstyle")},e.setCellStyleFunction=function(){var a=this.getCellStyleFunction()!=value;this.options.cellStyleFunction=value,a&&v.call(this)},e.sort=function(b,c,d){a.isFunction(b)&&(d=b,b=c=null),a.isFunction(c)&&(d=c,c=null),b&&(b=N.call(this,""+b)),z.call(this,b,c,d)},e.filter=function(b,c,d){a.isFunction(b)&&(d=b,b=c=null),a.isFunction(c)&&(d=c,c=null),b&&(b=N.call(this,""+b)),A.call(this,b,c,d)},e.addItem=function(c,d){if(!a.isNull(c)){d=a.getIndexValue(d);var e=this.getData(!0);c=b.list.doAdapter.call(this,c,d),d>=0&&d<e.length?(e.splice(d,0,c),a.each(this._getItems(),function(a){var b=parseInt(a.attr("opt-ind"))||0;b>=d&&a.attr("opt-ind",b+1)})):e.push(c);var f=this._snapshoot();v.call(this),this._dataChanged("add",c,this.getDataIndex(c)),f.done()}},e.updateItem=function(c,d){if(!a.isNull(c)){var e=this.getData(!0);if(d||0===d?(d=a.getIndexValue(d),c=b.list.doAdapter.call(this,c,d)):(c=b.list.doAdapter.call(this,c),d=this.getDataRealIndex(c,e)),d>=0){e.splice(d,1,c);var f=this._snapshoot();v.call(this),this._dataChanged("update",c,d),f.done()}}},e.removeItem=function(b){a.isNotNull(b)&&this.removeItemAt(this.getDataRealIndex(b))},e.removeItemAt=function(b){if((b=a.getIndexValue(b))>=0){var c=this.getData(!0);if(b<c.length){var d=c.splice(b,1);a.each(this._getItems(),function(a){var c=parseInt(a.attr("opt-ind"))||0;c>=b&&a.attr("opt-ind",c-1)});var e=this._snapshoot();v.call(this),this._dataChanged("delete",d,b),e.done()}}},e.addOrUpdateItem=function(a){var b=this.getDataRealIndex(a);b>=0?this.updateItem(a,b):this.addItem(a,b)},e.getDataRealIndex=function(b,c){var c=c||this.getData(!0);if(c&&c.length>0){var d=this,e=this._getDataId(b);return a.index(c,function(a){return a==b||d._getDataId(a)==e})}return-1},e._getItemContainer=function(){if(!this.itemContainer){var a=this.$el.children(".table").children("section").children();this.itemContainer=a.children("table").children("tbody")}return this.itemContainer},e._getNewItem=function(a,b,c,d){return a("<tr></tr>").appendTo(b)},e._getSortFunction=function(a,b){return c.getSortFunction.call(this,a,b)},e._getFilterFunction=function(a,b){return c.getFilterFunction.call(this,a,b)},e._hasExpand=function(){return a.index(this.__columns,function(a){return!!a.expand})>=0};var f=function(a){var b=$(a.currentTarget);if(b.parent().is(this._getItemContainer())){if(b.is(".disabled"))return;b.is(".selected")?b.removeClass("selected"):(b.addClass("selected"),this.isMultiple()||b.siblings().removeClass("selected")),M.call(this)}},g=function(b){var c=$(b.currentTarget),d=c.attr("col-name"),e=d&&N.call(this,d);if(e)if(e.filter||a.isArray(e.sortable))F.call(this,e,c);else if(e.sortable){var f=c.attr("opt-sort");f="desc"==f?null:"asc"==f?"desc":"asc",z.call(this,e,f)}},h=function(a){var b=this.gridHead.find("tr"),c=[];if(b.is(".selected"))b.removeClass("selected");else{b.addClass("selected");for(var d=0,e=this.length();d<e;d++)c.push(d)}this.setSelectedIndex(c)},i=function(a){var b=$(a.currentTarget).parent().parent();if(b.parent().is(this._getItemContainer())){if(b.is(".disabled"))return!1;if(b.is(".expand"))b.removeClass("expand"),b.next().remove();else{b.addClass("expand");var c=parseInt(b.attr("opt-ind"))||0,d=this._getItemData(b,c);w.call(this,$,b,d,c)}return!1}},j=function(a){var b=$(a.currentTarget),c=b.parent().parent(),d=N.call(this,c.attr("col-name")),e=b.children(".dropdown");if(e&&e.length>0){if(b.addClass("show-dropdown"),e.is(".ipt")){var f=e.find("input").focus();f.off("keydown").on("keydown",m.bind(this))}}else if(b.is(".sort")){var g=c.attr("opt-sort");g="desc"==g?null:"asc"==g?"desc":"asc",z.call(this,d,g)}else b.is(".filter")},k=function(a){var b=$(a.currentTarget),c=parseInt(b.attr("opt-t"))||0;c&&(clearTimeout(c),b.removeAttr("opt-t")),"mouseleave"==a.type&&(c=setTimeout(function(){if(b.removeClass("show-dropdown"),b.removeAttr("opt-t"),b.is(".filter")){var a=b.find("input");a&&a.length>0&&VRender.onInputChange(a,null)}},400),b.attr("opt-t",c))},l=function(a){var b=$(a.currentTarget),c=b.parent().parent(),d=c.parent().parent(),e=N.call(this,d.attr("col-name")),f=parseInt(c.attr("opt-t"))||0;return f&&clearTimeout(f),c.removeClass("show-dropdown").removeAttr("opt-t"),c.is(".sort")?z.call(this,e,b.is(".selected")?null:b.attr("data-type")):c.is(".filter")&&A.call(this,e,b.is(".selected")?null:b.attr("data-val")),!1},m=function(b){if(13==b.which){var c=$(b.currentTarget),d=a.parentUntil(c,"th").attr("col-name");if(d){var e=N.call(this,d);A.call(this,e,c.val()||null)}}},n=function(a){if($(a.target).is(".sort-and-filter"))return I.call(this),!1},o=function(a){var b=$(a.currentTarget),c=this.$el.children(".sort-and-filter").data("column");if(b.parent().parent().is(".sort")){var d=b.is(".selected")?null:b.attr("data-type");z.call(this,c,d)}else{var e=b.is(".selected")?null:b.attr("data-val");A.call(this,c,e)}I.call(this)},p=function(a){this.$el.children(".sort-and-filter").addClass("inputing")},q=function(a){var b=this.$el.children(".sort-and-filter").find("input").val("");setTimeout(function(){b.focus()},0)},r=function(a){var b=this.$el.children(".sort-and-filter"),c=b.data("column"),d=b.find("input").val()||null;A.call(this,c,d),I.call(this)},s=function(a){13==a.which&&this.$el.children(".sort-and-filter").find(".submitbtn").tap()},t=function(){this.t_rerender&&(clearTimeout(this.t_rerender),this.t_rerender=0),this.t_rerenderheader&&(clearTimeout(this.t_rerenderheader),this.t_rerenderheader=0),this.t_rerenderitems&&(clearTimeout(this.t_rerenderitems),this.t_rerenderitems=0);var a=this;this.t_rerender=setTimeout(function(){a.t_rerender=0,c.renderHeader.call(a,$,a.$el,a.__columns),B.call(a,!0)},0)},u=function(){if(!this.t_rerender){this.t_rerenderheader&&(clearTimeout(this.t_rerenderheader),this.t_rerenderheader=0);var a=this;this.t_rerenderheader=setTimeout(function(){a.t_rerenderheader=0,c.renderHeader.call(a,$,a.$el,a.__columns)},0)}},v=function(){if(!this.t_rerender){this.t_rerenderitems&&(clearTimeout(this.t_rerenderitems),this.t_rerenderitems=0);var a=this;this.t_rerenderitems=setTimeout(function(){a.t_rerenderitems=0,B.call(a,!0),x.call(a)},0)}},w=function(b,d,e,f){var g=b("<tr class='row-expand'></tr>").insertAfter(d),h=b("<td></td>").appendTo(g);h.attr("colspan",d.children().length);var i=b("<div class='container'></div>").appendTo(h),j=this.getExpandRenderer();if(a.isFunction(j)){var k=j(e,f);a.isNotNull(k)&&i.append(k.$el||k)}else{var l=this,k=b("<div class='datagrid-expand'></div>").appendTo(i);k.attr("cols",this.getExpandColspan()),a.each(this.__columns,function(d,g){if(a.isTrue(d.expand)){var h=b("<div></div>").appendTo(k);h.addClass("col-"+g).attr("col-name",d.name),h=b("<dl></dl>").appendTo(h),b("<dt></dt>").appendTo(h).text(d.title||d.name||"");var i=b("<dd></dd>").appendTo(h);c.renderCell.call(l,b,i,d,e,f,g),h.removeClass("col-"+g).removeAttr("col-name")}})}},x=function(){if(!this.isRenderAsApp()){var b=this;a.each(E.call(this),function(d){if(d.attr("col-name")){var e=N.call(b,d.attr("col-name"));if(e&&"enum"==e.filter){var f=d.find(".toolbar .filter"),g=c.getColumnValueSet.call(b,e),h=d.attr("opt-filter");g=g&&g.length>0?a.map(g,function(a){return{label:a,value:a}}):[{label:"无选项",value:""}],f.children(".dropdown").remove(),c.renderToolDropdown.call(b,$,f,g,h,"空")}}})}},y=function(){this.$el.children("[name='irender']").remove(),J.call(this)},z=function(b,d,e){var f=E.call(this);f.removeAttr("opt-sort"),f.find(".sort > i").css("backgroundImage",""),f.find(".sort .dropdown li").removeClass("selected");var g=b&&"custom"==b.sortable;if(b&&b.name&&a.isNotNull(d)){var h=f.filter("[col-name='"+b.name+"']");if(h&&h.length>0){h.attr("opt-sort",d);var i=c.defaultIcons[d];if(a.isArray(b.sortable)){this.isRenderAsApp()||h.find(".sort li[data-type='"+d+"']").addClass("selected");var j=a.findBy(b.sortable,"type",d)||{};i=j.icon||i,g=a.isTrue(j.custom)}i&&h.find(".sort > i").css("backgroundImage","url("+i+")")}}if(this.currentSort={column:b,type:d,fn:e,name:b&&b.name},a.isFunction(e)){var k=e;this.currentSort.fn=function(a,b,c,d){return k(b,c,d,a)}}else a.isNotNull(d)&&!g&&(this.currentSort.fn=this._getSortFunction(b,d));!a.isFunction(this.currentSort.fn)&&g||B.call(this),this.trigger("sort",b&&b.name,d)},A=function(b,c,d){var e=b&&"custom"==b.filter,f=a.isNull(c)||!1===c;if(b&&b.name){var g=E.call(this),h=g.filter("[col-name='"+b.name+"']");if(h&&h.length>0&&(h.removeAttr("opt-filter"),h.find(".filter > i").css("backgroundImage",""),h.find(".filter li").removeClass("selected"),(!f||a.isFunction(d))&&(h.attr("opt-filter",!!f||c),this.isRenderAsApp()||(h.find(".filter .dropdown").is(".ipt")?h.find(".filter input").val(f?"":c):f||h.find(".filter li[data-val='"+c+"']").addClass("selected")),a.isArray(b.filter)))){var i=a.findBy(b.filter,"value",c)||{};i.icon&&h.find(".filter > i").css("backgroundImage","url("+i.icon+")"),e=a.isTrue(i.custom)}}if(a.isFunction(d)){var j=d;d=function(a,b,c){return j(b,c,a)}}else f||e||(d=this._getFilterFunction(b,c));var k=b&&b.name||"";if(this.currentFilters)if(!f||a.isFunction(d)){var l=a.findBy(this.currentFilters,"name",k);l||(l={name:k,column:b},this.currentFilters.push(l)),l.value=c,l.fn=d}else a.removeBy(this.currentFilters,"name",k);e||B.call(this,!0),this.trigger("filter",k,c)},B=function(d){var e=this.getData(!0);if(d||!this.lastFilterDatas){var f=[].concat(e);f&&f.length>0&&(this.currentFilters||D.call(this),a.each(this.currentFilters,function(b){f=a.filter(f,function(a){return b.fn(b.column,a,b.value)})})),this.lastFilterDatas=f}if(f=this.lastFilterDatas,this.currentSort||C.call(this),this.currentSort&&a.isFunction(this.currentSort.fn)){var g=this.currentSort;f=f.slice(0).sort(function(a,b){return g.fn(g.column,a,b,g.type)})}var h=a.map(f,function(b){return a.index(e,function(a){return a==b})}),i=[],j=[];a.each(this._getItems(),function(b){if(b.is(".selected")){var c=parseInt(b.attr("opt-ind"))||0,d=e&&e[c];d&&(c=a.index(f,function(a){return a==d}))>=0&&i.push(c)}b.is(".expand")&&j.push(b.attr("opt-ind"))}),c.renderItems.call(this,$,this.$el,f,h,i),M.call(this),d&&b.list.checkIfEmpty.call(this),j.length>0&&a.each(this._getItems(),function(a){j.indexOf(a.attr("opt-ind"))>=0&&a.children(".col-exp").children(".expbtn").trigger("tap")})},C=function(){var b=a.find(E.call(this),function(a){return!!a.attr("opt-sort")});if(this.currentSort=null,b&&b.length>0){var c=b.attr("col-name"),d=b.attr("opt-sort"),e=N.call(this,c),f=this._getSortFunction(e,d);this.currentSort={name:c,column:e,type:d,fn:f}}},D=function(){var b=this.currentFilters=[],c=this;a.each(E.call(this),function(d){var e=d.attr("col-name"),f=d.attr("opt-filter");if(e&&a.isNotNull(f)&&!1!==f){var g=N.call(c,e),h=c._getFilterFunction(g,f);b.push({name:e,column:g,value:f,fn:h})}})},E=function(){return this.gridHead.children("table").children("thead").children("tr").children("th")},F=function(b,c){$("body").addClass("ui-scrollless");var d=$("<div class='sort-and-filter'></div>").appendTo(this.$el),e=$("<div class='container'></div>").appendTo(d);d.data("column",b);var f=a.isTrue(b.sortable),g=a.isTrue(b.filter);f&&G.call(this,e,b,c.attr("opt-sort")),g&&H.call(this,e,b,c.attr("opt-filter")),f||!g||"enum"==b.filter||a.isArray(b.filter)||(d.addClass("inputing"),d.find(".filter").focus()),setTimeout(function(){d.addClass("show")},0)},G=function(b,d,e){var f=$("<div class='sort'></div>").appendTo(b);f.append("<div class='title'>排序</div>");var g=d.sortable;a.isArray(g)||(g=[{label:"升序",type:"asc"},{label:"降序",type:"desc"}]);var h=$("<div class='content'></div>").appendTo(f);a.each(g,function(a){var b=$("<div class='item'></div>").appendTo(h);b.attr("data-type",a.type);var d=$("<i></i>").appendTo(b),f=a.icon||c.defaultIcons[a.type];f&&d.css("backgroundImage","url("+f+")"),$("<span></span>").appendTo(b).text(a.label||"无"),a.type==e&&b.addClass("selected")})},H=function(b,d,e){var f=$("<div class='filter'></div>").appendTo(b);f.append("<div class='title'>筛选</div>");var g=d.filter;"enum"==d.filter&&(g=c.getColumnValueSet.call(this,d),g=g&&g.length>0?a.map(g,function(a){return{label:a,value:a}}):[{label:"无选项",value:""}]);var h=$("<div class='content'></div>").appendTo(f);if(a.isArray(g))a.each(g,function(a){var b=$("<div class='item'></div>").appendTo(h);b.attr("data-val",a.value);var c=$("<i></i>").appendTo(b);a.icon&&c.css("backgroundImage","url("+a.icon+")"),$("<span></span>").appendTo(b).text(a.label||"空"),a.value==e&&b.addClass("selected")});else{var i=$("<div class='filterinput'></div>").appendTo(h);i.append("<input placeholder='请输入文本'/>"),i.append("<div class='clearbtn'></div>"),i.append("<div class='submitbtn'>确定</div>"),e&&i.children("input").val(e)}},I=function(){$("body").removeClass("ui-scrollless");var a=this.$el.children(".sort-and-filter");a.removeClass("show").removeClass("inputing"),setTimeout(function(){a.remove()},500)},J=function(){this.t_layout&&(clearTimeout(this.t_layout),this.t_layout=0);var a=this;this.t_layout=setTimeout(function(){a.t_layout=0,a._isMounted()&&(K.call(a),L.call(a),J.call(a))},50)},K=function(){if(this.isHeaderVisible()){var b=E.call(this),c=this.gridBody.children("table").children("thead").children("tr").children("th");a.each(c,function(a,c){var d=b.eq(c);if(a.is(".is-expand"))d.addClass("is-expand");else{var e=a.width();e!=parseInt(d.attr("opt-w"))&&d.attr("opt-w",e).width(e)}})}},L=function(){},M=function(){var c=this._snapshoot(),d=a.map(this._getItems(".selected"),function(a){return a.index()});if(b.list.setSelectedIndex.call(this,d),this.isMultiple()){var e=this.gridHead.find("tr");this.isAllSelected()?e.addClass("selected"):e.removeClass("selected")}c.done()},N=function(b){return a.findBy(this.__columns,"name",b)};b.register(".ui-datagrid",d)}}(),function(a){if(a||!VRender.Component.Render.dialog){var b=a?require(__vrender__).Utils:VRender.Utils,c=a?require("./_base").BaseRenderer:VRender.Component.Render._base,d=a?require("../../../ui/component/UIButton"):VRender.Component.Button,e=[{name:"cancel",label:"取消",type:"cancel"},{name:"ok",label:"确定",type:"primary"}],f=function(a,b){c.call(this,a,b)},g=f.prototype=new c;g.render=function(a,d){d.addClass("ui-dialog").css("display","none"),d.attr("opt-trans","translate"),c.render.call(this,a,d),/^small|big|auto$/.test(this.options.size)&&d.attr("opt-size",this.options.size),b.isTrue(this.options.fill)&&d.attr("opt-fill","1"),this.options.openbtn&&d.attr("opt-active",this.options.openbtn);var e=a("<div class='dialog-container'></div>").appendTo(d),f=a("<div class='dialog-view'></div>").appendTo(e);h.call(this,a,d,f),i.call(this,a,d,f),j.call(this,a,d,f)},g.getTitle=function(){var a=this.options.title;return b.isNull(a)?"标题":b.isBlank(a)?"&nbsp;":a};var h=function(a,b,c){var d=a("<header></header>").appendTo(c);a("<div class='title'></div>").appendTo(d).html(this.getTitle()),d.append("<button class='closebtn'>x</button>")},i=function(a,b,c){c.append("<section></section>");var d=this.options.content||this.options.view;k.call(this,a,b,d)},j=function(a,b,c){c.append("<footer></footer>"),l.call(this,a,b,this.options.buttons)},k=function(a,c,d){var e=c.find(".dialog-view").children("section").empty();e=a("<div class='container'></div>").appendTo(e),b.isNotBlank(d)&&(b.isFunction(d.render)?d.render(e):d.$el?d.$el.appendTo(e):e.append(d))},l=function(c,f,g){f.removeClass("has-btns");var h=f.find(".dialog-view").children("footer");if(h.children(".btnbar").remove(),(g=b.toArray(g||e))&&g.length>0){f.addClass("has-btns");var i=c("<div class='btnbar'></div>").appendTo(h);i.attr("opt-len",g.length),b.each(g,function(e){var f=c("<div class='btn'></div>").appendTo(i);f.attr("name",e.name),!0===e.waitclose?f.attr("opt-wait","-1"):!e.waitclose&&0!==e.waitclose||isNaN(e.waitclose)||f.attr("opt-wait",Math.max(0,parseInt(e.waitclose))),a?new d(this.context,e).render(f):d.create(b.extend({},e,{target:f}))})}};a?module.exports=f:(f.renderContentView=k,f.renderFootButtons=l,VRender.Component.Render.dialog=f)}}("undefined"==typeof VRender),function(){if(!VRender.Component.Dialog){var a=VRender.Utils,b=VRender.Component,c=b.Render.dialog,d=[],e=window.UIDialog=b.Dialog=function(a,c){if(this.init(a,c)!==this)return b.get(a);var d=this.dialogView=this.$el.children().children();d.children("header").on("tap",".closebtn",g.bind(this)),d.children("footer").on("tap",".btnbar > .btn",h.bind(this));var e=this.$el.attr("opt-active");e&&(this.$el.removeAttr("opt-active"),(e=this.activeBtn=$(e))&&e.length>0&&e.on("tap",i.bind(this))),this.isRenderAsApp()?(this.$el.on("tap",k.bind(this)),j.call(this)):this.$el.is("[opt-size='auto']")&&($(window).on("resize",j.bind(this)),j.call(this)),l.call(this)},f=e.prototype=new b.base;e.find=function(a){return b.find(a,".ui-dialog",e)},e.create=function(a){if(a=a||{},!a.target){var d=$("body").children(".ui-dialog-wrap");d&&d.length>0||(d=$("<div class='ui-dialog-wrap'></div>").appendTo($("body"))),a.target=d}return b.create(a,e,c)},e.close=function(c,d,f){if(c.is(".ui-dialog")||(c=a.parentUntil(c,".ui-dialog")),c&&c.length>0){var g=b.get(c);g&&g instanceof e&&g.close(d,f)}},f.setTitle=function(b){b=a.isBlank(b)?"&nbsp;":b,this.$el.find(".dialog-view > header > .title").html(b)},f.setContent=function(a){c.renderContentView.call(this,$,this.$el,a),l.call(this)},f.setButtons=function(a){c.renderFootButtons.call(this,$,this.$el,a)},f.open=function(){if(this.isopened)return this;this.isopened=!0;var a=$("body").addClass("ui-scrollless");0==a.children(".ui-dialog-mask").length&&a.append("<div class='ui-dialog-mask'></div>"),this.$el.css("display","").addClass("show-dialog"),d.push(this),this._getContentView().trigger("dialog_open");var b=this.$el.attr("opt-trans");if(b){var c=this.$el.addClass(b+"-open");setTimeout(function(){c.addClass(b+"-opened")},0),setTimeout(function(){c.removeClass(b+"-open").removeClass(b+"-opened")},300)}return this.trigger("opened"),this},f.close=function(b,c){if(this.isopened){a.isFunction(b)&&(c=b,b=!1);var e={type:"dialog_close"};if(this._getContentView().trigger(e),b||!e.isPreventDefault){this.isopened=!1;var f=this.$el.removeClass("show-dialog"),g=f.attr("opt-trans");g&&(f.addClass(g+"-close"),setTimeout(function(){f.addClass(g+"-closed")},0));var h=this,i=g?200:0;setTimeout(function(){g&&f.removeClass(g+"-close").removeClass(g+"-closed");var b=$("body").children(".ui-dialog-wrap");h.$el.parent().is(b)&&h.$el.remove();for(var e=d.length-1;e>=0;e--)d[e]===h&&d.splice(e,1);if(0==d.length){var i=$("body").removeClass("ui-scrollless").children(".ui-dialog-mask").fadeOut(200);setTimeout(function(){i.remove()},200)}a.isFunction(c)&&c()},i),this.trigger("closed")}}},f.remove=function(){var a=this;this.close(!1,function(){a.$el.remove()})},f.isOpen=function(){return!!this.isopened},f.waitting=function(b,c){var d=null;if(a.isNotBlank(c)){var e=this.dialogView.children("footer"),d=e.find(".btnbar > .btn[name='"+c+"']");d&&d.length>0||(d=null)}var f=d&&parseInt(d.attr("opt-wait"))||0;f=a.isNull(b)||!0===b?f||-1:b?isNaN(b)?a.isTrue(b)?f||-1:0:Math.max(0,parseInt(b)):0,m.call(this,f,d)},f.setButtonValue=function(c,d){if(a.isNotBlank(c)&&a.isNotNull(d)){var e=this.dialogView.children("footer"),f=e.find(".btnbar > .btn[name='"+c+"']");f&&f.length>0&&(f=b.get(f.children()),f.val(d))}},f._getContentView=function(){return this.dialogView.children("section").children(".container").children()},f._isTouchCloseable=function(){return!1!==this.options.touchCloseEnabled};var g=function(a){this.close()},h=function(a){var b=$(a.currentTarget);if(!b.is(".disabled, .waitting")){var c=b.attr("name")||"";c&&this._getContentView().trigger("dialog_btn_"+c,c,this);var d=!1;if(c){var e="btn_"+c;this.hasListen(e)&&(d=!0,this.trigger(e,c,this))}this.hasListen("btnclk")&&(d=!0,this.trigger("btnclk",c,this));var f=b.attr("opt-wait");if(f||0==f){if(f=parseInt(f)||0,m.call(this,f,b),f>0){var g=this;this.closeTimerId=setTimeout(function(){g.closeTimerId=0,g.close()},f)}}else d||/^ok|cancel|submit|close|save|finish$/.test(c)&&this.close(/^cancel|close$/.test(c))}},i=function(a){this._isMounted()?this.open():this.activeBtn.off("tap",arguments.callee)},j=function(){if(this._isMounted()){var a=this.$el.find(".dialog-view > section > .container");this.isRenderAsApp()||a.css("maxHeight",$(window).height()-200)}else $(window).off("resize",arguments.callee)},k=function(a){$(a.target).is(this.$el)&&this._isTouchCloseable()&&this.close()},l=function(){var a=this._getContentView();if(a&&a.length>0){a.off("submit_to_dialog");var b=this;a.on("submit_to_dialog",function(a,c){b.trigger("view_submit",c),b.close()})}},m=function(a,c){var d=c?b.get(c.children()):null;if(a){if(d?(c.addClass("waitting"),d.waitting()):this.$el.addClass("waitting"),a>0){var e=this;setTimeout(function(){m.call(e,!1,c)},a)}}else d?(c.removeClass("waitting"),d.waitting(!1)):this.$el.removeClass("waitting")};b.register(".ui-dialog",e)}}();